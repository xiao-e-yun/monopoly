var Zm=Object.defineProperty;var Jm=(e,t,r)=>t in e?Zm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Oe=(e,t,r)=>Jm(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function mf(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const Rt={},Ci=[],Jr=()=>{},ev=()=>!1,Ss=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),vf=e=>e.startsWith("onUpdate:"),Wt=Object.assign,_f=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},tv=Object.prototype.hasOwnProperty,At=(e,t)=>tv.call(e,t),qe=Array.isArray,Li=e=>ya(e)==="[object Map]",Cs=e=>ya(e)==="[object Set]",Lc=e=>ya(e)==="[object Date]",lt=e=>typeof e=="function",Xt=e=>typeof e=="string",tn=e=>typeof e=="symbol",Ot=e=>e!==null&&typeof e=="object",mu=e=>(Ot(e)||lt(e))&&lt(e.then)&&lt(e.catch),vu=Object.prototype.toString,ya=e=>vu.call(e),rv=e=>ya(e).slice(8,-1),_u=e=>ya(e)==="[object Object]",gf=e=>Xt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,sa=mf(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ls=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},nv=/-(\w)/g,Dn=Ls(e=>e.replace(nv,(t,r)=>r?r.toUpperCase():"")),iv=/\B([A-Z])/g,oi=Ls(e=>e.replace(iv,"-$1").toLowerCase()),gu=Ls(e=>e.charAt(0).toUpperCase()+e.slice(1)),Bo=Ls(e=>e?`on${gu(e)}`:""),Fn=(e,t)=>!Object.is(e,t),cs=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},yu=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},Zo=e=>{const t=parseFloat(e);return isNaN(t)?e:t},av=e=>{const t=Xt(e)?Number(e):NaN;return isNaN(t)?e:t};let Rc;const Rs=()=>Rc||(Rc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ba(e){if(qe(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=Xt(n)?lv(n):ba(n);if(i)for(const a in i)t[a]=i[a]}return t}else if(Xt(e)||Ot(e))return e}const sv=/;(?![^(]*\))/g,ov=/:([^]+)/,fv=/\/\*[^]*?\*\//g;function lv(e){const t={};return e.replace(fv,"").split(sv).forEach(r=>{if(r){const n=r.split(ov);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function xa(e){let t="";if(Xt(e))t=e;else if(qe(e))for(let r=0;r<e.length;r++){const n=xa(e[r]);n&&(t+=n+" ")}else if(Ot(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const cv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",uv=mf(cv);function bu(e){return!!e||e===""}function dv(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=Os(e[n],t[n]);return r}function Os(e,t){if(e===t)return!0;let r=Lc(e),n=Lc(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=tn(e),n=tn(t),r||n)return e===t;if(r=qe(e),n=qe(t),r||n)return r&&n?dv(e,t):!1;if(r=Ot(e),n=Ot(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,a=Object.keys(t).length;if(i!==a)return!1;for(const f in e){const o=e.hasOwnProperty(f),l=t.hasOwnProperty(f);if(o&&!l||!o&&l||!Os(e[f],t[f]))return!1}}return String(e)===String(t)}function xu(e,t){return e.findIndex(r=>Os(r,t))}const Eu=e=>!!(e&&e.__v_isRef===!0),ut=e=>Xt(e)?e:e==null?"":qe(e)||Ot(e)&&(e.toString===vu||!lt(e.toString))?Eu(e)?ut(e.value):JSON.stringify(e,Tu,2):String(e),Tu=(e,t)=>Eu(t)?Tu(e,t.value):Li(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,i],a)=>(r[Uo(n,a)+" =>"]=i,r),{})}:Cs(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>Uo(r))}:tn(t)?Uo(t):Ot(t)&&!qe(t)&&!_u(t)?String(t):t,Uo=(e,t="")=>{var r;return tn(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Lr;class hv{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Lr,!t&&Lr&&(this.index=(Lr.scopes||(Lr.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=Lr;try{return Lr=this,t()}finally{Lr=r}}}on(){Lr=this}off(){Lr=this.parent}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function pv(){return Lr}let It;const $o=new WeakSet;class Au{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Lr&&Lr.active&&Lr.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,$o.has(this)&&($o.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Su(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Oc(this),Cu(this);const t=It,r=Vr;It=this,Vr=!0;try{return this.fn()}finally{Lu(this),It=t,Vr=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)xf(t);this.deps=this.depsTail=void 0,Oc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?$o.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Jo(this)&&this.run()}get dirty(){return Jo(this)}}let wu=0,oa,fa;function Su(e,t=!1){if(e.flags|=8,t){e.next=fa,fa=e;return}e.next=oa,oa=e}function yf(){wu++}function bf(){if(--wu>0)return;if(fa){let t=fa;for(fa=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;oa;){let t=oa;for(oa=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function Cu(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Lu(e){let t,r=e.depsTail,n=r;for(;n;){const i=n.prevDep;n.version===-1?(n===r&&(r=i),xf(n),mv(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}e.deps=t,e.depsTail=r}function Jo(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ru(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ru(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ha))return;e.globalVersion=ha;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Jo(e)){e.flags&=-3;return}const r=It,n=Vr;It=e,Vr=!0;try{Cu(e);const i=e.fn(e._value);(t.version===0||Fn(i,e._value))&&(e._value=i,t.version++)}catch(i){throw t.version++,i}finally{It=r,Vr=n,Lu(e),e.flags&=-3}}function xf(e,t=!1){const{dep:r,prevSub:n,nextSub:i}=e;if(n&&(n.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let a=r.computed.deps;a;a=a.nextDep)xf(a,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function mv(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let Vr=!0;const Ou=[];function Mn(){Ou.push(Vr),Vr=!1}function Nn(){const e=Ou.pop();Vr=e===void 0?!0:e}function Oc(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=It;It=void 0;try{t()}finally{It=r}}}let ha=0;class vv{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ef{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!It||!Vr||It===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==It)r=this.activeLink=new vv(It,this),It.deps?(r.prevDep=It.depsTail,It.depsTail.nextDep=r,It.depsTail=r):It.deps=It.depsTail=r,Fu(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=It.depsTail,r.nextDep=void 0,It.depsTail.nextDep=r,It.depsTail=r,It.deps===r&&(It.deps=n)}return r}trigger(t){this.version++,ha++,this.notify(t)}notify(t){yf();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{bf()}}}function Fu(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Fu(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const ef=new WeakMap,ni=Symbol(""),tf=Symbol(""),pa=Symbol("");function cr(e,t,r){if(Vr&&It){let n=ef.get(e);n||ef.set(e,n=new Map);let i=n.get(r);i||(n.set(r,i=new Ef),i.map=n,i.key=r),i.track()}}function hn(e,t,r,n,i,a){const f=ef.get(e);if(!f){ha++;return}const o=l=>{l&&l.trigger()};if(yf(),t==="clear")f.forEach(o);else{const l=qe(e),y=l&&gf(r);if(l&&r==="length"){const g=Number(n);f.forEach((P,U)=>{(U==="length"||U===pa||!tn(U)&&U>=g)&&o(P)})}else switch((r!==void 0||f.has(void 0))&&o(f.get(r)),y&&o(f.get(pa)),t){case"add":l?y&&o(f.get("length")):(o(f.get(ni)),Li(e)&&o(f.get(tf)));break;case"delete":l||(o(f.get(ni)),Li(e)&&o(f.get(tf)));break;case"set":Li(e)&&o(f.get(ni));break}}bf()}function wi(e){const t=xt(e);return t===e?t:(cr(t,"iterate",pa),Mr(e)?t:t.map(ur))}function Fs(e){return cr(e=xt(e),"iterate",pa),e}const _v={__proto__:null,[Symbol.iterator](){return Vo(this,Symbol.iterator,ur)},concat(...e){return wi(this).concat(...e.map(t=>qe(t)?wi(t):t))},entries(){return Vo(this,"entries",e=>(e[1]=ur(e[1]),e))},every(e,t){return un(this,"every",e,t,void 0,arguments)},filter(e,t){return un(this,"filter",e,t,r=>r.map(ur),arguments)},find(e,t){return un(this,"find",e,t,ur,arguments)},findIndex(e,t){return un(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return un(this,"findLast",e,t,ur,arguments)},findLastIndex(e,t){return un(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return un(this,"forEach",e,t,void 0,arguments)},includes(...e){return jo(this,"includes",e)},indexOf(...e){return jo(this,"indexOf",e)},join(e){return wi(this).join(e)},lastIndexOf(...e){return jo(this,"lastIndexOf",e)},map(e,t){return un(this,"map",e,t,void 0,arguments)},pop(){return ra(this,"pop")},push(...e){return ra(this,"push",e)},reduce(e,...t){return Fc(this,"reduce",e,t)},reduceRight(e,...t){return Fc(this,"reduceRight",e,t)},shift(){return ra(this,"shift")},some(e,t){return un(this,"some",e,t,void 0,arguments)},splice(...e){return ra(this,"splice",e)},toReversed(){return wi(this).toReversed()},toSorted(e){return wi(this).toSorted(e)},toSpliced(...e){return wi(this).toSpliced(...e)},unshift(...e){return ra(this,"unshift",e)},values(){return Vo(this,"values",ur)}};function Vo(e,t,r){const n=Fs(e),i=n[t]();return n!==e&&!Mr(e)&&(i._next=i.next,i.next=()=>{const a=i._next();return a.value&&(a.value=r(a.value)),a}),i}const gv=Array.prototype;function un(e,t,r,n,i,a){const f=Fs(e),o=f!==e&&!Mr(e),l=f[t];if(l!==gv[t]){const P=l.apply(e,a);return o?ur(P):P}let y=r;f!==e&&(o?y=function(P,U){return r.call(this,ur(P),U,e)}:r.length>2&&(y=function(P,U){return r.call(this,P,U,e)}));const g=l.call(f,y,n);return o&&i?i(g):g}function Fc(e,t,r,n){const i=Fs(e);let a=r;return i!==e&&(Mr(e)?r.length>3&&(a=function(f,o,l){return r.call(this,f,o,l,e)}):a=function(f,o,l){return r.call(this,f,ur(o),l,e)}),i[t](a,...n)}function jo(e,t,r){const n=xt(e);cr(n,"iterate",pa);const i=n[t](...r);return(i===-1||i===!1)&&Sf(r[0])?(r[0]=xt(r[0]),n[t](...r)):i}function ra(e,t,r=[]){Mn(),yf();const n=xt(e)[t].apply(e,r);return bf(),Nn(),n}const yv=mf("__proto__,__v_isRef,__isVue"),Pu=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(tn));function bv(e){tn(e)||(e=String(e));const t=xt(this);return cr(t,"has",e),t.hasOwnProperty(e)}class Du{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const i=this._isReadonly,a=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return a;if(r==="__v_raw")return n===(i?a?Ov:Nu:a?Mu:Gu).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const f=qe(t);if(!i){let l;if(f&&(l=_v[r]))return l;if(r==="hasOwnProperty")return bv}const o=Reflect.get(t,r,pr(t)?t:n);return(tn(r)?Pu.has(r):yv(r))||(i||cr(t,"get",r),a)?o:pr(o)?f&&gf(r)?o:o.value:Ot(o)?i?ku(o):fi(o):o}}class Iu extends Du{constructor(t=!1){super(!1,t)}set(t,r,n,i){let a=t[r];if(!this._isShallow){const l=ai(a);if(!Mr(n)&&!ai(n)&&(a=xt(a),n=xt(n)),!qe(t)&&pr(a)&&!pr(n))return l?!1:(a.value=n,!0)}const f=qe(t)&&gf(r)?Number(r)<t.length:At(t,r),o=Reflect.set(t,r,n,pr(t)?t:i);return t===xt(i)&&(f?Fn(n,a)&&hn(t,"set",r,n):hn(t,"add",r,n)),o}deleteProperty(t,r){const n=At(t,r);t[r];const i=Reflect.deleteProperty(t,r);return i&&n&&hn(t,"delete",r,void 0),i}has(t,r){const n=Reflect.has(t,r);return(!tn(r)||!Pu.has(r))&&cr(t,"has",r),n}ownKeys(t){return cr(t,"iterate",qe(t)?"length":ni),Reflect.ownKeys(t)}}class xv extends Du{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const Ev=new Iu,Tv=new xv,Av=new Iu(!0);const rf=e=>e,as=e=>Reflect.getPrototypeOf(e);function wv(e,t,r){return function(...n){const i=this.__v_raw,a=xt(i),f=Li(a),o=e==="entries"||e===Symbol.iterator&&f,l=e==="keys"&&f,y=i[e](...n),g=r?rf:t?nf:ur;return!t&&cr(a,"iterate",l?tf:ni),{next(){const{value:P,done:U}=y.next();return U?{value:P,done:U}:{value:o?[g(P[0]),g(P[1])]:g(P),done:U}},[Symbol.iterator](){return this}}}}function ss(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Sv(e,t){const r={get(i){const a=this.__v_raw,f=xt(a),o=xt(i);e||(Fn(i,o)&&cr(f,"get",i),cr(f,"get",o));const{has:l}=as(f),y=t?rf:e?nf:ur;if(l.call(f,i))return y(a.get(i));if(l.call(f,o))return y(a.get(o));a!==f&&a.get(i)},get size(){const i=this.__v_raw;return!e&&cr(xt(i),"iterate",ni),Reflect.get(i,"size",i)},has(i){const a=this.__v_raw,f=xt(a),o=xt(i);return e||(Fn(i,o)&&cr(f,"has",i),cr(f,"has",o)),i===o?a.has(i):a.has(i)||a.has(o)},forEach(i,a){const f=this,o=f.__v_raw,l=xt(o),y=t?rf:e?nf:ur;return!e&&cr(l,"iterate",ni),o.forEach((g,P)=>i.call(a,y(g),y(P),f))}};return Wt(r,e?{add:ss("add"),set:ss("set"),delete:ss("delete"),clear:ss("clear")}:{add(i){!t&&!Mr(i)&&!ai(i)&&(i=xt(i));const a=xt(this);return as(a).has.call(a,i)||(a.add(i),hn(a,"add",i,i)),this},set(i,a){!t&&!Mr(a)&&!ai(a)&&(a=xt(a));const f=xt(this),{has:o,get:l}=as(f);let y=o.call(f,i);y||(i=xt(i),y=o.call(f,i));const g=l.call(f,i);return f.set(i,a),y?Fn(a,g)&&hn(f,"set",i,a):hn(f,"add",i,a),this},delete(i){const a=xt(this),{has:f,get:o}=as(a);let l=f.call(a,i);l||(i=xt(i),l=f.call(a,i)),o&&o.call(a,i);const y=a.delete(i);return l&&hn(a,"delete",i,void 0),y},clear(){const i=xt(this),a=i.size!==0,f=i.clear();return a&&hn(i,"clear",void 0,void 0),f}}),["keys","values","entries",Symbol.iterator].forEach(i=>{r[i]=wv(i,e,t)}),r}function Tf(e,t){const r=Sv(e,t);return(n,i,a)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(At(r,i)&&i in n?r:n,i,a)}const Cv={get:Tf(!1,!1)},Lv={get:Tf(!1,!0)},Rv={get:Tf(!0,!1)};const Gu=new WeakMap,Mu=new WeakMap,Nu=new WeakMap,Ov=new WeakMap;function Fv(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Pv(e){return e.__v_skip||!Object.isExtensible(e)?0:Fv(rv(e))}function fi(e){return ai(e)?e:wf(e,!1,Ev,Cv,Gu)}function Af(e){return wf(e,!1,Av,Lv,Mu)}function ku(e){return wf(e,!0,Tv,Rv,Nu)}function wf(e,t,r,n,i){if(!Ot(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const f=Pv(e);if(f===0)return e;const o=new Proxy(e,f===2?n:r);return i.set(e,o),o}function Ri(e){return ai(e)?Ri(e.__v_raw):!!(e&&e.__v_isReactive)}function ai(e){return!!(e&&e.__v_isReadonly)}function Mr(e){return!!(e&&e.__v_isShallow)}function Sf(e){return e?!!e.__v_raw:!1}function xt(e){const t=e&&e.__v_raw;return t?xt(t):e}function Dv(e){return!At(e,"__v_skip")&&Object.isExtensible(e)&&yu(e,"__v_skip",!0),e}const ur=e=>Ot(e)?fi(e):e,nf=e=>Ot(e)?ku(e):e;function pr(e){return e?e.__v_isRef===!0:!1}function Pc(e){return Bu(e,!1)}function Iv(e){return Bu(e,!0)}function Bu(e,t){return pr(e)?e:new Gv(e,t)}class Gv{constructor(t,r){this.dep=new Ef,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:xt(t),this._value=r?t:ur(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||Mr(t)||ai(t);t=n?t:xt(t),Fn(t,r)&&(this._rawValue=t,this._value=n?t:ur(t),this.dep.trigger())}}function De(e){return pr(e)?e.value:e}const Mv={get:(e,t,r)=>t==="__v_raw"?e:De(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return pr(i)&&!pr(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function Uu(e){return Ri(e)?e:new Proxy(e,Mv)}class Nv{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new Ef(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ha-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&It!==this)return Su(this,!0),!0}get value(){const t=this.dep.track();return Ru(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function af(e,t,r=!1){let n,i;return lt(e)?n=e:(n=e.get,i=e.set),new Nv(n,i,r)}const os={},ps=new WeakMap;let ei;function kv(e,t=!1,r=ei){if(r){let n=ps.get(r);n||ps.set(r,n=[]),n.push(e)}}function Bv(e,t,r=Rt){const{immediate:n,deep:i,once:a,scheduler:f,augmentJob:o,call:l}=r,y=be=>i?be:Mr(be)||i===!1||i===0?pn(be,1):pn(be);let g,P,U,re,ue=!1,Ie=!1;if(pr(e)?(P=()=>e.value,ue=Mr(e)):Ri(e)?(P=()=>y(e),ue=!0):qe(e)?(Ie=!0,ue=e.some(be=>Ri(be)||Mr(be)),P=()=>e.map(be=>{if(pr(be))return be.value;if(Ri(be))return y(be);if(lt(be))return l?l(be,2):be()})):lt(e)?t?P=l?()=>l(e,2):e:P=()=>{if(U){Mn();try{U()}finally{Nn()}}const be=ei;ei=g;try{return l?l(e,3,[re]):e(re)}finally{ei=be}}:P=Jr,t&&i){const be=P,ke=i===!0?1/0:i;P=()=>pn(be(),ke)}const Qe=pv(),Ge=()=>{g.stop(),Qe&&Qe.active&&_f(Qe.effects,g)};if(a&&t){const be=t;t=(...ke)=>{be(...ke),Ge()}}let Ze=Ie?new Array(e.length).fill(os):os;const $e=be=>{if(!(!(g.flags&1)||!g.dirty&&!be))if(t){const ke=g.run();if(i||ue||(Ie?ke.some((We,St)=>Fn(We,Ze[St])):Fn(ke,Ze))){U&&U();const We=ei;ei=g;try{const St=[ke,Ze===os?void 0:Ie&&Ze[0]===os?[]:Ze,re];l?l(t,3,St):t(...St),Ze=ke}finally{ei=We}}}else g.run()};return o&&o($e),g=new Au(P),g.scheduler=f?()=>f($e,!1):$e,re=be=>kv(be,!1,g),U=g.onStop=()=>{const be=ps.get(g);if(be){if(l)l(be,4);else for(const ke of be)ke();ps.delete(g)}},t?n?$e(!0):Ze=g.run():f?f($e.bind(null,!0),!0):g.run(),Ge.pause=g.pause.bind(g),Ge.resume=g.resume.bind(g),Ge.stop=Ge,Ge}function pn(e,t=1/0,r){if(t<=0||!Ot(e)||e.__v_skip||(r=r||new Set,r.has(e)))return e;if(r.add(e),t--,pr(e))pn(e.value,t,r);else if(qe(e))for(let n=0;n<e.length;n++)pn(e[n],t,r);else if(Cs(e)||Li(e))e.forEach(n=>{pn(n,t,r)});else if(_u(e)){for(const n in e)pn(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&pn(e[n],t,r)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ea(e,t,r,n){try{return n?e(...n):e()}catch(i){Ps(i,t,r)}}function jr(e,t,r,n){if(lt(e)){const i=Ea(e,t,r,n);return i&&mu(i)&&i.catch(a=>{Ps(a,t,r)}),i}if(qe(e)){const i=[];for(let a=0;a<e.length;a++)i.push(jr(e[a],t,r,n));return i}}function Ps(e,t,r,n=!0){const i=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:f}=t&&t.appContext.config||Rt;if(t){let o=t.parent;const l=t.proxy,y=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const g=o.ec;if(g){for(let P=0;P<g.length;P++)if(g[P](e,l,y)===!1)return}o=o.parent}if(a){Mn(),Ea(a,null,10,[e,l,y]),Nn();return}}Uv(e,r,i,n,f)}function Uv(e,t,r,n=!0,i=!1){if(i)throw e;console.error(e)}const gr=[];let Qr=-1;const Oi=[];let Ln=null,Si=0;const $u=Promise.resolve();let ms=null;function sf(e){const t=ms||$u;return e?t.then(this?e.bind(this):e):t}function $v(e){let t=Qr+1,r=gr.length;for(;t<r;){const n=t+r>>>1,i=gr[n],a=ma(i);a<e||a===e&&i.flags&2?t=n+1:r=n}return t}function Cf(e){if(!(e.flags&1)){const t=ma(e),r=gr[gr.length-1];!r||!(e.flags&2)&&t>=ma(r)?gr.push(e):gr.splice($v(t),0,e),e.flags|=1,Vu()}}function Vu(){ms||(ms=$u.then(Hu))}function Vv(e){qe(e)?Oi.push(...e):Ln&&e.id===-1?Ln.splice(Si+1,0,e):e.flags&1||(Oi.push(e),e.flags|=1),Vu()}function Dc(e,t,r=Qr+1){for(;r<gr.length;r++){const n=gr[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;gr.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function ju(e){if(Oi.length){const t=[...new Set(Oi)].sort((r,n)=>ma(r)-ma(n));if(Oi.length=0,Ln){Ln.push(...t);return}for(Ln=t,Si=0;Si<Ln.length;Si++){const r=Ln[Si];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}Ln=null,Si=0}}const ma=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Hu(e){try{for(Qr=0;Qr<gr.length;Qr++){const t=gr[Qr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ea(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Qr<gr.length;Qr++){const t=gr[Qr];t&&(t.flags&=-2)}Qr=-1,gr.length=0,ju(),ms=null,(gr.length||Oi.length)&&Hu()}}let Or=null,zu=null;function vs(e){const t=Or;return Or=e,zu=e&&e.type.__scopeId||null,t}function _s(e,t=Or,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&Vc(-1);const a=vs(t);let f;try{f=e(...i)}finally{vs(a),n._d&&Vc(1)}return f};return n._n=!0,n._c=!0,n._d=!0,n}function fr(e,t){if(Or===null)return e;const r=Ns(Or),n=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[a,f,o,l=Rt]=t[i];a&&(lt(a)&&(a={mounted:a,updated:a}),a.deep&&pn(f),n.push({dir:a,instance:r,value:f,oldValue:void 0,arg:o,modifiers:l}))}return e}function Qn(e,t,r,n){const i=e.dirs,a=t&&t.dirs;for(let f=0;f<i.length;f++){const o=i[f];a&&(o.oldValue=a[f].value);let l=o.dir[n];l&&(Mn(),jr(l,r,8,[e.el,o,e,t]),Nn())}}const jv=Symbol("_vte"),Wu=e=>e.__isTeleport,Rn=Symbol("_leaveCb"),fs=Symbol("_enterCb");function Xu(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return td(()=>{e.isMounted=!0}),nd(()=>{e.isUnmounting=!0}),e}const Gr=[Function,Array],Yu={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Gr,onEnter:Gr,onAfterEnter:Gr,onEnterCancelled:Gr,onBeforeLeave:Gr,onLeave:Gr,onAfterLeave:Gr,onLeaveCancelled:Gr,onBeforeAppear:Gr,onAppear:Gr,onAfterAppear:Gr,onAppearCancelled:Gr},Ku=e=>{const t=e.subTree;return t.component?Ku(t.component):t},Hv={name:"BaseTransition",props:Yu,setup(e,{slots:t}){const r=Pf(),n=Xu();return()=>{const i=t.default&&Lf(t.default(),!0);if(!i||!i.length)return;const a=qu(i),f=xt(e),{mode:o}=f;if(n.isLeaving)return Ho(a);const l=Ic(a);if(!l)return Ho(a);let y=va(l,f,n,r,P=>y=P);l.type!==xr&&si(l,y);let g=r.subTree&&Ic(r.subTree);if(g&&g.type!==xr&&!ti(l,g)&&Ku(r).type!==xr){let P=va(g,f,n,r);if(si(g,P),o==="out-in"&&l.type!==xr)return n.isLeaving=!0,P.afterLeave=()=>{n.isLeaving=!1,r.job.flags&8||r.update(),delete P.afterLeave,g=void 0},Ho(a);o==="in-out"&&l.type!==xr?P.delayLeave=(U,re,ue)=>{const Ie=Qu(n,g);Ie[String(g.key)]=g,U[Rn]=()=>{re(),U[Rn]=void 0,delete y.delayedLeave,g=void 0},y.delayedLeave=()=>{ue(),delete y.delayedLeave,g=void 0}}:g=void 0}else g&&(g=void 0);return a}}};function qu(e){let t=e[0];if(e.length>1){for(const r of e)if(r.type!==xr){t=r;break}}return t}const zv=Hv;function Qu(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function va(e,t,r,n,i){const{appear:a,mode:f,persisted:o=!1,onBeforeEnter:l,onEnter:y,onAfterEnter:g,onEnterCancelled:P,onBeforeLeave:U,onLeave:re,onAfterLeave:ue,onLeaveCancelled:Ie,onBeforeAppear:Qe,onAppear:Ge,onAfterAppear:Ze,onAppearCancelled:$e}=t,be=String(e.key),ke=Qu(r,e),We=(He,et)=>{He&&jr(He,n,9,et)},St=(He,et)=>{const mt=et[1];We(He,et),qe(He)?He.every(Fe=>Fe.length<=1)&&mt():He.length<=1&&mt()},Ft={mode:f,persisted:o,beforeEnter(He){let et=l;if(!r.isMounted)if(a)et=Qe||l;else return;He[Rn]&&He[Rn](!0);const mt=ke[be];mt&&ti(e,mt)&&mt.el[Rn]&&mt.el[Rn](),We(et,[He])},enter(He){let et=y,mt=g,Fe=P;if(!r.isMounted)if(a)et=Ge||y,mt=Ze||g,Fe=$e||P;else return;let _t=!1;const ft=He[fs]=Nr=>{_t||(_t=!0,Nr?We(Fe,[He]):We(mt,[He]),Ft.delayedLeave&&Ft.delayedLeave(),He[fs]=void 0)};et?St(et,[He,ft]):ft()},leave(He,et){const mt=String(e.key);if(He[fs]&&He[fs](!0),r.isUnmounting)return et();We(U,[He]);let Fe=!1;const _t=He[Rn]=ft=>{Fe||(Fe=!0,et(),ft?We(Ie,[He]):We(ue,[He]),He[Rn]=void 0,ke[mt]===e&&delete ke[mt])};ke[mt]=e,re?St(re,[He,_t]):_t()},clone(He){const et=va(He,t,r,n,i);return i&&i(et),et}};return Ft}function Ho(e){if(Ds(e))return e=In(e),e.children=null,e}function Ic(e){if(!Ds(e))return Wu(e.type)&&e.children?qu(e.children):e;const{shapeFlag:t,children:r}=e;if(r){if(t&16)return r[0];if(t&32&&lt(r.default))return r.default()}}function si(e,t){e.shapeFlag&6&&e.component?(e.transition=t,si(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Lf(e,t=!1,r){let n=[],i=0;for(let a=0;a<e.length;a++){let f=e[a];const o=r==null?f.key:String(r)+String(f.key!=null?f.key:a);f.type===wt?(f.patchFlag&128&&i++,n=n.concat(Lf(f.children,t,o))):(t||f.type!==xr)&&n.push(o!=null?In(f,{key:o}):f)}if(i>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function rn(e,t){return lt(e)?Wt({name:e.name},t,{setup:e}):e}function Zu(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ju(e){const t=Pf(),r=Iv(null);if(t){const i=t.refs===Rt?t.refs={}:t.refs;Object.defineProperty(i,e,{enumerable:!0,get:()=>r.value,set:a=>r.value=a})}return r}function gs(e,t,r,n,i=!1){if(qe(e)){e.forEach((ue,Ie)=>gs(ue,t&&(qe(t)?t[Ie]:t),r,n,i));return}if(la(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&gs(e,t,r,n.component.subTree);return}const a=n.shapeFlag&4?Ns(n.component):n.el,f=i?null:a,{i:o,r:l}=e,y=t&&t.r,g=o.refs===Rt?o.refs={}:o.refs,P=o.setupState,U=xt(P),re=P===Rt?()=>!1:ue=>At(U,ue);if(y!=null&&y!==l&&(Xt(y)?(g[y]=null,re(y)&&(P[y]=null)):pr(y)&&(y.value=null)),lt(l))Ea(l,o,12,[f,g]);else{const ue=Xt(l),Ie=pr(l);if(ue||Ie){const Qe=()=>{if(e.f){const Ge=ue?re(l)?P[l]:g[l]:l.value;i?qe(Ge)&&_f(Ge,a):qe(Ge)?Ge.includes(a)||Ge.push(a):ue?(g[l]=[a],re(l)&&(P[l]=g[l])):(l.value=[a],e.k&&(g[e.k]=l.value))}else ue?(g[l]=f,re(l)&&(P[l]=f)):Ie&&(l.value=f,e.k&&(g[e.k]=f))};f?(Qe.id=-1,Cr(Qe,r)):Qe()}}}Rs().requestIdleCallback;Rs().cancelIdleCallback;const la=e=>!!e.type.__asyncLoader,Ds=e=>e.type.__isKeepAlive;function Wv(e,t){ed(e,"a",t)}function Xv(e,t){ed(e,"da",t)}function ed(e,t,r=hr){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Is(t,n,r),r){let i=r.parent;for(;i&&i.parent;)Ds(i.parent.vnode)&&Yv(n,t,r,i),i=i.parent}}function Yv(e,t,r,n){const i=Is(t,e,n,!0);id(()=>{_f(n[t],i)},r)}function Is(e,t,r=hr,n=!1){if(r){const i=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...f)=>{Mn();const o=Ta(r),l=jr(t,r,e,f);return o(),Nn(),l});return n?i.unshift(a):i.push(a),a}}const _n=e=>(t,r=hr)=>{(!ga||e==="sp")&&Is(e,(...n)=>t(...n),r)},Kv=_n("bm"),td=_n("m"),qv=_n("bu"),rd=_n("u"),nd=_n("bum"),id=_n("um"),Qv=_n("sp"),Zv=_n("rtg"),Jv=_n("rtc");function e0(e,t=hr){Is("ec",e,t)}const t0=Symbol.for("v-ndc");function $r(e,t,r,n){let i;const a=r,f=qe(e);if(f||Xt(e)){const o=f&&Ri(e);let l=!1;o&&(l=!Mr(e),e=Fs(e)),i=new Array(e.length);for(let y=0,g=e.length;y<g;y++)i[y]=t(l?ur(e[y]):e[y],y,void 0,a)}else if(typeof e=="number"){i=new Array(e);for(let o=0;o<e;o++)i[o]=t(o+1,o,void 0,a)}else if(Ot(e))if(e[Symbol.iterator])i=Array.from(e,(o,l)=>t(o,l,void 0,a));else{const o=Object.keys(e);i=new Array(o.length);for(let l=0,y=o.length;l<y;l++){const g=o[l];i[l]=t(e[g],g,l,a)}}else i=[];return i}const of=e=>e?Ad(e)?Ns(e):of(e.parent):null,ca=Wt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>of(e.parent),$root:e=>of(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Rf(e),$forceUpdate:e=>e.f||(e.f=()=>{Cf(e.update)}),$nextTick:e=>e.n||(e.n=sf.bind(e.proxy)),$watch:e=>T0.bind(e)}),zo=(e,t)=>e!==Rt&&!e.__isScriptSetup&&At(e,t),r0={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:i,props:a,accessCache:f,type:o,appContext:l}=e;let y;if(t[0]!=="$"){const re=f[t];if(re!==void 0)switch(re){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return a[t]}else{if(zo(n,t))return f[t]=1,n[t];if(i!==Rt&&At(i,t))return f[t]=2,i[t];if((y=e.propsOptions[0])&&At(y,t))return f[t]=3,a[t];if(r!==Rt&&At(r,t))return f[t]=4,r[t];ff&&(f[t]=0)}}const g=ca[t];let P,U;if(g)return t==="$attrs"&&cr(e.attrs,"get",""),g(e);if((P=o.__cssModules)&&(P=P[t]))return P;if(r!==Rt&&At(r,t))return f[t]=4,r[t];if(U=l.config.globalProperties,At(U,t))return U[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:a}=e;return zo(i,t)?(i[t]=r,!0):n!==Rt&&At(n,t)?(n[t]=r,!0):At(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,propsOptions:a}},f){let o;return!!r[f]||e!==Rt&&At(e,f)||zo(t,f)||(o=a[0])&&At(o,f)||At(n,f)||At(ca,f)||At(i.config.globalProperties,f)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:At(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function Gc(e){return qe(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let ff=!0;function n0(e){const t=Rf(e),r=e.proxy,n=e.ctx;ff=!1,t.beforeCreate&&Mc(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:f,watch:o,provide:l,inject:y,created:g,beforeMount:P,mounted:U,beforeUpdate:re,updated:ue,activated:Ie,deactivated:Qe,beforeDestroy:Ge,beforeUnmount:Ze,destroyed:$e,unmounted:be,render:ke,renderTracked:We,renderTriggered:St,errorCaptured:Ft,serverPrefetch:He,expose:et,inheritAttrs:mt,components:Fe,directives:_t,filters:ft}=t;if(y&&i0(y,n,null),f)for(const Pt in f){const Ct=f[Pt];lt(Ct)&&(n[Pt]=Ct.bind(r))}if(i){const Pt=i.call(r,r);Ot(Pt)&&(e.data=fi(Pt))}if(ff=!0,a)for(const Pt in a){const Ct=a[Pt],nn=lt(Ct)?Ct.bind(r,r):lt(Ct.get)?Ct.get.bind(r,r):Jr,an=!lt(Ct)&&lt(Ct.set)?Ct.set.bind(r):Jr,Hr=Mi({get:nn,set:an});Object.defineProperty(n,Pt,{enumerable:!0,configurable:!0,get:()=>Hr.value,set:Pr=>Hr.value=Pr})}if(o)for(const Pt in o)ad(o[Pt],n,r,Pt);if(l){const Pt=lt(l)?l.call(r):l;Reflect.ownKeys(Pt).forEach(Ct=>{c0(Ct,Pt[Ct])})}g&&Mc(g,e,"c");function Yt(Pt,Ct){qe(Ct)?Ct.forEach(nn=>Pt(nn.bind(r))):Ct&&Pt(Ct.bind(r))}if(Yt(Kv,P),Yt(td,U),Yt(qv,re),Yt(rd,ue),Yt(Wv,Ie),Yt(Xv,Qe),Yt(e0,Ft),Yt(Jv,We),Yt(Zv,St),Yt(nd,Ze),Yt(id,be),Yt(Qv,He),qe(et))if(et.length){const Pt=e.exposed||(e.exposed={});et.forEach(Ct=>{Object.defineProperty(Pt,Ct,{get:()=>r[Ct],set:nn=>r[Ct]=nn})})}else e.exposed||(e.exposed={});ke&&e.render===Jr&&(e.render=ke),mt!=null&&(e.inheritAttrs=mt),Fe&&(e.components=Fe),_t&&(e.directives=_t),He&&Zu(e)}function i0(e,t,r=Jr){qe(e)&&(e=lf(e));for(const n in e){const i=e[n];let a;Ot(i)?"default"in i?a=us(i.from||n,i.default,!0):a=us(i.from||n):a=us(i),pr(a)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>a.value,set:f=>a.value=f}):t[n]=a}}function Mc(e,t,r){jr(qe(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function ad(e,t,r,n){let i=n.includes(".")?yd(r,n):()=>r[n];if(Xt(e)){const a=t[e];lt(a)&&Pi(i,a)}else if(lt(e))Pi(i,e.bind(r));else if(Ot(e))if(qe(e))e.forEach(a=>ad(a,t,r,n));else{const a=lt(e.handler)?e.handler.bind(r):t[e.handler];lt(a)&&Pi(i,a,e)}}function Rf(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:f}}=e.appContext,o=a.get(t);let l;return o?l=o:!i.length&&!r&&!n?l=t:(l={},i.length&&i.forEach(y=>ys(l,y,f,!0)),ys(l,t,f)),Ot(t)&&a.set(t,l),l}function ys(e,t,r,n=!1){const{mixins:i,extends:a}=t;a&&ys(e,a,r,!0),i&&i.forEach(f=>ys(e,f,r,!0));for(const f in t)if(!(n&&f==="expose")){const o=a0[f]||r&&r[f];e[f]=o?o(e[f],t[f]):t[f]}return e}const a0={data:Nc,props:kc,emits:kc,methods:aa,computed:aa,beforeCreate:vr,created:vr,beforeMount:vr,mounted:vr,beforeUpdate:vr,updated:vr,beforeDestroy:vr,beforeUnmount:vr,destroyed:vr,unmounted:vr,activated:vr,deactivated:vr,errorCaptured:vr,serverPrefetch:vr,components:aa,directives:aa,watch:o0,provide:Nc,inject:s0};function Nc(e,t){return t?e?function(){return Wt(lt(e)?e.call(this,this):e,lt(t)?t.call(this,this):t)}:t:e}function s0(e,t){return aa(lf(e),lf(t))}function lf(e){if(qe(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function vr(e,t){return e?[...new Set([].concat(e,t))]:t}function aa(e,t){return e?Wt(Object.create(null),e,t):t}function kc(e,t){return e?qe(e)&&qe(t)?[...new Set([...e,...t])]:Wt(Object.create(null),Gc(e),Gc(t??{})):t}function o0(e,t){if(!e)return t;if(!t)return e;const r=Wt(Object.create(null),e);for(const n in t)r[n]=vr(e[n],t[n]);return r}function sd(){return{app:null,config:{isNativeTag:ev,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let f0=0;function l0(e,t){return function(n,i=null){lt(n)||(n=Wt({},n)),i!=null&&!Ot(i)&&(i=null);const a=sd(),f=new WeakSet,o=[];let l=!1;const y=a.app={_uid:f0++,_component:n,_props:i,_container:null,_context:a,_instance:null,version:H0,get config(){return a.config},set config(g){},use(g,...P){return f.has(g)||(g&&lt(g.install)?(f.add(g),g.install(y,...P)):lt(g)&&(f.add(g),g(y,...P))),y},mixin(g){return a.mixins.includes(g)||a.mixins.push(g),y},component(g,P){return P?(a.components[g]=P,y):a.components[g]},directive(g,P){return P?(a.directives[g]=P,y):a.directives[g]},mount(g,P,U){if(!l){const re=y._ceVNode||Vt(n,i);return re.appContext=a,U===!0?U="svg":U===!1&&(U=void 0),P&&t?t(re,g):e(re,g,U),l=!0,y._container=g,g.__vue_app__=y,Ns(re.component)}},onUnmount(g){o.push(g)},unmount(){l&&(jr(o,y._instance,16),e(null,y._container),delete y._container.__vue_app__)},provide(g,P){return a.provides[g]=P,y},runWithContext(g){const P=Fi;Fi=y;try{return g()}finally{Fi=P}}};return y}}let Fi=null;function c0(e,t){if(hr){let r=hr.provides;const n=hr.parent&&hr.parent.provides;n===r&&(r=hr.provides=Object.create(n)),r[e]=t}}function us(e,t,r=!1){const n=hr||Or;if(n||Fi){const i=Fi?Fi._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return r&&lt(t)?t.call(n&&n.proxy):t}}const od={},fd=()=>Object.create(od),ld=e=>Object.getPrototypeOf(e)===od;function u0(e,t,r,n=!1){const i={},a=fd();e.propsDefaults=Object.create(null),cd(e,t,i,a);for(const f in e.propsOptions[0])f in i||(i[f]=void 0);r?e.props=n?i:Af(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function d0(e,t,r,n){const{props:i,attrs:a,vnode:{patchFlag:f}}=e,o=xt(i),[l]=e.propsOptions;let y=!1;if((n||f>0)&&!(f&16)){if(f&8){const g=e.vnode.dynamicProps;for(let P=0;P<g.length;P++){let U=g[P];if(Gs(e.emitsOptions,U))continue;const re=t[U];if(l)if(At(a,U))re!==a[U]&&(a[U]=re,y=!0);else{const ue=Dn(U);i[ue]=cf(l,o,ue,re,e,!1)}else re!==a[U]&&(a[U]=re,y=!0)}}}else{cd(e,t,i,a)&&(y=!0);let g;for(const P in o)(!t||!At(t,P)&&((g=oi(P))===P||!At(t,g)))&&(l?r&&(r[P]!==void 0||r[g]!==void 0)&&(i[P]=cf(l,o,P,void 0,e,!0)):delete i[P]);if(a!==o)for(const P in a)(!t||!At(t,P))&&(delete a[P],y=!0)}y&&hn(e.attrs,"set","")}function cd(e,t,r,n){const[i,a]=e.propsOptions;let f=!1,o;if(t)for(let l in t){if(sa(l))continue;const y=t[l];let g;i&&At(i,g=Dn(l))?!a||!a.includes(g)?r[g]=y:(o||(o={}))[g]=y:Gs(e.emitsOptions,l)||(!(l in n)||y!==n[l])&&(n[l]=y,f=!0)}if(a){const l=xt(r),y=o||Rt;for(let g=0;g<a.length;g++){const P=a[g];r[P]=cf(i,l,P,y[P],e,!At(y,P))}}return f}function cf(e,t,r,n,i,a){const f=e[r];if(f!=null){const o=At(f,"default");if(o&&n===void 0){const l=f.default;if(f.type!==Function&&!f.skipFactory&&lt(l)){const{propsDefaults:y}=i;if(r in y)n=y[r];else{const g=Ta(i);n=y[r]=l.call(null,t),g()}}else n=l;i.ce&&i.ce._setProp(r,n)}f[0]&&(a&&!o?n=!1:f[1]&&(n===""||n===oi(r))&&(n=!0))}return n}const h0=new WeakMap;function ud(e,t,r=!1){const n=r?h0:t.propsCache,i=n.get(e);if(i)return i;const a=e.props,f={},o=[];let l=!1;if(!lt(e)){const g=P=>{l=!0;const[U,re]=ud(P,t,!0);Wt(f,U),re&&o.push(...re)};!r&&t.mixins.length&&t.mixins.forEach(g),e.extends&&g(e.extends),e.mixins&&e.mixins.forEach(g)}if(!a&&!l)return Ot(e)&&n.set(e,Ci),Ci;if(qe(a))for(let g=0;g<a.length;g++){const P=Dn(a[g]);Bc(P)&&(f[P]=Rt)}else if(a)for(const g in a){const P=Dn(g);if(Bc(P)){const U=a[g],re=f[P]=qe(U)||lt(U)?{type:U}:Wt({},U),ue=re.type;let Ie=!1,Qe=!0;if(qe(ue))for(let Ge=0;Ge<ue.length;++Ge){const Ze=ue[Ge],$e=lt(Ze)&&Ze.name;if($e==="Boolean"){Ie=!0;break}else $e==="String"&&(Qe=!1)}else Ie=lt(ue)&&ue.name==="Boolean";re[0]=Ie,re[1]=Qe,(Ie||At(re,"default"))&&o.push(P)}}const y=[f,o];return Ot(e)&&n.set(e,y),y}function Bc(e){return e[0]!=="$"&&!sa(e)}const dd=e=>e[0]==="_"||e==="$stable",Of=e=>qe(e)?e.map(Zr):[Zr(e)],p0=(e,t,r)=>{if(t._n)return t;const n=_s((...i)=>Of(t(...i)),r);return n._c=!1,n},hd=(e,t,r)=>{const n=e._ctx;for(const i in e){if(dd(i))continue;const a=e[i];if(lt(a))t[i]=p0(i,a,n);else if(a!=null){const f=Of(a);t[i]=()=>f}}},pd=(e,t)=>{const r=Of(t);e.slots.default=()=>r},md=(e,t,r)=>{for(const n in t)(r||n!=="_")&&(e[n]=t[n])},m0=(e,t,r)=>{const n=e.slots=fd();if(e.vnode.shapeFlag&32){const i=t._;i?(md(n,t,r),r&&yu(n,"_",i,!0)):hd(t,n)}else t&&pd(e,t)},v0=(e,t,r)=>{const{vnode:n,slots:i}=e;let a=!0,f=Rt;if(n.shapeFlag&32){const o=t._;o?r&&o===1?a=!1:md(i,t,r):(a=!t.$stable,hd(t,i)),f=t}else t&&(pd(e,t),f={default:1});if(a)for(const o in i)!dd(o)&&f[o]==null&&delete i[o]},Cr=O0;function _0(e){return g0(e)}function g0(e,t){const r=Rs();r.__VUE__=!0;const{insert:n,remove:i,patchProp:a,createElement:f,createText:o,createComment:l,setText:y,setElementText:g,parentNode:P,nextSibling:U,setScopeId:re=Jr,insertStaticContent:ue}=e,Ie=(A,R,H,le=null,ie=null,te=null,Pe=void 0,Te=null,Se=!!R.dynamicChildren)=>{if(A===R)return;A&&!ti(A,R)&&(le=li(A),Pr(A,ie,te,!0),A=null),R.patchFlag===-2&&(Se=!1,R.dynamicChildren=null);const{type:de,ref:c,shapeFlag:Me}=R;switch(de){case Ms:Qe(A,R,H,le);break;case xr:Ge(A,R,H,le);break;case Yo:A==null&&Ze(R,H,le,Pe);break;case wt:Fe(A,R,H,le,ie,te,Pe,Te,Se);break;default:Me&1?ke(A,R,H,le,ie,te,Pe,Te,Se):Me&6?_t(A,R,H,le,ie,te,Pe,Te,Se):(Me&64||Me&128)&&de.process(A,R,H,le,ie,te,Pe,Te,Se,Bn)}c!=null&&ie&&gs(c,A&&A.ref,te,R||A,!R)},Qe=(A,R,H,le)=>{if(A==null)n(R.el=o(R.children),H,le);else{const ie=R.el=A.el;R.children!==A.children&&y(ie,R.children)}},Ge=(A,R,H,le)=>{A==null?n(R.el=l(R.children||""),H,le):R.el=A.el},Ze=(A,R,H,le)=>{[A.el,A.anchor]=ue(A.children,R,H,le,A.el,A.anchor)},$e=({el:A,anchor:R},H,le)=>{let ie;for(;A&&A!==R;)ie=U(A),n(A,H,le),A=ie;n(R,H,le)},be=({el:A,anchor:R})=>{let H;for(;A&&A!==R;)H=U(A),i(A),A=H;i(R)},ke=(A,R,H,le,ie,te,Pe,Te,Se)=>{R.type==="svg"?Pe="svg":R.type==="math"&&(Pe="mathml"),A==null?We(R,H,le,ie,te,Pe,Te,Se):He(A,R,ie,te,Pe,Te,Se)},We=(A,R,H,le,ie,te,Pe,Te)=>{let Se,de;const{props:c,shapeFlag:Me,transition:Xe,dirs:rt}=A;if(Se=A.el=f(A.type,te,c&&c.is,c),Me&8?g(Se,A.children):Me&16&&Ft(A.children,Se,null,le,ie,Wo(A,te),Pe,Te),rt&&Qn(A,null,le,"created"),St(Se,A,A.scopeId,Pe,le),c){for(const gt in c)gt!=="value"&&!sa(gt)&&a(Se,gt,null,c[gt],te,le);"value"in c&&a(Se,"value",null,c.value,te),(de=c.onVnodeBeforeMount)&&Kr(de,le,A)}rt&&Qn(A,null,le,"beforeMount");const ht=y0(ie,Xe);ht&&Xe.beforeEnter(Se),n(Se,R,H),((de=c&&c.onVnodeMounted)||ht||rt)&&Cr(()=>{de&&Kr(de,le,A),ht&&Xe.enter(Se),rt&&Qn(A,null,le,"mounted")},ie)},St=(A,R,H,le,ie)=>{if(H&&re(A,H),le)for(let te=0;te<le.length;te++)re(A,le[te]);if(ie){let te=ie.subTree;if(R===te||xd(te.type)&&(te.ssContent===R||te.ssFallback===R)){const Pe=ie.vnode;St(A,Pe,Pe.scopeId,Pe.slotScopeIds,ie.parent)}}},Ft=(A,R,H,le,ie,te,Pe,Te,Se=0)=>{for(let de=Se;de<A.length;de++){const c=A[de]=Te?On(A[de]):Zr(A[de]);Ie(null,c,R,H,le,ie,te,Pe,Te)}},He=(A,R,H,le,ie,te,Pe)=>{const Te=R.el=A.el;let{patchFlag:Se,dynamicChildren:de,dirs:c}=R;Se|=A.patchFlag&16;const Me=A.props||Rt,Xe=R.props||Rt;let rt;if(H&&Zn(H,!1),(rt=Xe.onVnodeBeforeUpdate)&&Kr(rt,H,R,A),c&&Qn(R,A,H,"beforeUpdate"),H&&Zn(H,!0),(Me.innerHTML&&Xe.innerHTML==null||Me.textContent&&Xe.textContent==null)&&g(Te,""),de?et(A.dynamicChildren,de,Te,H,le,Wo(R,ie),te):Pe||Ct(A,R,Te,null,H,le,Wo(R,ie),te,!1),Se>0){if(Se&16)mt(Te,Me,Xe,H,ie);else if(Se&2&&Me.class!==Xe.class&&a(Te,"class",null,Xe.class,ie),Se&4&&a(Te,"style",Me.style,Xe.style,ie),Se&8){const ht=R.dynamicProps;for(let gt=0;gt<ht.length;gt++){const yt=ht[gt],qt=Me[yt],Qt=Xe[yt];(Qt!==qt||yt==="value")&&a(Te,yt,qt,Qt,ie,H)}}Se&1&&A.children!==R.children&&g(Te,R.children)}else!Pe&&de==null&&mt(Te,Me,Xe,H,ie);((rt=Xe.onVnodeUpdated)||c)&&Cr(()=>{rt&&Kr(rt,H,R,A),c&&Qn(R,A,H,"updated")},le)},et=(A,R,H,le,ie,te,Pe)=>{for(let Te=0;Te<R.length;Te++){const Se=A[Te],de=R[Te],c=Se.el&&(Se.type===wt||!ti(Se,de)||Se.shapeFlag&70)?P(Se.el):H;Ie(Se,de,c,null,le,ie,te,Pe,!0)}},mt=(A,R,H,le,ie)=>{if(R!==H){if(R!==Rt)for(const te in R)!sa(te)&&!(te in H)&&a(A,te,R[te],null,ie,le);for(const te in H){if(sa(te))continue;const Pe=H[te],Te=R[te];Pe!==Te&&te!=="value"&&a(A,te,Te,Pe,ie,le)}"value"in H&&a(A,"value",R.value,H.value,ie)}},Fe=(A,R,H,le,ie,te,Pe,Te,Se)=>{const de=R.el=A?A.el:o(""),c=R.anchor=A?A.anchor:o("");let{patchFlag:Me,dynamicChildren:Xe,slotScopeIds:rt}=R;rt&&(Te=Te?Te.concat(rt):rt),A==null?(n(de,H,le),n(c,H,le),Ft(R.children||[],H,c,ie,te,Pe,Te,Se)):Me>0&&Me&64&&Xe&&A.dynamicChildren?(et(A.dynamicChildren,Xe,H,ie,te,Pe,Te),(R.key!=null||ie&&R===ie.subTree)&&vd(A,R,!0)):Ct(A,R,H,c,ie,te,Pe,Te,Se)},_t=(A,R,H,le,ie,te,Pe,Te,Se)=>{R.slotScopeIds=Te,A==null?R.shapeFlag&512?ie.ctx.activate(R,H,le,Pe,Se):ft(R,H,le,ie,te,Pe,Se):Nr(A,R,Se)},ft=(A,R,H,le,ie,te,Pe)=>{const Te=A.component=N0(A,le,ie);if(Ds(A)&&(Te.ctx.renderer=Bn),k0(Te,!1,Pe),Te.asyncDep){if(ie&&ie.registerDep(Te,Yt,Pe),!A.el){const Se=Te.subTree=Vt(xr);Ge(null,Se,R,H)}}else Yt(Te,A,R,H,ie,te,Pe)},Nr=(A,R,H)=>{const le=R.component=A.component;if(L0(A,R,H))if(le.asyncDep&&!le.asyncResolved){Pt(le,R,H);return}else le.next=R,le.update();else R.el=A.el,le.vnode=R},Yt=(A,R,H,le,ie,te,Pe)=>{const Te=()=>{if(A.isMounted){let{next:Me,bu:Xe,u:rt,parent:ht,vnode:gt}=A;{const mr=_d(A);if(mr){Me&&(Me.el=gt.el,Pt(A,Me,Pe)),mr.asyncDep.then(()=>{A.isUnmounted||Te()});return}}let yt=Me,qt;Zn(A,!1),Me?(Me.el=gt.el,Pt(A,Me,Pe)):Me=gt,Xe&&cs(Xe),(qt=Me.props&&Me.props.onVnodeBeforeUpdate)&&Kr(qt,ht,Me,gt),Zn(A,!0);const Qt=Xo(A),Tr=A.subTree;A.subTree=Qt,Ie(Tr,Qt,P(Tr.el),li(Tr),A,ie,te),Me.el=Qt.el,yt===null&&R0(A,Qt.el),rt&&Cr(rt,ie),(qt=Me.props&&Me.props.onVnodeUpdated)&&Cr(()=>Kr(qt,ht,Me,gt),ie)}else{let Me;const{el:Xe,props:rt}=R,{bm:ht,m:gt,parent:yt,root:qt,type:Qt}=A,Tr=la(R);if(Zn(A,!1),ht&&cs(ht),!Tr&&(Me=rt&&rt.onVnodeBeforeMount)&&Kr(Me,yt,R),Zn(A,!0),Xe&&ki){const mr=()=>{A.subTree=Xo(A),ki(Xe,A.subTree,A,ie,null)};Tr&&Qt.__asyncHydrate?Qt.__asyncHydrate(Xe,A,mr):mr()}else{qt.ce&&qt.ce._injectChildStyle(Qt);const mr=A.subTree=Xo(A);Ie(null,mr,H,le,A,ie,te),R.el=mr.el}if(gt&&Cr(gt,ie),!Tr&&(Me=rt&&rt.onVnodeMounted)){const mr=R;Cr(()=>Kr(Me,yt,mr),ie)}(R.shapeFlag&256||yt&&la(yt.vnode)&&yt.vnode.shapeFlag&256)&&A.a&&Cr(A.a,ie),A.isMounted=!0,R=H=le=null}};A.scope.on();const Se=A.effect=new Au(Te);A.scope.off();const de=A.update=Se.run.bind(Se),c=A.job=Se.runIfDirty.bind(Se);c.i=A,c.id=A.uid,Se.scheduler=()=>Cf(c),Zn(A,!0),de()},Pt=(A,R,H)=>{R.component=A;const le=A.vnode.props;A.vnode=R,A.next=null,d0(A,R.props,le,H),v0(A,R.children,H),Mn(),Dc(A),Nn()},Ct=(A,R,H,le,ie,te,Pe,Te,Se=!1)=>{const de=A&&A.children,c=A?A.shapeFlag:0,Me=R.children,{patchFlag:Xe,shapeFlag:rt}=R;if(Xe>0){if(Xe&128){an(de,Me,H,le,ie,te,Pe,Te,Se);return}else if(Xe&256){nn(de,Me,H,le,ie,te,Pe,Te,Se);return}}rt&8?(c&16&&kn(de,ie,te),Me!==de&&g(H,Me)):c&16?rt&16?an(de,Me,H,le,ie,te,Pe,Te,Se):kn(de,ie,te,!0):(c&8&&g(H,""),rt&16&&Ft(Me,H,le,ie,te,Pe,Te,Se))},nn=(A,R,H,le,ie,te,Pe,Te,Se)=>{A=A||Ci,R=R||Ci;const de=A.length,c=R.length,Me=Math.min(de,c);let Xe;for(Xe=0;Xe<Me;Xe++){const rt=R[Xe]=Se?On(R[Xe]):Zr(R[Xe]);Ie(A[Xe],rt,H,null,ie,te,Pe,Te,Se)}de>c?kn(A,ie,te,!0,!1,Me):Ft(R,H,le,ie,te,Pe,Te,Se,Me)},an=(A,R,H,le,ie,te,Pe,Te,Se)=>{let de=0;const c=R.length;let Me=A.length-1,Xe=c-1;for(;de<=Me&&de<=Xe;){const rt=A[de],ht=R[de]=Se?On(R[de]):Zr(R[de]);if(ti(rt,ht))Ie(rt,ht,H,null,ie,te,Pe,Te,Se);else break;de++}for(;de<=Me&&de<=Xe;){const rt=A[Me],ht=R[Xe]=Se?On(R[Xe]):Zr(R[Xe]);if(ti(rt,ht))Ie(rt,ht,H,null,ie,te,Pe,Te,Se);else break;Me--,Xe--}if(de>Me){if(de<=Xe){const rt=Xe+1,ht=rt<c?R[rt].el:le;for(;de<=Xe;)Ie(null,R[de]=Se?On(R[de]):Zr(R[de]),H,ht,ie,te,Pe,Te,Se),de++}}else if(de>Xe)for(;de<=Me;)Pr(A[de],ie,te,!0),de++;else{const rt=de,ht=de,gt=new Map;for(de=ht;de<=Xe;de++){const ir=R[de]=Se?On(R[de]):Zr(R[de]);ir.key!=null&&gt.set(ir.key,de)}let yt,qt=0;const Qt=Xe-ht+1;let Tr=!1,mr=0;const yn=new Array(Qt);for(de=0;de<Qt;de++)yn[de]=0;for(de=rt;de<=Me;de++){const ir=A[de];if(qt>=Qt){Pr(ir,ie,te,!0);continue}let Ar;if(ir.key!=null)Ar=gt.get(ir.key);else for(yt=ht;yt<=Xe;yt++)if(yn[yt-ht]===0&&ti(ir,R[yt])){Ar=yt;break}Ar===void 0?Pr(ir,ie,te,!0):(yn[Ar-ht]=de+1,Ar>=mr?mr=Ar:Tr=!0,Ie(ir,R[Ar],H,null,ie,te,Pe,Te,Se),qt++)}const sr=Tr?b0(yn):Ci;for(yt=sr.length-1,de=Qt-1;de>=0;de--){const ir=ht+de,Ar=R[ir],La=ir+1<c?R[ir+1].el:le;yn[de]===0?Ie(null,Ar,H,La,ie,te,Pe,Te,Se):Tr&&(yt<0||de!==sr[yt]?Hr(Ar,H,La,2):yt--)}}},Hr=(A,R,H,le,ie=null)=>{const{el:te,type:Pe,transition:Te,children:Se,shapeFlag:de}=A;if(de&6){Hr(A.component.subTree,R,H,le);return}if(de&128){A.suspense.move(R,H,le);return}if(de&64){Pe.move(A,R,H,Bn);return}if(Pe===wt){n(te,R,H);for(let Me=0;Me<Se.length;Me++)Hr(Se[Me],R,H,le);n(A.anchor,R,H);return}if(Pe===Yo){$e(A,R,H);return}if(le!==2&&de&1&&Te)if(le===0)Te.beforeEnter(te),n(te,R,H),Cr(()=>Te.enter(te),ie);else{const{leave:Me,delayLeave:Xe,afterLeave:rt}=Te,ht=()=>n(te,R,H),gt=()=>{Me(te,()=>{ht(),rt&&rt()})};Xe?Xe(te,ht,gt):gt()}else n(te,R,H)},Pr=(A,R,H,le=!1,ie=!1)=>{const{type:te,props:Pe,ref:Te,children:Se,dynamicChildren:de,shapeFlag:c,patchFlag:Me,dirs:Xe,cacheIndex:rt}=A;if(Me===-2&&(ie=!1),Te!=null&&gs(Te,null,H,A,!0),rt!=null&&(R.renderCache[rt]=void 0),c&256){R.ctx.deactivate(A);return}const ht=c&1&&Xe,gt=!la(A);let yt;if(gt&&(yt=Pe&&Pe.onVnodeBeforeUnmount)&&Kr(yt,R,A),c&6)$s(A.component,H,le);else{if(c&128){A.suspense.unmount(H,le);return}ht&&Qn(A,null,R,"beforeUnmount"),c&64?A.type.remove(A,R,H,Bn,le):de&&!de.hasOnce&&(te!==wt||Me>0&&Me&64)?kn(de,R,H,!1,!0):(te===wt&&Me&384||!ie&&c&16)&&kn(Se,R,H),le&&wa(A)}(gt&&(yt=Pe&&Pe.onVnodeUnmounted)||ht)&&Cr(()=>{yt&&Kr(yt,R,A),ht&&Qn(A,null,R,"unmounted")},H)},wa=A=>{const{type:R,el:H,anchor:le,transition:ie}=A;if(R===wt){Us(H,le);return}if(R===Yo){be(A);return}const te=()=>{i(H),ie&&!ie.persisted&&ie.afterLeave&&ie.afterLeave()};if(A.shapeFlag&1&&ie&&!ie.persisted){const{leave:Pe,delayLeave:Te}=ie,Se=()=>Pe(H,te);Te?Te(A.el,te,Se):Se()}else te()},Us=(A,R)=>{let H;for(;A!==R;)H=U(A),i(A),A=H;i(R)},$s=(A,R,H)=>{const{bum:le,scope:ie,job:te,subTree:Pe,um:Te,m:Se,a:de}=A;Uc(Se),Uc(de),le&&cs(le),ie.stop(),te&&(te.flags|=8,Pr(Pe,A,R,H)),Te&&Cr(Te,R),Cr(()=>{A.isUnmounted=!0},R),R&&R.pendingBranch&&!R.isUnmounted&&A.asyncDep&&!A.asyncResolved&&A.suspenseId===R.pendingId&&(R.deps--,R.deps===0&&R.resolve())},kn=(A,R,H,le=!1,ie=!1,te=0)=>{for(let Pe=te;Pe<A.length;Pe++)Pr(A[Pe],R,H,le,ie)},li=A=>{if(A.shapeFlag&6)return li(A.component.subTree);if(A.shapeFlag&128)return A.suspense.next();const R=U(A.anchor||A.el),H=R&&R[jv];return H?U(H):R};let Ni=!1;const Sa=(A,R,H)=>{A==null?R._vnode&&Pr(R._vnode,null,null,!0):Ie(R._vnode||null,A,R,null,null,null,H),R._vnode=A,Ni||(Ni=!0,Dc(),ju(),Ni=!1)},Bn={p:Ie,um:Pr,m:Hr,r:wa,mt:ft,mc:Ft,pc:Ct,pbc:et,n:li,o:e};let Ca,ki;return{render:Sa,hydrate:Ca,createApp:l0(Sa,Ca)}}function Wo({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function Zn({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function y0(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function vd(e,t,r=!1){const n=e.children,i=t.children;if(qe(n)&&qe(i))for(let a=0;a<n.length;a++){const f=n[a];let o=i[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[a]=On(i[a]),o.el=f.el),!r&&o.patchFlag!==-2&&vd(f,o)),o.type===Ms&&(o.el=f.el)}}function b0(e){const t=e.slice(),r=[0];let n,i,a,f,o;const l=e.length;for(n=0;n<l;n++){const y=e[n];if(y!==0){if(i=r[r.length-1],e[i]<y){t[n]=i,r.push(n);continue}for(a=0,f=r.length-1;a<f;)o=a+f>>1,e[r[o]]<y?a=o+1:f=o;y<e[r[a]]&&(a>0&&(t[n]=r[a-1]),r[a]=n)}}for(a=r.length,f=r[a-1];a-- >0;)r[a]=f,f=t[f];return r}function _d(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:_d(t)}function Uc(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const x0=Symbol.for("v-scx"),E0=()=>us(x0);function Pi(e,t,r){return gd(e,t,r)}function gd(e,t,r=Rt){const{immediate:n,deep:i,flush:a,once:f}=r,o=Wt({},r),l=t&&n||!t&&a!=="post";let y;if(ga){if(a==="sync"){const re=E0();y=re.__watcherHandles||(re.__watcherHandles=[])}else if(!l){const re=()=>{};return re.stop=Jr,re.resume=Jr,re.pause=Jr,re}}const g=hr;o.call=(re,ue,Ie)=>jr(re,g,ue,Ie);let P=!1;a==="post"?o.scheduler=re=>{Cr(re,g&&g.suspense)}:a!=="sync"&&(P=!0,o.scheduler=(re,ue)=>{ue?re():Cf(re)}),o.augmentJob=re=>{t&&(re.flags|=4),P&&(re.flags|=2,g&&(re.id=g.uid,re.i=g))};const U=Bv(e,t,o);return ga&&(y?y.push(U):l&&U()),U}function T0(e,t,r){const n=this.proxy,i=Xt(e)?e.includes(".")?yd(n,e):()=>n[e]:e.bind(n,n);let a;lt(t)?a=t:(a=t.handler,r=t);const f=Ta(this),o=gd(i,a.bind(n),r);return f(),o}function yd(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}const A0=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Dn(t)}Modifiers`]||e[`${oi(t)}Modifiers`];function w0(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Rt;let i=r;const a=t.startsWith("update:"),f=a&&A0(n,t.slice(7));f&&(f.trim&&(i=r.map(g=>Xt(g)?g.trim():g)),f.number&&(i=r.map(Zo)));let o,l=n[o=Bo(t)]||n[o=Bo(Dn(t))];!l&&a&&(l=n[o=Bo(oi(t))]),l&&jr(l,e,6,i);const y=n[o+"Once"];if(y){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,jr(y,e,6,i)}}function bd(e,t,r=!1){const n=t.emitsCache,i=n.get(e);if(i!==void 0)return i;const a=e.emits;let f={},o=!1;if(!lt(e)){const l=y=>{const g=bd(y,t,!0);g&&(o=!0,Wt(f,g))};!r&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!a&&!o?(Ot(e)&&n.set(e,null),null):(qe(a)?a.forEach(l=>f[l]=null):Wt(f,a),Ot(e)&&n.set(e,f),f)}function Gs(e,t){return!e||!Ss(t)?!1:(t=t.slice(2).replace(/Once$/,""),At(e,t[0].toLowerCase()+t.slice(1))||At(e,oi(t))||At(e,t))}function Xo(e){const{type:t,vnode:r,proxy:n,withProxy:i,propsOptions:[a],slots:f,attrs:o,emit:l,render:y,renderCache:g,props:P,data:U,setupState:re,ctx:ue,inheritAttrs:Ie}=e,Qe=vs(e);let Ge,Ze;try{if(r.shapeFlag&4){const be=i||n,ke=be;Ge=Zr(y.call(ke,be,g,P,re,U,ue)),Ze=o}else{const be=t;Ge=Zr(be.length>1?be(P,{attrs:o,slots:f,emit:l}):be(P,null)),Ze=t.props?o:S0(o)}}catch(be){ua.length=0,Ps(be,e,1),Ge=Vt(xr)}let $e=Ge;if(Ze&&Ie!==!1){const be=Object.keys(Ze),{shapeFlag:ke}=$e;be.length&&ke&7&&(a&&be.some(vf)&&(Ze=C0(Ze,a)),$e=In($e,Ze,!1,!0))}return r.dirs&&($e=In($e,null,!1,!0),$e.dirs=$e.dirs?$e.dirs.concat(r.dirs):r.dirs),r.transition&&si($e,r.transition),Ge=$e,vs(Qe),Ge}const S0=e=>{let t;for(const r in e)(r==="class"||r==="style"||Ss(r))&&((t||(t={}))[r]=e[r]);return t},C0=(e,t)=>{const r={};for(const n in e)(!vf(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function L0(e,t,r){const{props:n,children:i,component:a}=e,{props:f,children:o,patchFlag:l}=t,y=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?$c(n,f,y):!!f;if(l&8){const g=t.dynamicProps;for(let P=0;P<g.length;P++){const U=g[P];if(f[U]!==n[U]&&!Gs(y,U))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===f?!1:n?f?$c(n,f,y):!0:!!f;return!1}function $c(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const a=n[i];if(t[a]!==e[a]&&!Gs(r,a))return!0}return!1}function R0({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const xd=e=>e.__isSuspense;function O0(e,t){t&&t.pendingBranch?qe(e)?t.effects.push(...e):t.effects.push(e):Vv(e)}const wt=Symbol.for("v-fgt"),Ms=Symbol.for("v-txt"),xr=Symbol.for("v-cmt"),Yo=Symbol.for("v-stc"),ua=[];let Fr=null;function tt(e=!1){ua.push(Fr=e?null:[])}function F0(){ua.pop(),Fr=ua[ua.length-1]||null}let _a=1;function Vc(e,t=!1){_a+=e,e<0&&Fr&&t&&(Fr.hasOnce=!0)}function Ed(e){return e.dynamicChildren=_a>0?Fr||Ci:null,F0(),_a>0&&Fr&&Fr.push(e),e}function ot(e,t,r,n,i,a){return Ed(Ne(e,t,r,n,i,a,!0))}function da(e,t,r,n,i){return Ed(Vt(e,t,r,n,i,!0))}function bs(e){return e?e.__v_isVNode===!0:!1}function ti(e,t){return e.type===t.type&&e.key===t.key}const Td=({key:e})=>e??null,ds=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?Xt(e)||pr(e)||lt(e)?{i:Or,r:e,k:t,f:!!r}:e:null);function Ne(e,t=null,r=null,n=0,i=null,a=e===wt?0:1,f=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Td(t),ref:t&&ds(t),scopeId:zu,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Or};return o?(Ff(l,r),a&128&&e.normalize(l)):r&&(l.shapeFlag|=Xt(r)?8:16),_a>0&&!f&&Fr&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&Fr.push(l),l}const Vt=P0;function P0(e,t=null,r=null,n=0,i=null,a=!1){if((!e||e===t0)&&(e=xr),bs(e)){const o=In(e,t,!0);return r&&Ff(o,r),_a>0&&!a&&Fr&&(o.shapeFlag&6?Fr[Fr.indexOf(e)]=o:Fr.push(o)),o.patchFlag=-2,o}if(V0(e)&&(e=e.__vccOpts),t){t=D0(t);let{class:o,style:l}=t;o&&!Xt(o)&&(t.class=xa(o)),Ot(l)&&(Sf(l)&&!qe(l)&&(l=Wt({},l)),t.style=ba(l))}const f=Xt(e)?1:xd(e)?128:Wu(e)?64:Ot(e)?4:lt(e)?2:0;return Ne(e,t,r,n,i,f,a,!0)}function D0(e){return e?Sf(e)||ld(e)?Wt({},e):e:null}function In(e,t,r=!1,n=!1){const{props:i,ref:a,patchFlag:f,children:o,transition:l}=e,y=t?I0(i||{},t):i,g={__v_isVNode:!0,__v_skip:!0,type:e.type,props:y,key:y&&Td(y),ref:t&&t.ref?r&&a?qe(a)?a.concat(ds(t)):[a,ds(t)]:ds(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==wt?f===-1?16:f|16:f,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&In(e.ssContent),ssFallback:e.ssFallback&&In(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&n&&si(g,l.clone(g)),g}function vt(e=" ",t=0){return Vt(Ms,null,e,t)}function Rr(e="",t=!1){return t?(tt(),da(xr,null,e)):Vt(xr,null,e)}function Zr(e){return e==null||typeof e=="boolean"?Vt(xr):qe(e)?Vt(wt,null,e.slice()):bs(e)?On(e):Vt(Ms,null,String(e))}function On(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:In(e)}function Ff(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(qe(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),Ff(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!ld(t)?t._ctx=Or:i===3&&Or&&(Or.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else lt(t)?(t={default:t,_ctx:Or},r=32):(t=String(t),n&64?(r=16,t=[vt(t)]):r=8);e.children=t,e.shapeFlag|=r}function I0(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=xa([t.class,n.class]));else if(i==="style")t.style=ba([t.style,n.style]);else if(Ss(i)){const a=t[i],f=n[i];f&&a!==f&&!(qe(a)&&a.includes(f))&&(t[i]=a?[].concat(a,f):f)}else i!==""&&(t[i]=n[i])}return t}function Kr(e,t,r,n=null){jr(e,t,7,[r,n])}const G0=sd();let M0=0;function N0(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||G0,a={uid:M0++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new hv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ud(n,i),emitsOptions:bd(n,i),emit:null,emitted:null,propsDefaults:Rt,inheritAttrs:n.inheritAttrs,ctx:Rt,data:Rt,props:Rt,attrs:Rt,slots:Rt,refs:Rt,setupState:Rt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=w0.bind(null,a),e.ce&&e.ce(a),a}let hr=null;const Pf=()=>hr||Or;let xs,uf;{const e=Rs(),t=(r,n)=>{let i;return(i=e[r])||(i=e[r]=[]),i.push(n),a=>{i.length>1?i.forEach(f=>f(a)):i[0](a)}};xs=t("__VUE_INSTANCE_SETTERS__",r=>hr=r),uf=t("__VUE_SSR_SETTERS__",r=>ga=r)}const Ta=e=>{const t=hr;return xs(e),e.scope.on(),()=>{e.scope.off(),xs(t)}},jc=()=>{hr&&hr.scope.off(),xs(null)};function Ad(e){return e.vnode.shapeFlag&4}let ga=!1;function k0(e,t=!1,r=!1){t&&uf(t);const{props:n,children:i}=e.vnode,a=Ad(e);u0(e,n,a,t),m0(e,i,r);const f=a?B0(e,t):void 0;return t&&uf(!1),f}function B0(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,r0);const{setup:n}=r;if(n){Mn();const i=e.setupContext=n.length>1?$0(e):null,a=Ta(e),f=Ea(n,e,0,[e.props,i]),o=mu(f);if(Nn(),a(),(o||e.sp)&&!la(e)&&Zu(e),o){if(f.then(jc,jc),t)return f.then(l=>{Hc(e,l,t)}).catch(l=>{Ps(l,e,0)});e.asyncDep=f}else Hc(e,f,t)}else wd(e,t)}function Hc(e,t,r){lt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ot(t)&&(e.setupState=Uu(t)),wd(e,r)}let zc;function wd(e,t,r){const n=e.type;if(!e.render){if(!t&&zc&&!n.render){const i=n.template||Rf(e).template;if(i){const{isCustomElement:a,compilerOptions:f}=e.appContext.config,{delimiters:o,compilerOptions:l}=n,y=Wt(Wt({isCustomElement:a,delimiters:o},f),l);n.render=zc(i,y)}}e.render=n.render||Jr}{const i=Ta(e);Mn();try{n0(e)}finally{Nn(),i()}}}const U0={get(e,t){return cr(e,"get",""),e[t]}};function $0(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,U0),slots:e.slots,emit:e.emit,expose:t}}function Ns(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Uu(Dv(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in ca)return ca[r](e)},has(t,r){return r in t||r in ca}})):e.proxy}function V0(e){return lt(e)&&"__vccOpts"in e}const Mi=(e,t)=>af(e,t,ga);function j0(e,t,r){const n=arguments.length;return n===2?Ot(t)&&!qe(t)?bs(t)?Vt(e,null,[t]):Vt(e,t):Vt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&bs(r)&&(r=[r]),Vt(e,t,r))}const H0="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let df;const Wc=typeof window<"u"&&window.trustedTypes;if(Wc)try{df=Wc.createPolicy("vue",{createHTML:e=>e})}catch{}const Sd=df?e=>df.createHTML(e):e=>e,z0="http://www.w3.org/2000/svg",W0="http://www.w3.org/1998/Math/MathML",dn=typeof document<"u"?document:null,Xc=dn&&dn.createElement("template"),X0={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t==="svg"?dn.createElementNS(z0,e):t==="mathml"?dn.createElementNS(W0,e):r?dn.createElement(e,{is:r}):dn.createElement(e);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>dn.createTextNode(e),createComment:e=>dn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>dn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,i,a){const f=r?r.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===a||!(i=i.nextSibling)););else{Xc.innerHTML=Sd(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const o=Xc.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,r)}return[f?f.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},Sn="transition",na="animation",Ii=Symbol("_vtc"),Cd={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Ld=Wt({},Yu,Cd),Y0=e=>(e.displayName="Transition",e.props=Ld,e),K0=Y0((e,{slots:t})=>j0(zv,Rd(e),t)),Jn=(e,t=[])=>{qe(e)?e.forEach(r=>r(...t)):e&&e(...t)},Yc=e=>e?qe(e)?e.some(t=>t.length>1):e.length>1:!1;function Rd(e){const t={};for(const Fe in e)Fe in Cd||(t[Fe]=e[Fe]);if(e.css===!1)return t;const{name:r="v",type:n,duration:i,enterFromClass:a=`${r}-enter-from`,enterActiveClass:f=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:l=a,appearActiveClass:y=f,appearToClass:g=o,leaveFromClass:P=`${r}-leave-from`,leaveActiveClass:U=`${r}-leave-active`,leaveToClass:re=`${r}-leave-to`}=e,ue=q0(i),Ie=ue&&ue[0],Qe=ue&&ue[1],{onBeforeEnter:Ge,onEnter:Ze,onEnterCancelled:$e,onLeave:be,onLeaveCancelled:ke,onBeforeAppear:We=Ge,onAppear:St=Ze,onAppearCancelled:Ft=$e}=t,He=(Fe,_t,ft,Nr)=>{Fe._enterCancelled=Nr,Cn(Fe,_t?g:o),Cn(Fe,_t?y:f),ft&&ft()},et=(Fe,_t)=>{Fe._isLeaving=!1,Cn(Fe,P),Cn(Fe,re),Cn(Fe,U),_t&&_t()},mt=Fe=>(_t,ft)=>{const Nr=Fe?St:Ze,Yt=()=>He(_t,Fe,ft);Jn(Nr,[_t,Yt]),Kc(()=>{Cn(_t,Fe?l:a),qr(_t,Fe?g:o),Yc(Nr)||qc(_t,n,Ie,Yt)})};return Wt(t,{onBeforeEnter(Fe){Jn(Ge,[Fe]),qr(Fe,a),qr(Fe,f)},onBeforeAppear(Fe){Jn(We,[Fe]),qr(Fe,l),qr(Fe,y)},onEnter:mt(!1),onAppear:mt(!0),onLeave(Fe,_t){Fe._isLeaving=!0;const ft=()=>et(Fe,_t);qr(Fe,P),Fe._enterCancelled?(qr(Fe,U),hf()):(hf(),qr(Fe,U)),Kc(()=>{Fe._isLeaving&&(Cn(Fe,P),qr(Fe,re),Yc(be)||qc(Fe,n,Qe,ft))}),Jn(be,[Fe,ft])},onEnterCancelled(Fe){He(Fe,!1,void 0,!0),Jn($e,[Fe])},onAppearCancelled(Fe){He(Fe,!0,void 0,!0),Jn(Ft,[Fe])},onLeaveCancelled(Fe){et(Fe),Jn(ke,[Fe])}})}function q0(e){if(e==null)return null;if(Ot(e))return[Ko(e.enter),Ko(e.leave)];{const t=Ko(e);return[t,t]}}function Ko(e){return av(e)}function qr(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e[Ii]||(e[Ii]=new Set)).add(t)}function Cn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const r=e[Ii];r&&(r.delete(t),r.size||(e[Ii]=void 0))}function Kc(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Q0=0;function qc(e,t,r,n){const i=e._endId=++Q0,a=()=>{i===e._endId&&n()};if(r!=null)return setTimeout(a,r);const{type:f,timeout:o,propCount:l}=Od(e,t);if(!f)return n();const y=f+"end";let g=0;const P=()=>{e.removeEventListener(y,U),a()},U=re=>{re.target===e&&++g>=l&&P()};setTimeout(()=>{g<l&&P()},o+1),e.addEventListener(y,U)}function Od(e,t){const r=window.getComputedStyle(e),n=ue=>(r[ue]||"").split(", "),i=n(`${Sn}Delay`),a=n(`${Sn}Duration`),f=Qc(i,a),o=n(`${na}Delay`),l=n(`${na}Duration`),y=Qc(o,l);let g=null,P=0,U=0;t===Sn?f>0&&(g=Sn,P=f,U=a.length):t===na?y>0&&(g=na,P=y,U=l.length):(P=Math.max(f,y),g=P>0?f>y?Sn:na:null,U=g?g===Sn?a.length:l.length:0);const re=g===Sn&&/\b(transform|all)(,|$)/.test(n(`${Sn}Property`).toString());return{type:g,timeout:P,propCount:U,hasTransform:re}}function Qc(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,n)=>Zc(r)+Zc(e[n])))}function Zc(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function hf(){return document.body.offsetHeight}function Z0(e,t,r){const n=e[Ii];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const Jc=Symbol("_vod"),J0=Symbol("_vsh"),e_=Symbol(""),t_=/(^|;)\s*display\s*:/;function r_(e,t,r){const n=e.style,i=Xt(r);let a=!1;if(r&&!i){if(t)if(Xt(t))for(const f of t.split(";")){const o=f.slice(0,f.indexOf(":")).trim();r[o]==null&&hs(n,o,"")}else for(const f in t)r[f]==null&&hs(n,f,"");for(const f in r)f==="display"&&(a=!0),hs(n,f,r[f])}else if(i){if(t!==r){const f=n[e_];f&&(r+=";"+f),n.cssText=r,a=t_.test(r)}}else t&&e.removeAttribute("style");Jc in e&&(e[Jc]=a?n.display:"",e[J0]&&(n.display="none"))}const eu=/\s*!important$/;function hs(e,t,r){if(qe(r))r.forEach(n=>hs(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=n_(e,t);eu.test(r)?e.setProperty(oi(n),r.replace(eu,""),"important"):e[n]=r}}const tu=["Webkit","Moz","ms"],qo={};function n_(e,t){const r=qo[t];if(r)return r;let n=Dn(t);if(n!=="filter"&&n in e)return qo[t]=n;n=gu(n);for(let i=0;i<tu.length;i++){const a=tu[i]+n;if(a in e)return qo[t]=a}return t}const ru="http://www.w3.org/1999/xlink";function nu(e,t,r,n,i,a=uv(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(ru,t.slice(6,t.length)):e.setAttributeNS(ru,t,r):r==null||a&&!bu(r)?e.removeAttribute(t):e.setAttribute(t,a?"":tn(r)?String(r):r)}function iu(e,t,r,n,i){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?Sd(r):r);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const o=a==="OPTION"?e.getAttribute("value")||"":e.value,l=r==null?e.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in e))&&(e.value=l),r==null&&e.removeAttribute(t),e._value=r;return}let f=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=bu(r):r==null&&o==="string"?(r="",f=!0):o==="number"&&(r=0,f=!0)}try{e[t]=r}catch{}f&&e.removeAttribute(i||t)}function ri(e,t,r,n){e.addEventListener(t,r,n)}function i_(e,t,r,n){e.removeEventListener(t,r,n)}const au=Symbol("_vei");function a_(e,t,r,n,i=null){const a=e[au]||(e[au]={}),f=a[t];if(n&&f)f.value=n;else{const[o,l]=s_(t);if(n){const y=a[t]=l_(n,i);ri(e,o,y,l)}else f&&(i_(e,o,f,l),a[t]=void 0)}}const su=/(?:Once|Passive|Capture)$/;function s_(e){let t;if(su.test(e)){t={};let n;for(;n=e.match(su);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):oi(e.slice(2)),t]}let Qo=0;const o_=Promise.resolve(),f_=()=>Qo||(o_.then(()=>Qo=0),Qo=Date.now());function l_(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;jr(c_(n,r.value),t,5,[n])};return r.value=e,r.attached=f_(),r}function c_(e,t){if(qe(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const ou=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,u_=(e,t,r,n,i,a)=>{const f=i==="svg";t==="class"?Z0(e,n,f):t==="style"?r_(e,r,n):Ss(t)?vf(t)||a_(e,t,r,n,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):d_(e,t,n,f))?(iu(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&nu(e,t,n,f,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Xt(n))?iu(e,Dn(t),n,a,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),nu(e,t,n,f))};function d_(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&ou(t)&&lt(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return ou(t)&&Xt(r)?!1:t in e}const Fd=new WeakMap,Pd=new WeakMap,Es=Symbol("_moveCb"),fu=Symbol("_enterCb"),h_=e=>(delete e.props.mode,e),p_=h_({name:"TransitionGroup",props:Wt({},Ld,{tag:String,moveClass:String}),setup(e,{slots:t}){const r=Pf(),n=Xu();let i,a;return rd(()=>{if(!i.length)return;const f=e.moveClass||`${e.name||"v"}-move`;if(!g_(i[0].el,r.vnode.el,f))return;i.forEach(m_),i.forEach(v_);const o=i.filter(__);hf(),o.forEach(l=>{const y=l.el,g=y.style;qr(y,f),g.transform=g.webkitTransform=g.transitionDuration="";const P=y[Es]=U=>{U&&U.target!==y||(!U||/transform$/.test(U.propertyName))&&(y.removeEventListener("transitionend",P),y[Es]=null,Cn(y,f))};y.addEventListener("transitionend",P)})}),()=>{const f=xt(e),o=Rd(f);let l=f.tag||wt;if(i=[],a)for(let y=0;y<a.length;y++){const g=a[y];g.el&&g.el instanceof Element&&(i.push(g),si(g,va(g,o,n,r)),Fd.set(g,g.el.getBoundingClientRect()))}a=t.default?Lf(t.default()):[];for(let y=0;y<a.length;y++){const g=a[y];g.key!=null&&si(g,va(g,o,n,r))}return Vt(l,null,a)}}}),Dd=p_;function m_(e){const t=e.el;t[Es]&&t[Es](),t[fu]&&t[fu]()}function v_(e){Pd.set(e,e.el.getBoundingClientRect())}function __(e){const t=Fd.get(e),r=Pd.get(e),n=t.left-r.left,i=t.top-r.top;if(n||i){const a=e.el.style;return a.transform=a.webkitTransform=`translate(${n}px,${i}px)`,a.transitionDuration="0s",e}}function g_(e,t,r){const n=e.cloneNode(),i=e[Ii];i&&i.forEach(o=>{o.split(/\s+/).forEach(l=>l&&n.classList.remove(l))}),r.split(/\s+/).forEach(o=>o&&n.classList.add(o)),n.style.display="none";const a=t.nodeType===1?t:t.parentNode;a.appendChild(n);const{hasTransform:f}=Od(n);return a.removeChild(n),f}const Ts=e=>{const t=e.props["onUpdate:modelValue"]||!1;return qe(t)?r=>cs(t,r):t};function y_(e){e.target.composing=!0}function lu(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Di=Symbol("_assign"),_r={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e[Di]=Ts(i);const a=n||i.props&&i.props.type==="number";ri(e,t?"change":"input",f=>{if(f.target.composing)return;let o=e.value;r&&(o=o.trim()),a&&(o=Zo(o)),e[Di](o)}),r&&ri(e,"change",()=>{e.value=e.value.trim()}),t||(ri(e,"compositionstart",y_),ri(e,"compositionend",lu),ri(e,"change",lu))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:i,number:a}},f){if(e[Di]=Ts(f),e.composing)return;const o=(a||e.type==="number")&&!/^0\d/.test(e.value)?Zo(e.value):e.value,l=t??"";o!==l&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||i&&e.value.trim()===l)||(e.value=l))}},b_={deep:!0,created(e,t,r){e[Di]=Ts(r),ri(e,"change",()=>{const n=e._modelValue,i=x_(e),a=e.checked,f=e[Di];if(qe(n)){const o=xu(n,i),l=o!==-1;if(a&&!l)f(n.concat(i));else if(!a&&l){const y=[...n];y.splice(o,1),f(y)}}else if(Cs(n)){const o=new Set(n);a?o.add(i):o.delete(i),f(o)}else f(Id(e,a))})},mounted:cu,beforeUpdate(e,t,r){e[Di]=Ts(r),cu(e,t,r)}};function cu(e,{value:t,oldValue:r},n){e._modelValue=t;let i;if(qe(t))i=xu(t,n.props.value)>-1;else if(Cs(t))i=t.has(n.props.value);else{if(t===r)return;i=Os(t,Id(e,!0))}e.checked!==i&&(e.checked=i)}function x_(e){return"_value"in e?e._value:e.value}function Id(e,t){const r=t?"_trueValue":"_falseValue";return r in e?e[r]:t}const E_=["ctrl","shift","alt","meta"],T_={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>E_.some(r=>e[`${r}Key`]&&!t.includes(r))},Gd=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=(i,...a)=>{for(let f=0;f<t.length;f++){const o=T_[t[f]];if(o&&o(i,t))return}return e(i,...a)})},A_=Wt({patchProp:u_},X0);let uu;function w_(){return uu||(uu=_0(A_))}const S_=(...e)=>{const t=w_().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=L_(n);if(!i)return;const a=t._component;!lt(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const f=r(i,!1,C_(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),f},t};function C_(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function L_(e){return Xt(e)?document.querySelector(e):e}const Gn=()=>R_,R_=Af(new class{constructor(){Oe(this,"textures",new Map);Oe(this,"sounds",new Map);Oe(this,"loadings",0);Oe(this,"logs",[])}log(t){this.logs.push(t)}loadTexture(t,r){this.log(`Loading texture "${t}" from "${r}"`);const n=new Image;n.src=r,this.loadings++,n.onload=async()=>{this.log(`Texture "${t}" loaded`),this.textures.set(t,n),this.loadings--}}loadSound(t,r){this.log(`Loading sound "${t}" from "${r}"`);const n=new Audio(r);this.loadings++,n.oncanplaythrough=()=>{this.log(`Sound "${t}" loaded`),this.sounds.set(t,n),this.loadings--}}getTexture(t){return this.textures.get(t)}getSound(t){return this.sounds.get(t)}dropTexture(t){this.textures.has(t)&&this.textures.delete(t)}isFinished(){return this.loadings===0}}),bt=fi({enabled:!1,x:0,y:0,z:0,angleX:0,angleY:0,angleZ:0,scaleX:1,scaleY:1,scaleZ:1,transition:!0});let ls=class{constructor(){Oe(this,"callback");Oe(this,"accept",[]);Oe(this,"receive",!1);Oe(this,"text","")}async input(t,r=[]){return this.receive=!0,this.text=t,new Promise(n=>{this.accept=r,this.callback=n})}resolve(t){if(!this.callback)throw new Error("No callback");this.callback(t),this.callback=void 0,this.receive=!1,this.text="",this.accept=[]}};const dr=()=>O_;let O_=fi(new class{constructor(){Oe(this,"next",new ls);Oe(this,"move",new ls);Oe(this,"confirm",new ls);Oe(this,"players",new ls)}wait(t){return bt.transition||(t=0),new Promise(r=>setTimeout(r,t))}});var dt=(e=>(e.UP="up",e.RIGHT="right",e.DOWN="down",e.LEFT="left",e))(dt||{});const Et=()=>F_,F_=fi(new class{constructor(){Oe(this,"players",new Map);Oe(this,"dices");Oe(this,"steps");Oe(this,"inning",0);Oe(this,"winner");Oe(this,"victoryScore",1e3);Oe(this,"quantity",0);Oe(this,"messages",new class{constructor(){Oe(this,"inner",new Map);Oe(this,"counter",0)}push(r,n=5e3){const i=this.counter++;return this.inner.set(i,r),n!==0&&setTimeout(()=>this.inner.delete(i),n),i}remove(r){this.inner.delete(r)}length(){return this.inner.size}toArray(){return Array.from(this.inner.values())}});Oe(this,"playersLabel",[]);Oe(this,"event");Oe(this,"traps",[])}setEvent(t,r,n,i=!1){return new Promise(a=>{const[f,o,l]=n;this.event={type:r,title:f,hasFail:i,description:o.trim().replaceAll(`
`,"<br>"),callback:async y=>{this.event=void 0,await l(t,y),a()}}})}withoutPlayer(t){return Array.from(this.players.values()).filter(r=>r!==t)}async throwDice(t,r=!1,n){const i=dr(),a=r?2:1,f=1500,o=15;for(let y=0;y<o;y++)this.dices=Array.from({length:a},()=>Math.floor(Math.random()*6)+1),await i.wait(f/o);n&&(this.dices=this.dices.map(y=>n.shift()??y)),await i.next.input(t);const l=this.dices.reduce((y,g)=>y+g,0);return this.dices=void 0,l}}),P_={class:"player"},D_=rn({__name:"GameOver",setup(e){const t=Et(),r=Mi(()=>Array.from(t.players.values())),n=()=>location.reload();return(i,a)=>(tt(),ot(wt,null,[a[0]||(a[0]=Ne("h1",null,"遊戲結束",-1)),vt(" 總回合數: "+ut(De(t).inning),1),a[1]||(a[1]=Ne("br",null,null,-1)),vt(" 最終贏家是... 第 "+ut(De(t).winner.id)+" 組！ ",1),(tt(!0),ot(wt,null,$r(r.value.toSorted((f,o)=>o.score-f.score),f=>(tt(),ot("div",P_,[Ne("h3",null,[vt("第 "+ut(f.id)+" 組 ",1),Ne("i",null,ut(f===De(t).winner?"👑":"👻"),1)]),Ne("span",null,"分數: "+ut(f.score),1)]))),256)),Ne("button",{onClick:n},"重新開始")],64))}}),gn=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},I_=gn(D_,[["__scopeId","data-v-04919347"]]);function As(e){let t=e.length;for(;t!=0;){let r=Math.floor(Math.random()*t);t--,[e[t],e[r]]=[e[r],e[t]]}}const ks=e=>e[Math.floor(Math.random()*e.length)],G_=()=>[["吃好吃滿",`組內每個人都要裝滿半碗，並在1分鐘吃完。

成功 +80分
失敗 -20分`,er(80,-20)],["喝好喝滿",`組內每個人都要裝滿兩杯飲料，並在30秒喝完。

成功 +50分
失敗 -20分`,er(50,-20)],["記憶力比拚",`記住隊內至少三個人的名字並說出。

成功 +80分
失敗 -20分`,er(80,-20)],["記憶力比拚",`播放歌曲，記住該段歌詞並唱出。

成功 +100分
失敗 -20分`,er(100,-20)],["四不像",`團體做出指定團體動作，在1分鐘內完成。

成功 +50分
失敗 -20分`,er(50,-20)],["有你真好",`找一位其他隊伍的人 (不可重複) 拍照，1分鐘內完成。

成功 +60分
失敗 -50分`,er(60,-50)],["聖誕你不知",`回答聖誕節冷知識

聖誕老人住哪裡? (國家)
<span class="hide">芬蘭 羅瓦涅米</span>

成功 +50分
失敗 -20分`,er(50,-20)],["聖誕你不知",`回答聖誕節冷知識

聖誕老人的馴鹿是公還是母?
<span class="hide">母的</span>

成功 +50分
失敗 -20分`,er(50,-20)],["擠眉弄眼",`隊內互相使用便條紙貼在對方臉上某個部位，只能使用臉部肌肉把便條紙拿下，1分鐘內完成。

成功 +80分
失敗 -40分`,er(80,-40)],["支援前線",`拿到主持人要求物品及數量，回到原位，1分鐘內完成。

成功 +60分
失敗 -20分`,er(60,-20)],["比手劃腳",`指定一位並背對所有人，其他人提示直到猜到題目，3分鐘內完成。

成功 +80分
失敗 -40分`,er(80,-40)],["誰的腳腳最靈活",`每位組員接力用腳夾裝有豆子的杯子依序傳遞，最後數量占1/4者成功。

成功 +80分
失敗 -20分`,er(80,-20)],["誰是花栗鼠",`每位組員跟著簡易節拍唸出繞口令，1分鐘內完成。

成功 +60分
失敗 -20分`,er(60,-20)],["Just dance",`玩家須在無音樂時跳出"APT"副歌舞蹈 或 freestyle 滿一分鐘即成功。

成功 +60分
失敗 -20分`,er(60,-20)],["歌王大道",`玩家須唱出一首歌滿一分鐘即成功。

成功 +50分
失敗 -20分`,er(50,-20)],["你畫我猜",`每位組員接力畫出題目，使猜題者猜，2分鐘內答對2題即成功。

成功 +50分
失敗 -20分`,er(50,-20)],["屁屁超人",`玩家想出一句話，並依序用屁股寫出各個字，其餘玩家猜出即成功。

成功 +60分
失敗 -20分`,er(60,-20)],["誰是老鼠屎",`玩家站成一排，利用頭或臉部把物品傳遞給下一個人，中途無掉落，2分鐘內完成即成功。

成功 +80分
失敗 -20分`,er(80,-20)],["有你真好",`找一位工作人員 (不可重複) 拍照，1分鐘內完成。

成功 +60分
失敗 -40分`,er(60,-40)]];function er(e,t){return(r,n)=>{let i=1;n?(r.doubleTaskScore&&(r.doubleTaskScore--,i+=1),r.score+=e*i):r.score+=t}}const M_=()=>ks(G_());var lr=(e=>(e[e.Empty=0]="Empty",e[e.Spawner=1]="Spawner",e[e.Task=2]="Task",e[e.Opportunity=3]="Opportunity",e[e.Destiny=4]="Destiny",e[e.Punishment=5]="Punishment",e[e.Teleport=6]="Teleport",e[e.Prison=7]="Prison",e[e.Hospital=8]="Hospital",e))(lr||{});class Pn{constructor(t,r){Oe(this,"width");Oe(this,"height");Oe(this,"tiles");Oe(this,"flatTiles");Oe(this,"teleports",[]);Oe(this,"spawners",[]);Oe(this,"prisons",[]);Oe(this,"hospitals",[]);Oe(this,"punishments",[]);this.spawnPointDirections=r,this.tiles=t,this.width=t[0].length,this.height=t.length,this.flatTiles=this.tiles.flat();for(const[n,i]of this.flatTiles.entries())switch(i){case 6:{this.teleports.push(this.indexFromFlat(n));break}case 1:{this.spawners.push(this.indexFromFlat(n));break}case 5:{this.punishments.push(this.indexFromFlat(n));break}case 7:{this.prisons.push(this.indexFromFlat(n));break}case 8:{this.hospitals.push(this.indexFromFlat(n));break}}}getTile(t,r){return this.flatTiles[r*this.width+t]}indexFromFlat(t){const r=t%this.width,n=Math.floor(t/this.width);return[r,n]}indexFromPosition(t){const[r,n]=t;return n*this.width+r}spawnPoints(){const t=this.spawners;if(this.spawnPointDirections.length!==t.length){console.group("Spawner count not match directions"),console.log(`Directions: ${t.length}`),console.log(`Spawn Points: ${this.spawnPointDirections.length}`),console.group("Spawners: ");for(const n of t){const i=Array.from(this.nextPosition(n).keys());console.log(`Spawner: ${n}, Accepts: ${i}`)}throw console.groupEnd(),console.groupEnd(),new Error("spawner count not match directions")}return this.spawnPointDirections.map((n,i)=>[t[i],n])}nextPosition(t,r){const n=new Map([[dt.UP,[0,-1]],[dt.RIGHT,[1,0]],[dt.DOWN,[0,1]],[dt.LEFT,[-1,0]]]),i={[dt.UP]:dt.DOWN,[dt.RIGHT]:dt.LEFT,[dt.DOWN]:dt.UP,[dt.LEFT]:dt.RIGHT}[r],a=new Map;for(const[f,o]of n.entries()){if(f===i)continue;const l=t[0]+o[0],y=t[1]+o[1];l<0||y<0||l>=this.width||y>=this.height||this.getTile(l,y)===0||a.set(f,o)}return a}static tileColor(t){return{0:"black",1:"green",2:"blue",3:"yellow",4:"orange",5:"red",6:"purple",7:"gray",8:"white"}[t]}static tileText(t){return{0:"空地",1:"出生點",2:"任務",3:"機會",4:"命運",5:"懲罰",6:"傳送門",7:"監獄",8:"醫院"}[t]}static tileImage(t){const r=Gn();if(t===0)return;const n="tile-"+{1:"spawner",2:"task",3:"opportunity",4:"destiny",5:"punishment",6:"teleport",7:"prison",8:"hospital"}[t];return r.getTexture(n)}static stringToTile(t){const r={空:0,出:1,任:2,機:3,命:4,懲:5,傳:6,監:7,醫:8}[t];if(r===void 0)throw new Error("Invalid tile");return r}}Oe(Pn,"TILE_SIZE",64);const Er=()=>B_,N_=`
出任機傳命出命任機傳出
命空空空懲空命空空空懲
機空空空傳空機空空空傳
機空空空傳空機空空空傳
傳監醫任命任傳監醫任懲
出空空空命空傳空空空出
命任機傳命機命任機傳命
命空空空懲空命空空空懲
機空空空傳空機空空空傳
命空空空懲空命空空空懲
出監醫任命出傳監醫任出
`.trim(),k_=[dt.RIGHT,dt.RIGHT,dt.DOWN,dt.UP,dt.DOWN,dt.UP,dt.LEFT,dt.LEFT],B_=new Pn(N_.split(`
`).map(e=>e.split("").map(Pn.stringToTile)),k_),U_=()=>[["暴風雪","全部人受到 1 點傷害。",e=>{const t=Et();for(const r of t.players.values())r.damage(1)}],["掉錢包","遺失 25% 分數。(最高 100, 最低 20)",e=>{const t=Math.min(100,Math.max(20,Math.floor(e.score*.25)));e.score-=t}],["刑事拘留","傳送並關入監獄。",async e=>{const r=Er().prisons;let n=1/0,i=r[0];for(const a of r){const f=e.position.x-a[0],o=e.position.y-a[1],l=f*f+o*o;l<n&&(n=l,i=a)}await e.teleport(i),await e.trigger(lr.Prison),await dr().wait(500)}],["大流感","全部玩家傳送至醫院，使所有人降低至3點血。",async e=>{const t=Et(),n=Er().hospitals,i=n[Math.floor(Math.random()*n.length)];for(const a of t.players.values())a.teleport(i),a.health=Math.min(3,a.health);await dr().wait(500)}],["海克斯科技","全部人互相傳送。",async e=>{const t=Et(),r=Array.from(t.players.values()),n=r.map(i=>[i.position.x,i.position.y]);As(n);for(const i in r){const a=r[i],f=n[i];a.teleport(f)}await dr().wait(500)}],["大聖人","向所有分享自己的金錢，但也分享給自己。",e=>{const t=Et(),r=t.players.size,n=Math.floor(e.score/r);for(const i of t.players.values())e.score-=n,i.score+=n}],["監獄超收","全部玩家傳送到監獄。",async e=>{const t=Et(),n=Er().prisons,i=n[Math.floor(Math.random()*n.length)];for(const a of t.players.values())a.teleport(i),a.trigger(lr.Prison);await dr().wait(500)}],["最後的晚餐","全部人承受不足致命的傷害。(除非剩下1滴血)",e=>{const t=Et();for(const r of t.players.values()){const n=Math.max(1,Math.floor(Math.random()*r.health));r.damage(n)}}],["雪球大戰","隨機攻擊玩家。",async e=>{const r=Et().withoutPlayer(e),n=r[Math.floor(Math.random()*r.length)];await e.attack(n,!0)}],["平安夜","全部人回復至滿血。",e=>{const t=Et();for(const r of t.players.values())r.health=Math.max(ii,r.health)}],["平安夜","全部人無敵一回合",e=>{const t=Et();for(const r of t.players.values())r.immune++}],["聖誕狂歡曲","全部人下次移動時獲得雙倍骰子。",e=>{const t=Et();for(const r of t.players.values())r.doubleDice++}],["北極探險","玩家前進到最近的懲罰格接受懲罰。",async e=>{const r=Er().punishments;let n=r[0],i=1/0;for(const a of r){const f=Math.abs(e.position.x-a[0])+Math.abs(e.position.y-a[1]);f<i&&(i=f,n=a)}await e.teleport(n),await e.trigger(lr.Punishment)}],["金錢危機","須支付30%分數給其餘玩家。",e=>{const t=Et(),r=Math.floor(e.score*.3);for(const n of t.players.values())n!==e&&(e.score-=r,n.score+=r)}],["扭轉命運","重抽一次命運事件。",e=>e.trigger(lr.Destiny)],["冰雹風暴","產生眩暈效果，暫停在原地一回合。",e=>{e.dizziness++}],["太空漫步","反轉方向。",e=>{e.reverseDirection()}],["這就是你的命","原地接受懲罰，捏鼻子模仿某個動物或角色的聲音一分鐘。",async e=>{}],["慢工出細活","下次移動時只能前進一格。",e=>{e.fixedDices.push(1)}],["木頭人","再次擲骰，但會被暈眩。",async e=>{const t=Et();t.steps=await e.throwDice("再次擲骰"),e.doubleDice=Math.max(0,e.doubleDice-1),e.dizziness++}]],$_=()=>ks(U_()),V_=()=>[["致命節奏","重骰，繼續前進。",async e=>{const t=Et();t.steps=await e.throwDice("繼續行動")}],["量子科技","與隨機一名玩家交換位置。",async e=>{const r=Et().withoutPlayer(e),n=r[Math.floor(Math.random()*r.length)],i=n.position.clone();n.teleportPosition(e.position),await e.teleportPosition(i)}],["背刺","移動至分數最高(不含自己)一位玩家並攻擊他。",async e=>{const r=Et().withoutPlayer(e),n=r.reduce((i,a)=>a.score>i.score?a:i,r[0]);await e.teleportPosition(n.position),await e.attack(n,!0)}],["共同富裕","與分數最高者，平分分數。(本身為最高時，與最低分者平分)",e=>{const r=Et().withoutPlayer(e),n=r.reduce((o,l)=>l.score>o.score?l:o,r[0]),i=r.reduce((o,l)=>l.score<o.score?l:o,r[0]),a=e.score>=n.score?i:n,f=e.score+a.score;e.score=Math.floor(f/2),a.score=f-e.score}],["聖誕交換禮物","選擇一位玩家，接受懲罰。",async e=>{const t=Et();(await dr().players.input("���擇一位玩家",t.withoutPlayer(e))).trigger(lr.Punishment)}],["聖誕交換禮物","選擇一位玩家，交換分數。",async e=>{const t=Et(),r=await dr().players.input("選擇一位玩家",t.withoutPlayer(e)),n=e.score;e.score=r.score,r.score=n}],["聖誕禮物","獲得 30 分、回復一點生命值。",e=>{e.score+=30,e.health+=1}],["聖誕禮物","扣至1點生命值、獲得 60% 分數 (最高 300 分，最低 100 分)。",e=>{e.health=1;let t=Math.floor(e.score*.6);t=Math.max(100,Math.min(t,300)),e.score+=t}],["聖誕夜","除你以外所有人暈眩一回合。",e=>{Et().withoutPlayer(e).forEach(n=>n.dizziness++)}],["重生而降","直接獲得 50 分。",e=>{e.score+=50}],["回家嚕","回到最近的起點。",async e=>{const r=Er().spawners;let n=r[0],i=1/0;for(const a of r){const f=Math.abs(e.position.x-a[0])+Math.abs(e.position.y-a[1]);f<i&&(i=f,n=a)}await e.teleport(n),await e.trigger()}],["我直直撞","前進6步。",async e=>{const t=Et();t.steps=6}],["滿血復活","回復至最大生命值。",e=>{e.health=ii}],["就想看你秀","抽到下一個任務時可指定其餘玩家完成。",e=>{}],["打不到我勒","免疫下一次攻擊。",e=>{e.immune++}],["Double星","下次移動時獲得雙倍骰子。",e=>{e.doubleDice++}],["Double星","下次任務獲得雙倍分數。",e=>{e.doubleTaskScore++}],["我要打鼠你","下一次攻擊時，扣兩倍血量。",e=>{e.doubleDamage++}]],j_=()=>ks(V_()),H_=()=>[["我是青蛙","蹲下學青蛙跳，並發出呱呱呱的聲音。",e=>{}],["我是企鵝","模仿企鵝走路繞一圈。",e=>{}],["我是大猩猩","模仿大猩猩雙手捶胸跑一圈。",e=>{}],["我是雞王","模仿公雞雙手擺動繞一圈，並發出咕咕咕的聲音。",e=>{}],["臭腳ㄚ攻擊","聞自己的襪子30秒，並說真香。",e=>{}],["我最好看","絲襪套頭5秒。",e=>{}],["人體噴水秀","含水唱出兩隻老虎。",e=>{}],["人體彩繪","請下一組玩家在你的臉上畫畫。",e=>{}],["斗六火車讚","上傳自拍照到限時動態，@營建系學會並打上一句話。",e=>{}],["老香了","聞自己的胳肢窩，並說真香。",e=>{}],["要活就要動","棒式1分鐘。",e=>{}],["誰能比我騷","M字腿五次。",e=>{}],["乾淨乖寶寶","背對大家，一邊扭屁股擺動作一邊唱洗刷刷*n遍。",e=>{}]],z_=()=>ks(H_()),Md=()=>W_,W_=fi(new class{constructor(){Oe(this,"inner",new Map);Oe(this,"counter",0)}effect(t,r=1e3){const n=this.counter++;this.inner.set(n,t),setTimeout(()=>this.inner.delete(n),r)}sound(t){const n=Gn().getSound(t);if(!n)throw new Error("Sound not found");return n.currentTime=0,n.play(),n}check(t,r){return t===r.name}});var X_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Y_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Nd={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(X_,function(){var r=function(s){return s instanceof Uint8Array||s instanceof Uint16Array||s instanceof Uint32Array||s instanceof Int8Array||s instanceof Int16Array||s instanceof Int32Array||s instanceof Float32Array||s instanceof Float64Array||s instanceof Uint8ClampedArray},n=function(s,d){for(var _=Object.keys(d),G=0;G<_.length;++G)s[_[G]]=d[_[G]];return s},i=`
`;function a(s){return typeof atob<"u"?atob(s):"base64:"+s}function f(s){var d=new Error("(regl) "+s);throw console.error(d),d}function o(s,d){s||f(d)}function l(s){return s?": "+s:""}function y(s,d,_){s in d||f("unknown parameter ("+s+")"+l(_)+". possible values: "+Object.keys(d).join())}function g(s,d){r(s)||f("invalid parameter type"+l(d)+". must be a typed array")}function P(s,d){switch(d){case"number":return typeof s=="number";case"object":return typeof s=="object";case"string":return typeof s=="string";case"boolean":return typeof s=="boolean";case"function":return typeof s=="function";case"undefined":return typeof s>"u";case"symbol":return typeof s=="symbol"}}function U(s,d,_){P(s,d)||f("invalid parameter type"+l(_)+". expected "+d+", got "+typeof s)}function re(s,d){s>=0&&(s|0)===s||f("invalid parameter type, ("+s+")"+l(d)+". must be a nonnegative integer")}function ue(s,d,_){d.indexOf(s)<0&&f("invalid value"+l(_)+". must be one of: "+d)}var Ie=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Qe(s){Object.keys(s).forEach(function(d){Ie.indexOf(d)<0&&f('invalid regl constructor argument "'+d+'". must be one of '+Ie)})}function Ge(s,d){for(s=s+"";s.length<d;)s=" "+s;return s}function Ze(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function $e(s,d){this.number=s,this.line=d,this.errors=[]}function be(s,d,_){this.file=s,this.line=d,this.message=_}function ke(){var s=new Error,d=(s.stack||s).toString(),_=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(d);if(_)return _[1];var G=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(d);return G?G[1]:"unknown"}function We(){var s=new Error,d=(s.stack||s).toString(),_=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(d);if(_)return _[1];var G=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(d);return G?G[1]:"unknown"}function St(s,d){var _=s.split(`
`),G=1,$=0,I={unknown:new Ze,0:new Ze};I.unknown.name=I[0].name=d||ke(),I.unknown.lines.push(new $e(0,""));for(var k=0;k<_.length;++k){var X=_[k],W=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(X);if(W)switch(W[1]){case"line":var Z=/(\d+)(\s+\d+)?/.exec(W[2]);Z&&(G=Z[1]|0,Z[2]&&($=Z[2]|0,$ in I||(I[$]=new Ze)));break;case"define":var ee=/SHADER_NAME(_B64)?\s+(.*)$/.exec(W[2]);ee&&(I[$].name=ee[1]?a(ee[2]):ee[2]);break}I[$].lines.push(new $e(G++,X))}return Object.keys(I).forEach(function(J){var oe=I[J];oe.lines.forEach(function(Y){oe.index[Y.number]=Y})}),I}function Ft(s){var d=[];return s.split(`
`).forEach(function(_){if(!(_.length<5)){var G=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(_);G?d.push(new be(G[1]|0,G[2]|0,G[3].trim())):_.length>0&&d.push(new be("unknown",0,_))}}),d}function He(s,d){d.forEach(function(_){var G=s[_.file];if(G){var $=G.index[_.line];if($){$.errors.push(_),G.hasErrors=!0;return}}s.unknown.hasErrors=!0,s.unknown.lines[0].errors.push(_)})}function et(s,d,_,G,$){if(!s.getShaderParameter(d,s.COMPILE_STATUS)){var I=s.getShaderInfoLog(d),k=G===s.FRAGMENT_SHADER?"fragment":"vertex";Pt(_,"string",k+" shader source must be a string",$);var X=St(_,$),W=Ft(I);He(X,W),Object.keys(X).forEach(function(Z){var ee=X[Z];if(!ee.hasErrors)return;var J=[""],oe=[""];function Y(Q,C){J.push(Q),oe.push(C||"")}Y("file number "+Z+": "+ee.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ee.lines.forEach(function(Q){if(Q.errors.length>0){Y(Ge(Q.number,4)+"|  ","background-color:yellow; font-weight:bold"),Y(Q.line+i,"color:red; background-color:yellow; font-weight:bold");var C=0;Q.errors.forEach(function(N){var q=N.message,ye=/^\s*'(.*)'\s*:\s*(.*)$/.exec(q);if(ye){var z=ye[1];switch(q=ye[2],z){case"assign":z="=";break}C=Math.max(Q.line.indexOf(z,C),0)}else C=0;Y(Ge("| ",6)),Y(Ge("^^^",C+3)+i,"font-weight:bold"),Y(Ge("| ",6)),Y(q+i,"font-weight:bold")}),Y(Ge("| ",6)+i)}else Y(Ge(Q.number,4)+"|  "),Y(Q.line+i,"color:red")}),typeof document<"u"&&!window.chrome?(oe[0]=J.join("%c"),console.log.apply(console,oe)):console.log(J.join(""))}),o.raise("Error compiling "+k+" shader, "+X[0].name)}}function mt(s,d,_,G,$){if(!s.getProgramParameter(d,s.LINK_STATUS)){var I=s.getProgramInfoLog(d),k=St(_,$),X=St(G,$),W='Error linking program with vertex shader, "'+X[0].name+'", and fragment shader "'+k[0].name+'"';typeof document<"u"?console.log("%c"+W+i+"%c"+I,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(W+i+I),o.raise(W)}}function Fe(s){s._commandRef=ke()}function _t(s,d,_,G){Fe(s);function $(W){return W?G.id(W):0}s._fragId=$(s.static.frag),s._vertId=$(s.static.vert);function I(W,Z){Object.keys(Z).forEach(function(ee){W[G.id(ee)]=!0})}var k=s._uniformSet={};I(k,d.static),I(k,d.dynamic);var X=s._attributeSet={};I(X,_.static),I(X,_.dynamic),s._hasCount="count"in s.static||"count"in s.dynamic||"elements"in s.static||"elements"in s.dynamic}function ft(s,d){var _=We();f(s+" in command "+(d||ke())+(_==="unknown"?"":" called from "+_))}function Nr(s,d,_){s||ft(d,_||ke())}function Yt(s,d,_,G){s in d||ft("unknown parameter ("+s+")"+l(_)+". possible values: "+Object.keys(d).join(),G||ke())}function Pt(s,d,_,G){P(s,d)||ft("invalid parameter type"+l(_)+". expected "+d+", got "+typeof s,G||ke())}function Ct(s){s()}function nn(s,d,_){s.texture?ue(s.texture._texture.internalformat,d,"unsupported texture format for attachment"):ue(s.renderbuffer._renderbuffer.format,_,"unsupported renderbuffer format for attachment")}var an=33071,Hr=9728,Pr=9984,wa=9985,Us=9986,$s=9987,kn=5120,li=5121,Ni=5122,Sa=5123,Bn=5124,Ca=5125,ki=5126,A=32819,R=32820,H=33635,le=34042,ie=36193,te={};te[kn]=te[li]=1,te[Ni]=te[Sa]=te[ie]=te[H]=te[A]=te[R]=2,te[Bn]=te[Ca]=te[ki]=te[le]=4;function Pe(s,d){return s===R||s===A||s===H?2:s===le?4:te[s]*d}function Te(s){return!(s&s-1)&&!!s}function Se(s,d,_){var G,$=d.width,I=d.height,k=d.channels;o($>0&&$<=_.maxTextureSize&&I>0&&I<=_.maxTextureSize,"invalid texture shape"),(s.wrapS!==an||s.wrapT!==an)&&o(Te($)&&Te(I),"incompatible wrap mode for texture, both width and height must be power of 2"),d.mipmask===1?$!==1&&I!==1&&o(s.minFilter!==Pr&&s.minFilter!==Us&&s.minFilter!==wa&&s.minFilter!==$s,"min filter requires mipmap"):(o(Te($)&&Te(I),"texture must be a square power of 2 to support mipmapping"),o(d.mipmask===($<<1)-1,"missing or incomplete mipmap data")),d.type===ki&&(_.extensions.indexOf("oes_texture_float_linear")<0&&o(s.minFilter===Hr&&s.magFilter===Hr,"filter not supported, must enable oes_texture_float_linear"),o(!s.genMipmaps,"mipmap generation not supported with float textures"));var X=d.images;for(G=0;G<16;++G)if(X[G]){var W=$>>G,Z=I>>G;o(d.mipmask&1<<G,"missing mipmap data");var ee=X[G];if(o(ee.width===W&&ee.height===Z,"invalid shape for mip images"),o(ee.format===d.format&&ee.internalformat===d.internalformat&&ee.type===d.type,"incompatible type for mip image"),!ee.compressed)if(ee.data){var J=Math.ceil(Pe(ee.type,k)*W/ee.unpackAlignment)*ee.unpackAlignment;o(ee.data.byteLength===J*Z,"invalid data for image, buffer size is inconsistent with image format")}else ee.element||ee.copy}else s.genMipmaps||o((d.mipmask&1<<G)===0,"extra mipmap data");d.compressed&&o(!s.genMipmaps,"mipmap generation for compressed images not supported")}function de(s,d,_,G){var $=s.width,I=s.height,k=s.channels;o($>0&&$<=G.maxTextureSize&&I>0&&I<=G.maxTextureSize,"invalid texture shape"),o($===I,"cube map must be square"),o(d.wrapS===an&&d.wrapT===an,"wrap mode not supported by cube map");for(var X=0;X<_.length;++X){var W=_[X];o(W.width===$&&W.height===I,"inconsistent cube map face shape"),d.genMipmaps&&(o(!W.compressed,"can not generate mipmap for compressed textures"),o(W.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Z=W.images,ee=0;ee<16;++ee){var J=Z[ee];if(J){var oe=$>>ee,Y=I>>ee;o(W.mipmask&1<<ee,"missing mipmap data"),o(J.width===oe&&J.height===Y,"invalid shape for mip images"),o(J.format===s.format&&J.internalformat===s.internalformat&&J.type===s.type,"incompatible type for mip image"),J.compressed||(J.data?o(J.data.byteLength===oe*Y*Math.max(Pe(J.type,k),J.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):J.element||J.copy)}}}}var c=n(o,{optional:Ct,raise:f,commandRaise:ft,command:Nr,parameter:y,commandParameter:Yt,constructor:Qe,type:U,commandType:Pt,isTypedArray:g,nni:re,oneOf:ue,shaderError:et,linkError:mt,callSite:We,saveCommandRef:Fe,saveDrawInfo:_t,framebufferFormat:nn,guessCommand:ke,texture2D:Se,textureCube:de}),Me=0,Xe=0,rt=5,ht=6;function gt(s,d){this.id=Me++,this.type=s,this.data=d}function yt(s){return s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function qt(s){if(s.length===0)return[];var d=s.charAt(0),_=s.charAt(s.length-1);if(s.length>1&&d===_&&(d==='"'||d==="'"))return['"'+yt(s.substr(1,s.length-2))+'"'];var G=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(s);if(G)return qt(s.substr(0,G.index)).concat(qt(G[1])).concat(qt(s.substr(G.index+G[0].length)));var $=s.split(".");if($.length===1)return['"'+yt(s)+'"'];for(var I=[],k=0;k<$.length;++k)I=I.concat(qt($[k]));return I}function Qt(s){return"["+qt(s).join("][")+"]"}function Tr(s,d){return new gt(s,Qt(d+""))}function mr(s){return typeof s=="function"&&!s._reglType||s instanceof gt}function yn(s,d){if(typeof s=="function")return new gt(Xe,s);if(typeof s=="number"||typeof s=="boolean")return new gt(rt,s);if(Array.isArray(s))return new gt(ht,s.map(function(_,G){return yn(_,d+"["+G+"]")}));if(s instanceof gt)return s;c(!1,"invalid option type in uniform "+d)}var sr={DynamicVariable:gt,define:Tr,isDynamic:mr,unbox:yn,accessor:Qt},ir={next:typeof requestAnimationFrame=="function"?function(s){return requestAnimationFrame(s)}:function(s){return setTimeout(s,16)},cancel:typeof cancelAnimationFrame=="function"?function(s){return cancelAnimationFrame(s)}:clearTimeout},Ar=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function La(){var s={"":0},d=[""];return{id:function(_){var G=s[_];return G||(G=s[_]=d.length,d.push(_),G)},str:function(_){return d[_]}}}function zd(s,d,_){var G=document.createElement("canvas");n(G.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),s.appendChild(G),s===document.body&&(G.style.position="absolute",n(s.style,{margin:0,padding:0}));function $(){var X=window.innerWidth,W=window.innerHeight;if(s!==document.body){var Z=G.getBoundingClientRect();X=Z.right-Z.left,W=Z.bottom-Z.top}G.width=_*X,G.height=_*W}var I;s!==document.body&&typeof ResizeObserver=="function"?(I=new ResizeObserver(function(){setTimeout($)}),I.observe(s)):window.addEventListener("resize",$,!1);function k(){I?I.disconnect():window.removeEventListener("resize",$),s.removeChild(G)}return $(),{canvas:G,onDestroy:k}}function Wd(s,d){function _(G){try{return s.getContext(G,d)}catch{return null}}return _("webgl")||_("experimental-webgl")||_("webgl-experimental")}function Xd(s){return typeof s.nodeName=="string"&&typeof s.appendChild=="function"&&typeof s.getBoundingClientRect=="function"}function Yd(s){return typeof s.drawArrays=="function"||typeof s.drawElements=="function"}function If(s){return typeof s=="string"?s.split():(c(Array.isArray(s),"invalid extension array"),s)}function Gf(s){return typeof s=="string"?(c(typeof document<"u","not supported outside of DOM"),document.querySelector(s)):s}function Kd(s){var d=s||{},_,G,$,I,k={},X=[],W=[],Z=typeof window>"u"?1:window.devicePixelRatio,ee=!1,J=function(Q){Q&&c.raise(Q)},oe=function(){};if(typeof d=="string"?(c(typeof document<"u","selector queries only supported in DOM environments"),_=document.querySelector(d),c(_,"invalid query string for element")):typeof d=="object"?Xd(d)?_=d:Yd(d)?(I=d,$=I.canvas):(c.constructor(d),"gl"in d?I=d.gl:"canvas"in d?$=Gf(d.canvas):"container"in d&&(G=Gf(d.container)),"attributes"in d&&(k=d.attributes,c.type(k,"object","invalid context attributes")),"extensions"in d&&(X=If(d.extensions)),"optionalExtensions"in d&&(W=If(d.optionalExtensions)),"onDone"in d&&(c.type(d.onDone,"function","invalid or missing onDone callback"),J=d.onDone),"profile"in d&&(ee=!!d.profile),"pixelRatio"in d&&(Z=+d.pixelRatio,c(Z>0,"invalid pixel ratio"))):c.raise("invalid arguments to regl"),_&&(_.nodeName.toLowerCase()==="canvas"?$=_:G=_),!I){if(!$){c(typeof document<"u","must manually specify webgl context outside of DOM environments");var Y=zd(G||document.body,J,Z);if(!Y)return null;$=Y.canvas,oe=Y.onDestroy}k.premultipliedAlpha===void 0&&(k.premultipliedAlpha=!0),I=Wd($,k)}return I?{gl:I,canvas:$,container:G,extensions:X,optionalExtensions:W,pixelRatio:Z,profile:ee,onDone:J,onDestroy:oe}:(oe(),J("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function qd(s,d){var _={};function G(k){c.type(k,"string","extension name must be string");var X=k.toLowerCase(),W;try{W=_[X]=s.getExtension(X)}catch{}return!!W}for(var $=0;$<d.extensions.length;++$){var I=d.extensions[$];if(!G(I))return d.onDestroy(),d.onDone('"'+I+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return d.optionalExtensions.forEach(G),{extensions:_,restore:function(){Object.keys(_).forEach(function(k){if(_[k]&&!G(k))throw new Error("(regl): error restoring extension "+k)})}}}function wr(s,d){for(var _=Array(s),G=0;G<s;++G)_[G]=d(G);return _}var Qd=5120,Zd=5121,Jd=5122,eh=5123,th=5124,rh=5125,nh=5126;function ih(s){for(var d=16;d<=1<<28;d*=16)if(s<=d)return d;return 0}function Mf(s){var d,_;return d=(s>65535)<<4,s>>>=d,_=(s>255)<<3,s>>>=_,d|=_,_=(s>15)<<2,s>>>=_,d|=_,_=(s>3)<<1,s>>>=_,d|=_,d|s>>1}function Nf(){var s=wr(8,function(){return[]});function d(I){var k=ih(I),X=s[Mf(k)>>2];return X.length>0?X.pop():new ArrayBuffer(k)}function _(I){s[Mf(I.byteLength)>>2].push(I)}function G(I,k){var X=null;switch(I){case Qd:X=new Int8Array(d(k),0,k);break;case Zd:X=new Uint8Array(d(k),0,k);break;case Jd:X=new Int16Array(d(2*k),0,k);break;case eh:X=new Uint16Array(d(2*k),0,k);break;case th:X=new Int32Array(d(4*k),0,k);break;case rh:X=new Uint32Array(d(4*k),0,k);break;case nh:X=new Float32Array(d(4*k),0,k);break;default:return null}return X.length!==k?X.subarray(0,k):X}function $(I){_(I.buffer)}return{alloc:d,free:_,allocType:G,freeType:$}}var Bt=Nf();Bt.zero=Nf();var ah=3408,sh=3410,oh=3411,fh=3412,lh=3413,ch=3414,uh=3415,dh=33901,hh=33902,ph=3379,mh=3386,vh=34921,_h=36347,gh=36348,yh=35661,bh=35660,xh=34930,Eh=36349,Th=34076,Ah=34024,wh=7936,Sh=7937,Ch=7938,Lh=35724,Rh=34047,Oh=36063,Fh=34852,Ra=3553,kf=34067,Ph=34069,Dh=33984,Bi=6408,Vs=5126,Bf=5121,js=36160,Ih=36053,Gh=36064,Mh=16384,Nh=function(s,d){var _=1;d.ext_texture_filter_anisotropic&&(_=s.getParameter(Rh));var G=1,$=1;d.webgl_draw_buffers&&(G=s.getParameter(Fh),$=s.getParameter(Oh));var I=!!d.oes_texture_float;if(I){var k=s.createTexture();s.bindTexture(Ra,k),s.texImage2D(Ra,0,Bi,1,1,0,Bi,Vs,null);var X=s.createFramebuffer();if(s.bindFramebuffer(js,X),s.framebufferTexture2D(js,Gh,Ra,k,0),s.bindTexture(Ra,null),s.checkFramebufferStatus(js)!==Ih)I=!1;else{s.viewport(0,0,1,1),s.clearColor(1,0,0,1),s.clear(Mh);var W=Bt.allocType(Vs,4);s.readPixels(0,0,1,1,Bi,Vs,W),s.getError()?I=!1:(s.deleteFramebuffer(X),s.deleteTexture(k),I=W[0]===1),Bt.freeType(W)}}var Z=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ee=!0;if(!Z){var J=s.createTexture(),oe=Bt.allocType(Bf,36);s.activeTexture(Dh),s.bindTexture(kf,J),s.texImage2D(Ph,0,Bi,3,3,0,Bi,Bf,oe),Bt.freeType(oe),s.bindTexture(kf,null),s.deleteTexture(J),ee=!s.getError()}return{colorBits:[s.getParameter(sh),s.getParameter(oh),s.getParameter(fh),s.getParameter(lh)],depthBits:s.getParameter(ch),stencilBits:s.getParameter(uh),subpixelBits:s.getParameter(ah),extensions:Object.keys(d).filter(function(Y){return!!d[Y]}),maxAnisotropic:_,maxDrawbuffers:G,maxColorAttachments:$,pointSizeDims:s.getParameter(dh),lineWidthDims:s.getParameter(hh),maxViewportDims:s.getParameter(mh),maxCombinedTextureUnits:s.getParameter(yh),maxCubeMapSize:s.getParameter(Th),maxRenderbufferSize:s.getParameter(Ah),maxTextureUnits:s.getParameter(xh),maxTextureSize:s.getParameter(ph),maxAttributes:s.getParameter(vh),maxVertexUniforms:s.getParameter(_h),maxVertexTextureUnits:s.getParameter(bh),maxVaryingVectors:s.getParameter(gh),maxFragmentUniforms:s.getParameter(Eh),glsl:s.getParameter(Lh),renderer:s.getParameter(Sh),vendor:s.getParameter(wh),version:s.getParameter(Ch),readFloat:I,npotTextureCube:ee}};function kr(s){return!!s&&typeof s=="object"&&Array.isArray(s.shape)&&Array.isArray(s.stride)&&typeof s.offset=="number"&&s.shape.length===s.stride.length&&(Array.isArray(s.data)||r(s.data))}var Sr=function(s){return Object.keys(s).map(function(d){return s[d]})},Oa={shape:$h,flatten:Uh};function kh(s,d,_){for(var G=0;G<d;++G)_[G]=s[G]}function Bh(s,d,_,G){for(var $=0,I=0;I<d;++I)for(var k=s[I],X=0;X<_;++X)G[$++]=k[X]}function Uf(s,d,_,G,$,I){for(var k=I,X=0;X<d;++X)for(var W=s[X],Z=0;Z<_;++Z)for(var ee=W[Z],J=0;J<G;++J)$[k++]=ee[J]}function $f(s,d,_,G,$){for(var I=1,k=_+1;k<d.length;++k)I*=d[k];var X=d[_];if(d.length-_===4){var W=d[_+1],Z=d[_+2],ee=d[_+3];for(k=0;k<X;++k)Uf(s[k],W,Z,ee,G,$),$+=I}else for(k=0;k<X;++k)$f(s[k],d,_+1,G,$),$+=I}function Uh(s,d,_,G){var $=1;if(d.length)for(var I=0;I<d.length;++I)$*=d[I];else $=0;var k=G||Bt.allocType(_,$);switch(d.length){case 0:break;case 1:kh(s,d[0],k);break;case 2:Bh(s,d[0],d[1],k);break;case 3:Uf(s,d[0],d[1],d[2],k,0);break;default:$f(s,d,0,k,0)}return k}function $h(s){for(var d=[],_=s;_.length;_=_[0])d.push(_.length);return d}var Hs={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Vh=5120,jh=5122,Hh=5124,zh=5121,Wh=5123,Xh=5125,Yh=5126,Kh=5126,Un={int8:Vh,int16:jh,int32:Hh,uint8:zh,uint16:Wh,uint32:Xh,float:Yh,float32:Kh},qh=35048,Qh=35040,Fa={dynamic:qh,stream:Qh,static:35044},zs=Oa.flatten,Vf=Oa.shape,jf=35044,Zh=35040,Ws=5121,Xs=5126,bn=[];bn[5120]=1,bn[5122]=2,bn[5124]=4,bn[5121]=1,bn[5123]=2,bn[5125]=4,bn[5126]=4;function Pa(s){return Hs[Object.prototype.toString.call(s)]|0}function Hf(s,d){for(var _=0;_<d.length;++_)s[_]=d[_]}function zf(s,d,_,G,$,I,k){for(var X=0,W=0;W<_;++W)for(var Z=0;Z<G;++Z)s[X++]=d[$*W+I*Z+k]}function Jh(s,d,_,G){var $=0,I={};function k(C){this.id=$++,this.buffer=s.createBuffer(),this.type=C,this.usage=jf,this.byteLength=0,this.dimension=1,this.dtype=Ws,this.persistentData=null,_.profile&&(this.stats={size:0})}k.prototype.bind=function(){s.bindBuffer(this.type,this.buffer)},k.prototype.destroy=function(){oe(this)};var X=[];function W(C,N){var q=X.pop();return q||(q=new k(C)),q.bind(),J(q,N,Zh,0,1,!1),q}function Z(C){X.push(C)}function ee(C,N,q){C.byteLength=N.byteLength,s.bufferData(C.type,N,q)}function J(C,N,q,ye,z,_e){var pe;if(C.usage=q,Array.isArray(N)){if(C.dtype=ye||Xs,N.length>0){var Be;if(Array.isArray(N[0])){pe=Vf(N);for(var V=1,B=1;B<pe.length;++B)V*=pe[B];C.dimension=V,Be=zs(N,pe,C.dtype),ee(C,Be,q),_e?C.persistentData=Be:Bt.freeType(Be)}else if(typeof N[0]=="number"){C.dimension=z;var Ae=Bt.allocType(C.dtype,N.length);Hf(Ae,N),ee(C,Ae,q),_e?C.persistentData=Ae:Bt.freeType(Ae)}else r(N[0])?(C.dimension=N[0].length,C.dtype=ye||Pa(N[0])||Xs,Be=zs(N,[N.length,N[0].length],C.dtype),ee(C,Be,q),_e?C.persistentData=Be:Bt.freeType(Be)):c.raise("invalid buffer data")}}else if(r(N))C.dtype=ye||Pa(N),C.dimension=z,ee(C,N,q),_e&&(C.persistentData=new Uint8Array(new Uint8Array(N.buffer)));else if(kr(N)){pe=N.shape;var fe=N.stride,K=N.offset,ce=0,he=0,Ke=0,ze=0;pe.length===1?(ce=pe[0],he=1,Ke=fe[0],ze=0):pe.length===2?(ce=pe[0],he=pe[1],Ke=fe[0],ze=fe[1]):c.raise("invalid shape"),C.dtype=ye||Pa(N.data)||Xs,C.dimension=he;var me=Bt.allocType(C.dtype,ce*he);zf(me,N.data,ce,he,Ke,ze,K),ee(C,me,q),_e?C.persistentData=me:Bt.freeType(me)}else N instanceof ArrayBuffer?(C.dtype=Ws,C.dimension=z,ee(C,N,q),_e&&(C.persistentData=new Uint8Array(new Uint8Array(N)))):c.raise("invalid buffer data")}function oe(C){d.bufferCount--,G(C);var N=C.buffer;c(N,"buffer must not be deleted already"),s.deleteBuffer(N),C.buffer=null,delete I[C.id]}function Y(C,N,q,ye){d.bufferCount++;var z=new k(N);I[z.id]=z;function _e(V){var B=jf,Ae=null,fe=0,K=0,ce=1;return Array.isArray(V)||r(V)||kr(V)||V instanceof ArrayBuffer?Ae=V:typeof V=="number"?fe=V|0:V&&(c.type(V,"object","buffer arguments must be an object, a number or an array"),"data"in V&&(c(Ae===null||Array.isArray(Ae)||r(Ae)||kr(Ae),"invalid data for buffer"),Ae=V.data),"usage"in V&&(c.parameter(V.usage,Fa,"invalid buffer usage"),B=Fa[V.usage]),"type"in V&&(c.parameter(V.type,Un,"invalid buffer type"),K=Un[V.type]),"dimension"in V&&(c.type(V.dimension,"number","invalid dimension"),ce=V.dimension|0),"length"in V&&(c.nni(fe,"buffer length must be a nonnegative integer"),fe=V.length|0)),z.bind(),Ae?J(z,Ae,B,K,ce,ye):(fe&&s.bufferData(z.type,fe,B),z.dtype=K||Ws,z.usage=B,z.dimension=ce,z.byteLength=fe),_.profile&&(z.stats.size=z.byteLength*bn[z.dtype]),_e}function pe(V,B){c(B+V.byteLength<=z.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+V.byteLength+" starting from offset "+B+" to a buffer of size "+z.byteLength),s.bufferSubData(z.type,B,V)}function Be(V,B){var Ae=(B||0)|0,fe;if(z.bind(),r(V)||V instanceof ArrayBuffer)pe(V,Ae);else if(Array.isArray(V)){if(V.length>0)if(typeof V[0]=="number"){var K=Bt.allocType(z.dtype,V.length);Hf(K,V),pe(K,Ae),Bt.freeType(K)}else if(Array.isArray(V[0])||r(V[0])){fe=Vf(V);var ce=zs(V,fe,z.dtype);pe(ce,Ae),Bt.freeType(ce)}else c.raise("invalid buffer data")}else if(kr(V)){fe=V.shape;var he=V.stride,Ke=0,ze=0,me=0,ge=0;fe.length===1?(Ke=fe[0],ze=1,me=he[0],ge=0):fe.length===2?(Ke=fe[0],ze=fe[1],me=he[0],ge=he[1]):c.raise("invalid shape");var Ve=Array.isArray(V.data)?z.dtype:Pa(V.data),Ye=Bt.allocType(Ve,Ke*ze);zf(Ye,V.data,Ke,ze,me,ge,V.offset),pe(Ye,Ae),Bt.freeType(Ye)}else c.raise("invalid data for buffer subdata");return _e}return q||_e(C),_e._reglType="buffer",_e._buffer=z,_e.subdata=Be,_.profile&&(_e.stats=z.stats),_e.destroy=function(){oe(z)},_e}function Q(){Sr(I).forEach(function(C){C.buffer=s.createBuffer(),s.bindBuffer(C.type,C.buffer),s.bufferData(C.type,C.persistentData||C.byteLength,C.usage)})}return _.profile&&(d.getTotalBufferSize=function(){var C=0;return Object.keys(I).forEach(function(N){C+=I[N].stats.size}),C}),{create:Y,createStream:W,destroyStream:Z,clear:function(){Sr(I).forEach(oe),X.forEach(oe)},getBuffer:function(C){return C&&C._buffer instanceof k?C._buffer:null},restore:Q,_initBuffer:J}}var ep=0,tp=0,rp=1,np=1,ip=4,ap=4,xn={points:ep,point:tp,lines:rp,line:np,triangles:ip,triangle:ap,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},sp=0,op=1,Ui=4,fp=5120,ci=5121,Wf=5122,ui=5123,Xf=5124,$n=5125,Ys=34963,lp=35040,cp=35044;function up(s,d,_,G){var $={},I=0,k={uint8:ci,uint16:ui};d.oes_element_index_uint&&(k.uint32=$n);function X(Q){this.id=I++,$[this.id]=this,this.buffer=Q,this.primType=Ui,this.vertCount=0,this.type=0}X.prototype.bind=function(){this.buffer.bind()};var W=[];function Z(Q){var C=W.pop();return C||(C=new X(_.create(null,Ys,!0,!1)._buffer)),J(C,Q,lp,-1,-1,0,0),C}function ee(Q){W.push(Q)}function J(Q,C,N,q,ye,z,_e){Q.buffer.bind();var pe;if(C){var Be=_e;!_e&&(!r(C)||kr(C)&&!r(C.data))&&(Be=d.oes_element_index_uint?$n:ui),_._initBuffer(Q.buffer,C,N,Be,3)}else s.bufferData(Ys,z,N),Q.buffer.dtype=pe||ci,Q.buffer.usage=N,Q.buffer.dimension=3,Q.buffer.byteLength=z;if(pe=_e,!_e){switch(Q.buffer.dtype){case ci:case fp:pe=ci;break;case ui:case Wf:pe=ui;break;case $n:case Xf:pe=$n;break;default:c.raise("unsupported type for element array")}Q.buffer.dtype=pe}Q.type=pe,c(pe!==$n||!!d.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var V=ye;V<0&&(V=Q.buffer.byteLength,pe===ui?V>>=1:pe===$n&&(V>>=2)),Q.vertCount=V;var B=q;if(q<0){B=Ui;var Ae=Q.buffer.dimension;Ae===1&&(B=sp),Ae===2&&(B=op),Ae===3&&(B=Ui)}Q.primType=B}function oe(Q){G.elementsCount--,c(Q.buffer!==null,"must not double destroy elements"),delete $[Q.id],Q.buffer.destroy(),Q.buffer=null}function Y(Q,C){var N=_.create(null,Ys,!0),q=new X(N._buffer);G.elementsCount++;function ye(z){if(!z)N(),q.primType=Ui,q.vertCount=0,q.type=ci;else if(typeof z=="number")N(z),q.primType=Ui,q.vertCount=z|0,q.type=ci;else{var _e=null,pe=cp,Be=-1,V=-1,B=0,Ae=0;Array.isArray(z)||r(z)||kr(z)?_e=z:(c.type(z,"object","invalid arguments for elements"),"data"in z&&(_e=z.data,c(Array.isArray(_e)||r(_e)||kr(_e),"invalid data for element buffer")),"usage"in z&&(c.parameter(z.usage,Fa,"invalid element buffer usage"),pe=Fa[z.usage]),"primitive"in z&&(c.parameter(z.primitive,xn,"invalid element buffer primitive"),Be=xn[z.primitive]),"count"in z&&(c(typeof z.count=="number"&&z.count>=0,"invalid vertex count for elements"),V=z.count|0),"type"in z&&(c.parameter(z.type,k,"invalid buffer type"),Ae=k[z.type]),"length"in z?B=z.length|0:(B=V,Ae===ui||Ae===Wf?B*=2:(Ae===$n||Ae===Xf)&&(B*=4))),J(q,_e,pe,Be,V,B,Ae)}return ye}return ye(Q),ye._reglType="elements",ye._elements=q,ye.subdata=function(z,_e){return N.subdata(z,_e),ye},ye.destroy=function(){oe(q)},ye}return{create:Y,createStream:Z,destroyStream:ee,getElements:function(Q){return typeof Q=="function"&&Q._elements instanceof X?Q._elements:null},clear:function(){Sr($).forEach(oe)}}}var Yf=new Float32Array(1),dp=new Uint32Array(Yf.buffer),hp=5123;function Kf(s){for(var d=Bt.allocType(hp,s.length),_=0;_<s.length;++_)if(isNaN(s[_]))d[_]=65535;else if(s[_]===1/0)d[_]=31744;else if(s[_]===-1/0)d[_]=64512;else{Yf[0]=s[_];var G=dp[0],$=G>>>31<<15,I=(G<<1>>>24)-127,k=G>>13&1023;if(I<-24)d[_]=$;else if(I<-14){var X=-14-I;d[_]=$+(k+1024>>X)}else I>15?d[_]=$+31744:d[_]=$+(I+15<<10)+k}return d}function Mt(s){return Array.isArray(s)||r(s)}var qf=function(s){return!(s&s-1)&&!!s},pp=34467,zr=3553,Ks=34067,Da=34069,Vn=6408,qs=6406,Ia=6407,$i=6409,Ga=6410,Qf=32854,Qs=32855,Zf=36194,mp=32819,vp=32820,_p=33635,gp=34042,Zs=6402,Ma=34041,Js=35904,eo=35906,di=36193,to=33776,ro=33777,no=33778,io=33779,Jf=35986,el=35987,tl=34798,rl=35840,nl=35841,il=35842,al=35843,sl=36196,hi=5121,ao=5123,so=5125,Vi=5126,yp=10242,bp=10243,xp=10497,oo=33071,Ep=33648,Tp=10240,Ap=10241,fo=9728,wp=9729,lo=9984,ol=9985,fl=9986,co=9987,Sp=33170,Na=4352,Cp=4353,Lp=4354,Rp=34046,Op=3317,Fp=37440,Pp=37441,Dp=37443,ll=37444,ji=33984,Ip=[lo,fl,ol,co],ka=[0,$i,Ga,Ia,Vn],Dr={};Dr[$i]=Dr[qs]=Dr[Zs]=1,Dr[Ma]=Dr[Ga]=2,Dr[Ia]=Dr[Js]=3,Dr[Vn]=Dr[eo]=4;function pi(s){return"[object "+s+"]"}var cl=pi("HTMLCanvasElement"),ul=pi("OffscreenCanvas"),dl=pi("CanvasRenderingContext2D"),hl=pi("ImageBitmap"),pl=pi("HTMLImageElement"),ml=pi("HTMLVideoElement"),Gp=Object.keys(Hs).concat([cl,ul,dl,hl,pl,ml]),mi=[];mi[hi]=1,mi[Vi]=4,mi[di]=2,mi[ao]=2,mi[so]=4;var tr=[];tr[Qf]=2,tr[Qs]=2,tr[Zf]=2,tr[Ma]=4,tr[to]=.5,tr[ro]=.5,tr[no]=1,tr[io]=1,tr[Jf]=.5,tr[el]=1,tr[tl]=1,tr[rl]=.5,tr[nl]=.25,tr[il]=.5,tr[al]=.25,tr[sl]=.5;function vl(s){return Array.isArray(s)&&(s.length===0||typeof s[0]=="number")}function _l(s){if(!Array.isArray(s))return!1;var d=s.length;return!(d===0||!Mt(s[0]))}function jn(s){return Object.prototype.toString.call(s)}function gl(s){return jn(s)===cl}function yl(s){return jn(s)===ul}function Mp(s){return jn(s)===dl}function Np(s){return jn(s)===hl}function kp(s){return jn(s)===pl}function Bp(s){return jn(s)===ml}function uo(s){if(!s)return!1;var d=jn(s);return Gp.indexOf(d)>=0?!0:vl(s)||_l(s)||kr(s)}function bl(s){return Hs[Object.prototype.toString.call(s)]|0}function Up(s,d){var _=d.length;switch(s.type){case hi:case ao:case so:case Vi:var G=Bt.allocType(s.type,_);G.set(d),s.data=G;break;case di:s.data=Kf(d);break;default:c.raise("unsupported texture type, must specify a typed array")}}function xl(s,d){return Bt.allocType(s.type===di?Vi:s.type,d)}function El(s,d){s.type===di?(s.data=Kf(d),Bt.freeType(d)):s.data=d}function $p(s,d,_,G,$,I){for(var k=s.width,X=s.height,W=s.channels,Z=k*X*W,ee=xl(s,Z),J=0,oe=0;oe<X;++oe)for(var Y=0;Y<k;++Y)for(var Q=0;Q<W;++Q)ee[J++]=d[_*Y+G*oe+$*Q+I];El(s,ee)}function Ba(s,d,_,G,$,I){var k;if(typeof tr[s]<"u"?k=tr[s]:k=Dr[s]*mi[d],I&&(k*=6),$){for(var X=0,W=_;W>=1;)X+=k*W*W,W/=2;return X}else return k*_*G}function Vp(s,d,_,G,$,I,k){var X={"don't care":Na,"dont care":Na,nice:Lp,fast:Cp},W={repeat:xp,clamp:oo,mirror:Ep},Z={nearest:fo,linear:wp},ee=n({mipmap:co,"nearest mipmap nearest":lo,"linear mipmap nearest":ol,"nearest mipmap linear":fl,"linear mipmap linear":co},Z),J={none:0,browser:ll},oe={uint8:hi,rgba4:mp,rgb565:_p,"rgb5 a1":vp},Y={alpha:qs,luminance:$i,"luminance alpha":Ga,rgb:Ia,rgba:Vn,rgba4:Qf,"rgb5 a1":Qs,rgb565:Zf},Q={};d.ext_srgb&&(Y.srgb=Js,Y.srgba=eo),d.oes_texture_float&&(oe.float32=oe.float=Vi),d.oes_texture_half_float&&(oe.float16=oe["half float"]=di),d.webgl_depth_texture&&(n(Y,{depth:Zs,"depth stencil":Ma}),n(oe,{uint16:ao,uint32:so,"depth stencil":gp})),d.webgl_compressed_texture_s3tc&&n(Q,{"rgb s3tc dxt1":to,"rgba s3tc dxt1":ro,"rgba s3tc dxt3":no,"rgba s3tc dxt5":io}),d.webgl_compressed_texture_atc&&n(Q,{"rgb atc":Jf,"rgba atc explicit alpha":el,"rgba atc interpolated alpha":tl}),d.webgl_compressed_texture_pvrtc&&n(Q,{"rgb pvrtc 4bppv1":rl,"rgb pvrtc 2bppv1":nl,"rgba pvrtc 4bppv1":il,"rgba pvrtc 2bppv1":al}),d.webgl_compressed_texture_etc1&&(Q["rgb etc1"]=sl);var C=Array.prototype.slice.call(s.getParameter(pp));Object.keys(Q).forEach(function(v){var M=Q[v];C.indexOf(M)>=0&&(Y[v]=M)});var N=Object.keys(Y);_.textureFormats=N;var q=[];Object.keys(Y).forEach(function(v){var M=Y[v];q[M]=v});var ye=[];Object.keys(oe).forEach(function(v){var M=oe[v];ye[M]=v});var z=[];Object.keys(Z).forEach(function(v){var M=Z[v];z[M]=v});var _e=[];Object.keys(ee).forEach(function(v){var M=ee[v];_e[M]=v});var pe=[];Object.keys(W).forEach(function(v){var M=W[v];pe[M]=v});var Be=N.reduce(function(v,M){var D=Y[M];return D===$i||D===qs||D===$i||D===Ga||D===Zs||D===Ma||d.ext_srgb&&(D===Js||D===eo)?v[D]=D:D===Qs||M.indexOf("rgba")>=0?v[D]=Vn:v[D]=Ia,v},{});function V(){this.internalformat=Vn,this.format=Vn,this.type=hi,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ll,this.width=0,this.height=0,this.channels=0}function B(v,M){v.internalformat=M.internalformat,v.format=M.format,v.type=M.type,v.compressed=M.compressed,v.premultiplyAlpha=M.premultiplyAlpha,v.flipY=M.flipY,v.unpackAlignment=M.unpackAlignment,v.colorSpace=M.colorSpace,v.width=M.width,v.height=M.height,v.channels=M.channels}function Ae(v,M){if(!(typeof M!="object"||!M)){if("premultiplyAlpha"in M&&(c.type(M.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),v.premultiplyAlpha=M.premultiplyAlpha),"flipY"in M&&(c.type(M.flipY,"boolean","invalid texture flip"),v.flipY=M.flipY),"alignment"in M&&(c.oneOf(M.alignment,[1,2,4,8],"invalid texture unpack alignment"),v.unpackAlignment=M.alignment),"colorSpace"in M&&(c.parameter(M.colorSpace,J,"invalid colorSpace"),v.colorSpace=J[M.colorSpace]),"type"in M){var D=M.type;c(d.oes_texture_float||!(D==="float"||D==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),c(d.oes_texture_half_float||!(D==="half float"||D==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),c(d.webgl_depth_texture||!(D==="uint16"||D==="uint32"||D==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),c.parameter(D,oe,"invalid texture type"),v.type=oe[D]}var Ee=v.width,nt=v.height,p=v.channels,u=!1;"shape"in M?(c(Array.isArray(M.shape)&&M.shape.length>=2,"shape must be an array"),Ee=M.shape[0],nt=M.shape[1],M.shape.length===3&&(p=M.shape[2],c(p>0&&p<=4,"invalid number of channels"),u=!0),c(Ee>=0&&Ee<=_.maxTextureSize,"invalid width"),c(nt>=0&&nt<=_.maxTextureSize,"invalid height")):("radius"in M&&(Ee=nt=M.radius,c(Ee>=0&&Ee<=_.maxTextureSize,"invalid radius")),"width"in M&&(Ee=M.width,c(Ee>=0&&Ee<=_.maxTextureSize,"invalid width")),"height"in M&&(nt=M.height,c(nt>=0&&nt<=_.maxTextureSize,"invalid height")),"channels"in M&&(p=M.channels,c(p>0&&p<=4,"invalid number of channels"),u=!0)),v.width=Ee|0,v.height=nt|0,v.channels=p|0;var x=!1;if("format"in M){var S=M.format;c(d.webgl_depth_texture||!(S==="depth"||S==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),c.parameter(S,Y,"invalid texture format");var O=v.internalformat=Y[S];v.format=Be[O],S in oe&&("type"in M||(v.type=oe[S])),S in Q&&(v.compressed=!0),x=!0}!u&&x?v.channels=Dr[v.format]:u&&!x?v.channels!==ka[v.format]&&(v.format=v.internalformat=ka[v.channels]):x&&u&&c(v.channels===Dr[v.format],"number of channels inconsistent with specified format")}}function fe(v){s.pixelStorei(Fp,v.flipY),s.pixelStorei(Pp,v.premultiplyAlpha),s.pixelStorei(Dp,v.colorSpace),s.pixelStorei(Op,v.unpackAlignment)}function K(){V.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ce(v,M){var D=null;if(uo(M)?D=M:M&&(c.type(M,"object","invalid pixel data type"),Ae(v,M),"x"in M&&(v.xOffset=M.x|0),"y"in M&&(v.yOffset=M.y|0),uo(M.data)&&(D=M.data)),c(!v.compressed||D instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),M.copy){c(!D,"can not specify copy and data field for the same texture");var Ee=$.viewportWidth,nt=$.viewportHeight;v.width=v.width||Ee-v.xOffset,v.height=v.height||nt-v.yOffset,v.needsCopy=!0,c(v.xOffset>=0&&v.xOffset<Ee&&v.yOffset>=0&&v.yOffset<nt&&v.width>0&&v.width<=Ee&&v.height>0&&v.height<=nt,"copy texture read out of bounds")}else if(!D)v.width=v.width||1,v.height=v.height||1,v.channels=v.channels||4;else if(r(D))v.channels=v.channels||4,v.data=D,!("type"in M)&&v.type===hi&&(v.type=bl(D));else if(vl(D))v.channels=v.channels||4,Up(v,D),v.alignment=1,v.needsFree=!0;else if(kr(D)){var p=D.data;!Array.isArray(p)&&v.type===hi&&(v.type=bl(p));var u=D.shape,x=D.stride,S,O,T,E,w,h;u.length===3?(T=u[2],h=x[2]):(c(u.length===2,"invalid ndarray pixel data, must be 2 or 3D"),T=1,h=1),S=u[0],O=u[1],E=x[0],w=x[1],v.alignment=1,v.width=S,v.height=O,v.channels=T,v.format=v.internalformat=ka[T],v.needsFree=!0,$p(v,p,E,w,h,D.offset)}else if(gl(D)||yl(D)||Mp(D))gl(D)||yl(D)?v.element=D:v.element=D.canvas,v.width=v.element.width,v.height=v.element.height,v.channels=4;else if(Np(D))v.element=D,v.width=D.width,v.height=D.height,v.channels=4;else if(kp(D))v.element=D,v.width=D.naturalWidth,v.height=D.naturalHeight,v.channels=4;else if(Bp(D))v.element=D,v.width=D.videoWidth,v.height=D.videoHeight,v.channels=4;else if(_l(D)){var b=v.width||D[0].length,m=v.height||D.length,L=v.channels;Mt(D[0][0])?L=L||D[0][0].length:L=L||1;for(var F=Oa.shape(D),j=1,ae=0;ae<F.length;++ae)j*=F[ae];var se=xl(v,j);Oa.flatten(D,F,"",se),El(v,se),v.alignment=1,v.width=b,v.height=m,v.channels=L,v.format=v.internalformat=ka[L],v.needsFree=!0}v.type===Vi?c(_.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):v.type===di&&c(_.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function he(v,M,D){var Ee=v.element,nt=v.data,p=v.internalformat,u=v.format,x=v.type,S=v.width,O=v.height;fe(v),Ee?s.texImage2D(M,D,u,u,x,Ee):v.compressed?s.compressedTexImage2D(M,D,p,S,O,0,nt):v.needsCopy?(G(),s.copyTexImage2D(M,D,u,v.xOffset,v.yOffset,S,O,0)):s.texImage2D(M,D,u,S,O,0,u,x,nt||null)}function Ke(v,M,D,Ee,nt){var p=v.element,u=v.data,x=v.internalformat,S=v.format,O=v.type,T=v.width,E=v.height;fe(v),p?s.texSubImage2D(M,nt,D,Ee,S,O,p):v.compressed?s.compressedTexSubImage2D(M,nt,D,Ee,x,T,E,u):v.needsCopy?(G(),s.copyTexSubImage2D(M,nt,D,Ee,v.xOffset,v.yOffset,T,E)):s.texSubImage2D(M,nt,D,Ee,T,E,S,O,u)}var ze=[];function me(){return ze.pop()||new K}function ge(v){v.needsFree&&Bt.freeType(v.data),K.call(v),ze.push(v)}function Ve(){V.call(this),this.genMipmaps=!1,this.mipmapHint=Na,this.mipmask=0,this.images=Array(16)}function Ye(v,M,D){var Ee=v.images[0]=me();v.mipmask=1,Ee.width=v.width=M,Ee.height=v.height=D,Ee.channels=v.channels=4}function it(v,M){var D=null;if(uo(M))D=v.images[0]=me(),B(D,v),ce(D,M),v.mipmask=1;else if(Ae(v,M),Array.isArray(M.mipmap))for(var Ee=M.mipmap,nt=0;nt<Ee.length;++nt)D=v.images[nt]=me(),B(D,v),D.width>>=nt,D.height>>=nt,ce(D,Ee[nt]),v.mipmask|=1<<nt;else D=v.images[0]=me(),B(D,v),ce(D,M),v.mipmask=1;B(v,v.images[0]),v.compressed&&(v.internalformat===to||v.internalformat===ro||v.internalformat===no||v.internalformat===io)&&c(v.width%4===0&&v.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Dt(v,M){for(var D=v.images,Ee=0;Ee<D.length;++Ee){if(!D[Ee])return;he(D[Ee],M,Ee)}}var Gt=[];function st(){var v=Gt.pop()||new Ve;V.call(v),v.mipmask=0;for(var M=0;M<16;++M)v.images[M]=null;return v}function jt(v){for(var M=v.images,D=0;D<M.length;++D)M[D]&&ge(M[D]),M[D]=null;Gt.push(v)}function Lt(){this.minFilter=fo,this.magFilter=fo,this.wrapS=oo,this.wrapT=oo,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Na}function $t(v,M){if("min"in M){var D=M.min;c.parameter(D,ee),v.minFilter=ee[D],Ip.indexOf(v.minFilter)>=0&&!("faces"in M)&&(v.genMipmaps=!0)}if("mag"in M){var Ee=M.mag;c.parameter(Ee,Z),v.magFilter=Z[Ee]}var nt=v.wrapS,p=v.wrapT;if("wrap"in M){var u=M.wrap;typeof u=="string"?(c.parameter(u,W),nt=p=W[u]):Array.isArray(u)&&(c.parameter(u[0],W),c.parameter(u[1],W),nt=W[u[0]],p=W[u[1]])}else{if("wrapS"in M){var x=M.wrapS;c.parameter(x,W),nt=W[x]}if("wrapT"in M){var S=M.wrapT;c.parameter(S,W),p=W[S]}}if(v.wrapS=nt,v.wrapT=p,"anisotropic"in M){var O=M.anisotropic;c(typeof O=="number"&&O>=1&&O<=_.maxAnisotropic,"aniso samples must be between 1 and "),v.anisotropic=M.anisotropic}if("mipmap"in M){var T=!1;switch(typeof M.mipmap){case"string":c.parameter(M.mipmap,X,"invalid mipmap hint"),v.mipmapHint=X[M.mipmap],v.genMipmaps=!0,T=!0;break;case"boolean":T=v.genMipmaps=M.mipmap;break;case"object":c(Array.isArray(M.mipmap),"invalid mipmap type"),v.genMipmaps=!1,T=!0;break;default:c.raise("invalid mipmap type")}T&&!("min"in M)&&(v.minFilter=lo)}}function Ht(v,M){s.texParameteri(M,Ap,v.minFilter),s.texParameteri(M,Tp,v.magFilter),s.texParameteri(M,yp,v.wrapS),s.texParameteri(M,bp,v.wrapT),d.ext_texture_filter_anisotropic&&s.texParameteri(M,Rp,v.anisotropic),v.genMipmaps&&(s.hint(Sp,v.mipmapHint),s.generateMipmap(M))}var zt=0,Zt={},rr=_.maxTextureUnits,Nt=Array(rr).map(function(){return null});function Je(v){V.call(this),this.mipmask=0,this.internalformat=Vn,this.id=zt++,this.refCount=1,this.target=v,this.texture=s.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Lt,k.profile&&(this.stats={size:0})}function nr(v){s.activeTexture(ji),s.bindTexture(v.target,v.texture)}function pt(){var v=Nt[0];v?s.bindTexture(v.target,v.texture):s.bindTexture(zr,null)}function Ue(v){var M=v.texture;c(M,"must not double destroy texture");var D=v.unit,Ee=v.target;D>=0&&(s.activeTexture(ji+D),s.bindTexture(Ee,null),Nt[D]=null),s.deleteTexture(M),v.texture=null,v.params=null,v.pixels=null,v.refCount=0,delete Zt[v.id],I.textureCount--}n(Je.prototype,{bind:function(){var v=this;v.bindCount+=1;var M=v.unit;if(M<0){for(var D=0;D<rr;++D){var Ee=Nt[D];if(Ee){if(Ee.bindCount>0)continue;Ee.unit=-1}Nt[D]=v,M=D;break}M>=rr&&c.raise("insufficient number of texture units"),k.profile&&I.maxTextureUnits<M+1&&(I.maxTextureUnits=M+1),v.unit=M,s.activeTexture(ji+M),s.bindTexture(v.target,v.texture)}return M},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Ue(this)}});function at(v,M){var D=new Je(zr);Zt[D.id]=D,I.textureCount++;function Ee(u,x){var S=D.texInfo;Lt.call(S);var O=st();return typeof u=="number"?typeof x=="number"?Ye(O,u|0,x|0):Ye(O,u|0,u|0):u?(c.type(u,"object","invalid arguments to regl.texture"),$t(S,u),it(O,u)):Ye(O,1,1),S.genMipmaps&&(O.mipmask=(O.width<<1)-1),D.mipmask=O.mipmask,B(D,O),c.texture2D(S,O,_),D.internalformat=O.internalformat,Ee.width=O.width,Ee.height=O.height,nr(D),Dt(O,zr),Ht(S,zr),pt(),jt(O),k.profile&&(D.stats.size=Ba(D.internalformat,D.type,O.width,O.height,S.genMipmaps,!1)),Ee.format=q[D.internalformat],Ee.type=ye[D.type],Ee.mag=z[S.magFilter],Ee.min=_e[S.minFilter],Ee.wrapS=pe[S.wrapS],Ee.wrapT=pe[S.wrapT],Ee}function nt(u,x,S,O){c(!!u,"must specify image data");var T=x|0,E=S|0,w=O|0,h=me();return B(h,D),h.width=0,h.height=0,ce(h,u),h.width=h.width||(D.width>>w)-T,h.height=h.height||(D.height>>w)-E,c(D.type===h.type&&D.format===h.format&&D.internalformat===h.internalformat,"incompatible format for texture.subimage"),c(T>=0&&E>=0&&T+h.width<=D.width&&E+h.height<=D.height,"texture.subimage write out of bounds"),c(D.mipmask&1<<w,"missing mipmap data"),c(h.data||h.element||h.needsCopy,"missing image data"),nr(D),Ke(h,zr,T,E,w),pt(),ge(h),Ee}function p(u,x){var S=u|0,O=x|0||S;if(S===D.width&&O===D.height)return Ee;Ee.width=D.width=S,Ee.height=D.height=O,nr(D);for(var T=0;D.mipmask>>T;++T){var E=S>>T,w=O>>T;if(!E||!w)break;s.texImage2D(zr,T,D.format,E,w,0,D.format,D.type,null)}return pt(),k.profile&&(D.stats.size=Ba(D.internalformat,D.type,S,O,!1,!1)),Ee}return Ee(v,M),Ee.subimage=nt,Ee.resize=p,Ee._reglType="texture2d",Ee._texture=D,k.profile&&(Ee.stats=D.stats),Ee.destroy=function(){D.decRef()},Ee}function ct(v,M,D,Ee,nt,p){var u=new Je(Ks);Zt[u.id]=u,I.cubeCount++;var x=new Array(6);function S(E,w,h,b,m,L){var F,j=u.texInfo;for(Lt.call(j),F=0;F<6;++F)x[F]=st();if(typeof E=="number"||!E){var ae=E|0||1;for(F=0;F<6;++F)Ye(x[F],ae,ae)}else if(typeof E=="object")if(w)it(x[0],E),it(x[1],w),it(x[2],h),it(x[3],b),it(x[4],m),it(x[5],L);else if($t(j,E),Ae(u,E),"faces"in E){var se=E.faces;for(c(Array.isArray(se)&&se.length===6,"cube faces must be a length 6 array"),F=0;F<6;++F)c(typeof se[F]=="object"&&!!se[F],"invalid input for cube map face"),B(x[F],u),it(x[F],se[F])}else for(F=0;F<6;++F)it(x[F],E);else c.raise("invalid arguments to cube map");for(B(u,x[0]),c.optional(function(){_.npotTextureCube||c(qf(u.width)&&qf(u.height),"your browser does not support non power or two texture dimensions")}),j.genMipmaps?u.mipmask=(x[0].width<<1)-1:u.mipmask=x[0].mipmask,c.textureCube(u,j,x,_),u.internalformat=x[0].internalformat,S.width=x[0].width,S.height=x[0].height,nr(u),F=0;F<6;++F)Dt(x[F],Da+F);for(Ht(j,Ks),pt(),k.profile&&(u.stats.size=Ba(u.internalformat,u.type,S.width,S.height,j.genMipmaps,!0)),S.format=q[u.internalformat],S.type=ye[u.type],S.mag=z[j.magFilter],S.min=_e[j.minFilter],S.wrapS=pe[j.wrapS],S.wrapT=pe[j.wrapT],F=0;F<6;++F)jt(x[F]);return S}function O(E,w,h,b,m){c(!!w,"must specify image data"),c(typeof E=="number"&&E===(E|0)&&E>=0&&E<6,"invalid face");var L=h|0,F=b|0,j=m|0,ae=me();return B(ae,u),ae.width=0,ae.height=0,ce(ae,w),ae.width=ae.width||(u.width>>j)-L,ae.height=ae.height||(u.height>>j)-F,c(u.type===ae.type&&u.format===ae.format&&u.internalformat===ae.internalformat,"incompatible format for texture.subimage"),c(L>=0&&F>=0&&L+ae.width<=u.width&&F+ae.height<=u.height,"texture.subimage write out of bounds"),c(u.mipmask&1<<j,"missing mipmap data"),c(ae.data||ae.element||ae.needsCopy,"missing image data"),nr(u),Ke(ae,Da+E,L,F,j),pt(),ge(ae),S}function T(E){var w=E|0;if(w!==u.width){S.width=u.width=w,S.height=u.height=w,nr(u);for(var h=0;h<6;++h)for(var b=0;u.mipmask>>b;++b)s.texImage2D(Da+h,b,u.format,w>>b,w>>b,0,u.format,u.type,null);return pt(),k.profile&&(u.stats.size=Ba(u.internalformat,u.type,S.width,S.height,!1,!0)),S}}return S(v,M,D,Ee,nt,p),S.subimage=O,S.resize=T,S._reglType="textureCube",S._texture=u,k.profile&&(S.stats=u.stats),S.destroy=function(){u.decRef()},S}function kt(){for(var v=0;v<rr;++v)s.activeTexture(ji+v),s.bindTexture(zr,null),Nt[v]=null;Sr(Zt).forEach(Ue),I.cubeCount=0,I.textureCount=0}k.profile&&(I.getTotalTextureSize=function(){var v=0;return Object.keys(Zt).forEach(function(M){v+=Zt[M].stats.size}),v});function Xr(){for(var v=0;v<rr;++v){var M=Nt[v];M&&(M.bindCount=0,M.unit=-1,Nt[v]=null)}Sr(Zt).forEach(function(D){D.texture=s.createTexture(),s.bindTexture(D.target,D.texture);for(var Ee=0;Ee<32;++Ee)if(D.mipmask&1<<Ee)if(D.target===zr)s.texImage2D(zr,Ee,D.internalformat,D.width>>Ee,D.height>>Ee,0,D.internalformat,D.type,null);else for(var nt=0;nt<6;++nt)s.texImage2D(Da+nt,Ee,D.internalformat,D.width>>Ee,D.height>>Ee,0,D.internalformat,D.type,null);Ht(D.texInfo,D.target)})}function qn(){for(var v=0;v<rr;++v){var M=Nt[v];M&&(M.bindCount=0,M.unit=-1,Nt[v]=null),s.activeTexture(ji+v),s.bindTexture(zr,null),s.bindTexture(Ks,null)}}return{create2D:at,createCube:ct,clear:kt,getTexture:function(v){return null},restore:Xr,refresh:qn}}var En=36161,Ua=32854,Tl=32855,Al=36194,wl=33189,Sl=36168,Cl=34041,Ll=35907,Rl=34836,Ol=34842,Fl=34843,Br=[];Br[Ua]=2,Br[Tl]=2,Br[Al]=2,Br[wl]=2,Br[Sl]=1,Br[Cl]=4,Br[Ll]=4,Br[Rl]=16,Br[Ol]=8,Br[Fl]=6;function Pl(s,d,_){return Br[s]*d*_}var jp=function(s,d,_,G,$){var I={rgba4:Ua,rgb565:Al,"rgb5 a1":Tl,depth:wl,stencil:Sl,"depth stencil":Cl};d.ext_srgb&&(I.srgba=Ll),d.ext_color_buffer_half_float&&(I.rgba16f=Ol,I.rgb16f=Fl),d.webgl_color_buffer_float&&(I.rgba32f=Rl);var k=[];Object.keys(I).forEach(function(Y){var Q=I[Y];k[Q]=Y});var X=0,W={};function Z(Y){this.id=X++,this.refCount=1,this.renderbuffer=Y,this.format=Ua,this.width=0,this.height=0,$.profile&&(this.stats={size:0})}Z.prototype.decRef=function(){--this.refCount<=0&&ee(this)};function ee(Y){var Q=Y.renderbuffer;c(Q,"must not double destroy renderbuffer"),s.bindRenderbuffer(En,null),s.deleteRenderbuffer(Q),Y.renderbuffer=null,Y.refCount=0,delete W[Y.id],G.renderbufferCount--}function J(Y,Q){var C=new Z(s.createRenderbuffer());W[C.id]=C,G.renderbufferCount++;function N(ye,z){var _e=0,pe=0,Be=Ua;if(typeof ye=="object"&&ye){var V=ye;if("shape"in V){var B=V.shape;c(Array.isArray(B)&&B.length>=2,"invalid renderbuffer shape"),_e=B[0]|0,pe=B[1]|0}else"radius"in V&&(_e=pe=V.radius|0),"width"in V&&(_e=V.width|0),"height"in V&&(pe=V.height|0);"format"in V&&(c.parameter(V.format,I,"invalid renderbuffer format"),Be=I[V.format])}else typeof ye=="number"?(_e=ye|0,typeof z=="number"?pe=z|0:pe=_e):ye?c.raise("invalid arguments to renderbuffer constructor"):_e=pe=1;if(c(_e>0&&pe>0&&_e<=_.maxRenderbufferSize&&pe<=_.maxRenderbufferSize,"invalid renderbuffer size"),!(_e===C.width&&pe===C.height&&Be===C.format))return N.width=C.width=_e,N.height=C.height=pe,C.format=Be,s.bindRenderbuffer(En,C.renderbuffer),s.renderbufferStorage(En,Be,_e,pe),c(s.getError()===0,"invalid render buffer format"),$.profile&&(C.stats.size=Pl(C.format,C.width,C.height)),N.format=k[C.format],N}function q(ye,z){var _e=ye|0,pe=z|0||_e;return _e===C.width&&pe===C.height||(c(_e>0&&pe>0&&_e<=_.maxRenderbufferSize&&pe<=_.maxRenderbufferSize,"invalid renderbuffer size"),N.width=C.width=_e,N.height=C.height=pe,s.bindRenderbuffer(En,C.renderbuffer),s.renderbufferStorage(En,C.format,_e,pe),c(s.getError()===0,"invalid render buffer format"),$.profile&&(C.stats.size=Pl(C.format,C.width,C.height))),N}return N(Y,Q),N.resize=q,N._reglType="renderbuffer",N._renderbuffer=C,$.profile&&(N.stats=C.stats),N.destroy=function(){C.decRef()},N}$.profile&&(G.getTotalRenderbufferSize=function(){var Y=0;return Object.keys(W).forEach(function(Q){Y+=W[Q].stats.size}),Y});function oe(){Sr(W).forEach(function(Y){Y.renderbuffer=s.createRenderbuffer(),s.bindRenderbuffer(En,Y.renderbuffer),s.renderbufferStorage(En,Y.format,Y.width,Y.height)}),s.bindRenderbuffer(En,null)}return{create:J,clear:function(){Sr(W).forEach(ee)},restore:oe}},sn=36160,ho=36161,Hn=3553,$a=34069,Dl=36064,Il=36096,Gl=36128,Ml=33306,Nl=36053,Hp=36054,zp=36055,Wp=36057,Xp=36061,Yp=36193,Kp=5121,qp=5126,kl=6407,Bl=6408,Qp=6402,Zp=[kl,Bl],po=[];po[Bl]=4,po[kl]=3;var Va=[];Va[Kp]=1,Va[qp]=4,Va[Yp]=2;var Jp=32854,em=32855,tm=36194,rm=33189,nm=36168,Ul=34041,im=35907,am=34836,sm=34842,om=34843,fm=[Jp,em,tm,im,sm,om,am],vi={};vi[Nl]="complete",vi[Hp]="incomplete attachment",vi[Wp]="incomplete dimensions",vi[zp]="incomplete, missing attachment",vi[Xp]="unsupported";function lm(s,d,_,G,$,I){var k={cur:null,next:null,dirty:!1,setFBO:null},X=["rgba"],W=["rgba4","rgb565","rgb5 a1"];d.ext_srgb&&W.push("srgba"),d.ext_color_buffer_half_float&&W.push("rgba16f","rgb16f"),d.webgl_color_buffer_float&&W.push("rgba32f");var Z=["uint8"];d.oes_texture_half_float&&Z.push("half float","float16"),d.oes_texture_float&&Z.push("float","float32");function ee(K,ce,he){this.target=K,this.texture=ce,this.renderbuffer=he;var Ke=0,ze=0;ce?(Ke=ce.width,ze=ce.height):he&&(Ke=he.width,ze=he.height),this.width=Ke,this.height=ze}function J(K){K&&(K.texture&&K.texture._texture.decRef(),K.renderbuffer&&K.renderbuffer._renderbuffer.decRef())}function oe(K,ce,he){if(K)if(K.texture){var Ke=K.texture._texture,ze=Math.max(1,Ke.width),me=Math.max(1,Ke.height);c(ze===ce&&me===he,"inconsistent width/height for supplied texture"),Ke.refCount+=1}else{var ge=K.renderbuffer._renderbuffer;c(ge.width===ce&&ge.height===he,"inconsistent width/height for renderbuffer"),ge.refCount+=1}}function Y(K,ce){ce&&(ce.texture?s.framebufferTexture2D(sn,K,ce.target,ce.texture._texture.texture,0):s.framebufferRenderbuffer(sn,K,ho,ce.renderbuffer._renderbuffer.renderbuffer))}function Q(K){var ce=Hn,he=null,Ke=null,ze=K;typeof K=="object"&&(ze=K.data,"target"in K&&(ce=K.target|0)),c.type(ze,"function","invalid attachment data");var me=ze._reglType;return me==="texture2d"?(he=ze,c(ce===Hn)):me==="textureCube"?(he=ze,c(ce>=$a&&ce<$a+6,"invalid cube map target")):me==="renderbuffer"?(Ke=ze,ce=ho):c.raise("invalid regl object for attachment"),new ee(ce,he,Ke)}function C(K,ce,he,Ke,ze){if(he){var me=G.create2D({width:K,height:ce,format:Ke,type:ze});return me._texture.refCount=0,new ee(Hn,me,null)}else{var ge=$.create({width:K,height:ce,format:Ke});return ge._renderbuffer.refCount=0,new ee(ho,null,ge)}}function N(K){return K&&(K.texture||K.renderbuffer)}function q(K,ce,he){K&&(K.texture?K.texture.resize(ce,he):K.renderbuffer&&K.renderbuffer.resize(ce,he),K.width=ce,K.height=he)}var ye=0,z={};function _e(){this.id=ye++,z[this.id]=this,this.framebuffer=s.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function pe(K){K.colorAttachments.forEach(J),J(K.depthAttachment),J(K.stencilAttachment),J(K.depthStencilAttachment)}function Be(K){var ce=K.framebuffer;c(ce,"must not double destroy framebuffer"),s.deleteFramebuffer(ce),K.framebuffer=null,I.framebufferCount--,delete z[K.id]}function V(K){var ce;s.bindFramebuffer(sn,K.framebuffer);var he=K.colorAttachments;for(ce=0;ce<he.length;++ce)Y(Dl+ce,he[ce]);for(ce=he.length;ce<_.maxColorAttachments;++ce)s.framebufferTexture2D(sn,Dl+ce,Hn,null,0);s.framebufferTexture2D(sn,Ml,Hn,null,0),s.framebufferTexture2D(sn,Il,Hn,null,0),s.framebufferTexture2D(sn,Gl,Hn,null,0),Y(Il,K.depthAttachment),Y(Gl,K.stencilAttachment),Y(Ml,K.depthStencilAttachment);var Ke=s.checkFramebufferStatus(sn);!s.isContextLost()&&Ke!==Nl&&c.raise("framebuffer configuration not supported, status = "+vi[Ke]),s.bindFramebuffer(sn,k.next?k.next.framebuffer:null),k.cur=k.next,s.getError()}function B(K,ce){var he=new _e;I.framebufferCount++;function Ke(me,ge){var Ve;c(k.next!==he,"can not update framebuffer which is currently in use");var Ye=0,it=0,Dt=!0,Gt=!0,st=null,jt=!0,Lt="rgba",$t="uint8",Ht=1,zt=null,Zt=null,rr=null,Nt=!1;if(typeof me=="number")Ye=me|0,it=ge|0||Ye;else if(!me)Ye=it=1;else{c.type(me,"object","invalid arguments for framebuffer");var Je=me;if("shape"in Je){var nr=Je.shape;c(Array.isArray(nr)&&nr.length>=2,"invalid shape for framebuffer"),Ye=nr[0],it=nr[1]}else"radius"in Je&&(Ye=it=Je.radius),"width"in Je&&(Ye=Je.width),"height"in Je&&(it=Je.height);("color"in Je||"colors"in Je)&&(st=Je.color||Je.colors,Array.isArray(st)&&c(st.length===1||d.webgl_draw_buffers,"multiple render targets not supported")),st||("colorCount"in Je&&(Ht=Je.colorCount|0,c(Ht>0,"invalid color buffer count")),"colorTexture"in Je&&(jt=!!Je.colorTexture,Lt="rgba4"),"colorType"in Je&&($t=Je.colorType,jt?(c(d.oes_texture_float||!($t==="float"||$t==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),c(d.oes_texture_half_float||!($t==="half float"||$t==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):$t==="half float"||$t==="float16"?(c(d.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Lt="rgba16f"):($t==="float"||$t==="float32")&&(c(d.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Lt="rgba32f"),c.oneOf($t,Z,"invalid color type")),"colorFormat"in Je&&(Lt=Je.colorFormat,X.indexOf(Lt)>=0?jt=!0:W.indexOf(Lt)>=0?jt=!1:c.optional(function(){jt?c.oneOf(Je.colorFormat,X,"invalid color format for texture"):c.oneOf(Je.colorFormat,W,"invalid color format for renderbuffer")}))),("depthTexture"in Je||"depthStencilTexture"in Je)&&(Nt=!!(Je.depthTexture||Je.depthStencilTexture),c(!Nt||d.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Je&&(typeof Je.depth=="boolean"?Dt=Je.depth:(zt=Je.depth,Gt=!1)),"stencil"in Je&&(typeof Je.stencil=="boolean"?Gt=Je.stencil:(Zt=Je.stencil,Dt=!1)),"depthStencil"in Je&&(typeof Je.depthStencil=="boolean"?Dt=Gt=Je.depthStencil:(rr=Je.depthStencil,Dt=!1,Gt=!1))}var pt=null,Ue=null,at=null,ct=null;if(Array.isArray(st))pt=st.map(Q);else if(st)pt=[Q(st)];else for(pt=new Array(Ht),Ve=0;Ve<Ht;++Ve)pt[Ve]=C(Ye,it,jt,Lt,$t);c(d.webgl_draw_buffers||pt.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),c(pt.length<=_.maxColorAttachments,"too many color attachments, not supported"),Ye=Ye||pt[0].width,it=it||pt[0].height,zt?Ue=Q(zt):Dt&&!Gt&&(Ue=C(Ye,it,Nt,"depth","uint32")),Zt?at=Q(Zt):Gt&&!Dt&&(at=C(Ye,it,!1,"stencil","uint8")),rr?ct=Q(rr):!zt&&!Zt&&Gt&&Dt&&(ct=C(Ye,it,Nt,"depth stencil","depth stencil")),c(!!zt+!!Zt+!!rr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var kt=null;for(Ve=0;Ve<pt.length;++Ve)if(oe(pt[Ve],Ye,it),c(!pt[Ve]||pt[Ve].texture&&Zp.indexOf(pt[Ve].texture._texture.format)>=0||pt[Ve].renderbuffer&&fm.indexOf(pt[Ve].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ve+" is invalid"),pt[Ve]&&pt[Ve].texture){var Xr=po[pt[Ve].texture._texture.format]*Va[pt[Ve].texture._texture.type];kt===null?kt=Xr:c(kt===Xr,"all color attachments much have the same number of bits per pixel.")}return oe(Ue,Ye,it),c(!Ue||Ue.texture&&Ue.texture._texture.format===Qp||Ue.renderbuffer&&Ue.renderbuffer._renderbuffer.format===rm,"invalid depth attachment for framebuffer object"),oe(at,Ye,it),c(!at||at.renderbuffer&&at.renderbuffer._renderbuffer.format===nm,"invalid stencil attachment for framebuffer object"),oe(ct,Ye,it),c(!ct||ct.texture&&ct.texture._texture.format===Ul||ct.renderbuffer&&ct.renderbuffer._renderbuffer.format===Ul,"invalid depth-stencil attachment for framebuffer object"),pe(he),he.width=Ye,he.height=it,he.colorAttachments=pt,he.depthAttachment=Ue,he.stencilAttachment=at,he.depthStencilAttachment=ct,Ke.color=pt.map(N),Ke.depth=N(Ue),Ke.stencil=N(at),Ke.depthStencil=N(ct),Ke.width=he.width,Ke.height=he.height,V(he),Ke}function ze(me,ge){c(k.next!==he,"can not resize a framebuffer which is currently in use");var Ve=Math.max(me|0,1),Ye=Math.max(ge|0||Ve,1);if(Ve===he.width&&Ye===he.height)return Ke;for(var it=he.colorAttachments,Dt=0;Dt<it.length;++Dt)q(it[Dt],Ve,Ye);return q(he.depthAttachment,Ve,Ye),q(he.stencilAttachment,Ve,Ye),q(he.depthStencilAttachment,Ve,Ye),he.width=Ke.width=Ve,he.height=Ke.height=Ye,V(he),Ke}return Ke(K,ce),n(Ke,{resize:ze,_reglType:"framebuffer",_framebuffer:he,destroy:function(){Be(he),pe(he)},use:function(me){k.setFBO({framebuffer:Ke},me)}})}function Ae(K){var ce=Array(6);function he(ze){var me;c(ce.indexOf(k.next)<0,"can not update framebuffer which is currently in use");var ge={color:null},Ve=0,Ye=null,it="rgba",Dt="uint8",Gt=1;if(typeof ze=="number")Ve=ze|0;else if(!ze)Ve=1;else{c.type(ze,"object","invalid arguments for framebuffer");var st=ze;if("shape"in st){var jt=st.shape;c(Array.isArray(jt)&&jt.length>=2,"invalid shape for framebuffer"),c(jt[0]===jt[1],"cube framebuffer must be square"),Ve=jt[0]}else"radius"in st&&(Ve=st.radius|0),"width"in st?(Ve=st.width|0,"height"in st&&c(st.height===Ve,"must be square")):"height"in st&&(Ve=st.height|0);("color"in st||"colors"in st)&&(Ye=st.color||st.colors,Array.isArray(Ye)&&c(Ye.length===1||d.webgl_draw_buffers,"multiple render targets not supported")),Ye||("colorCount"in st&&(Gt=st.colorCount|0,c(Gt>0,"invalid color buffer count")),"colorType"in st&&(c.oneOf(st.colorType,Z,"invalid color type"),Dt=st.colorType),"colorFormat"in st&&(it=st.colorFormat,c.oneOf(st.colorFormat,X,"invalid color format for texture"))),"depth"in st&&(ge.depth=st.depth),"stencil"in st&&(ge.stencil=st.stencil),"depthStencil"in st&&(ge.depthStencil=st.depthStencil)}var Lt;if(Ye)if(Array.isArray(Ye))for(Lt=[],me=0;me<Ye.length;++me)Lt[me]=Ye[me];else Lt=[Ye];else{Lt=Array(Gt);var $t={radius:Ve,format:it,type:Dt};for(me=0;me<Gt;++me)Lt[me]=G.createCube($t)}for(ge.color=Array(Lt.length),me=0;me<Lt.length;++me){var Ht=Lt[me];c(typeof Ht=="function"&&Ht._reglType==="textureCube","invalid cube map"),Ve=Ve||Ht.width,c(Ht.width===Ve&&Ht.height===Ve,"invalid cube map shape"),ge.color[me]={target:$a,data:Lt[me]}}for(me=0;me<6;++me){for(var zt=0;zt<Lt.length;++zt)ge.color[zt].target=$a+me;me>0&&(ge.depth=ce[0].depth,ge.stencil=ce[0].stencil,ge.depthStencil=ce[0].depthStencil),ce[me]?ce[me](ge):ce[me]=B(ge)}return n(he,{width:Ve,height:Ve,color:Lt})}function Ke(ze){var me,ge=ze|0;if(c(ge>0&&ge<=_.maxCubeMapSize,"invalid radius for cube fbo"),ge===he.width)return he;var Ve=he.color;for(me=0;me<Ve.length;++me)Ve[me].resize(ge);for(me=0;me<6;++me)ce[me].resize(ge);return he.width=he.height=ge,he}return he(K),n(he,{faces:ce,resize:Ke,_reglType:"framebufferCube",destroy:function(){ce.forEach(function(ze){ze.destroy()})}})}function fe(){k.cur=null,k.next=null,k.dirty=!0,Sr(z).forEach(function(K){K.framebuffer=s.createFramebuffer(),V(K)})}return n(k,{getFramebuffer:function(K){if(typeof K=="function"&&K._reglType==="framebuffer"){var ce=K._framebuffer;if(ce instanceof _e)return ce}return null},create:B,createCube:Ae,clear:function(){Sr(z).forEach(Be)},restore:fe})}var cm=5126,$l=34962,ja=34963,Vl=["attributes","elements","offset","count","primitive","instances"];function mo(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=cm,this.offset=0,this.stride=0,this.divisor=0}function um(s,d,_,G,$,I,k){for(var X=_.maxAttributes,W=new Array(X),Z=0;Z<X;++Z)W[Z]=new mo;var ee=0,J={},oe={Record:mo,scope:{},state:W,currentVAO:null,targetVAO:null,restore:Q()?pe:function(){},createVAO:Be,getVAO:N,destroyBuffer:Y,setVAO:Q()?q:ye,clear:Q()?z:function(){}};function Y(V){for(var B=0;B<W.length;++B){var Ae=W[B];Ae.buffer===V&&(s.disableVertexAttribArray(B),Ae.buffer=null)}}function Q(){return d.oes_vertex_array_object}function C(){return d.angle_instanced_arrays}function N(V){return typeof V=="function"&&V._vao?V._vao:null}function q(V){if(V!==oe.currentVAO){var B=Q();V?B.bindVertexArrayOES(V.vao):B.bindVertexArrayOES(null),oe.currentVAO=V}}function ye(V){if(V!==oe.currentVAO){if(V)V.bindAttrs();else{for(var B=C(),Ae=0;Ae<W.length;++Ae){var fe=W[Ae];fe.buffer?(s.enableVertexAttribArray(Ae),fe.buffer.bind(),s.vertexAttribPointer(Ae,fe.size,fe.type,fe.normalized,fe.stride,fe.offfset),B&&fe.divisor&&B.vertexAttribDivisorANGLE(Ae,fe.divisor)):(s.disableVertexAttribArray(Ae),s.vertexAttrib4f(Ae,fe.x,fe.y,fe.z,fe.w))}k.elements?s.bindBuffer(ja,k.elements.buffer.buffer):s.bindBuffer(ja,null)}oe.currentVAO=V}}function z(){Sr(J).forEach(function(V){V.destroy()})}function _e(){this.id=++ee,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var V=Q();V?this.vao=V.createVertexArrayOES():this.vao=null,J[this.id]=this,this.buffers=[]}_e.prototype.bindAttrs=function(){for(var V=C(),B=this.attributes,Ae=0;Ae<B.length;++Ae){var fe=B[Ae];fe.buffer?(s.enableVertexAttribArray(Ae),s.bindBuffer($l,fe.buffer.buffer),s.vertexAttribPointer(Ae,fe.size,fe.type,fe.normalized,fe.stride,fe.offset),V&&fe.divisor&&V.vertexAttribDivisorANGLE(Ae,fe.divisor)):(s.disableVertexAttribArray(Ae),s.vertexAttrib4f(Ae,fe.x,fe.y,fe.z,fe.w))}for(var K=B.length;K<X;++K)s.disableVertexAttribArray(K);var ce=I.getElements(this.elements);ce?s.bindBuffer(ja,ce.buffer.buffer):s.bindBuffer(ja,null)},_e.prototype.refresh=function(){var V=Q();V&&(V.bindVertexArrayOES(this.vao),this.bindAttrs(),oe.currentVAO=null,V.bindVertexArrayOES(null))},_e.prototype.destroy=function(){if(this.vao){var V=Q();this===oe.currentVAO&&(oe.currentVAO=null,V.bindVertexArrayOES(null)),V.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),J[this.id]&&(delete J[this.id],G.vaoCount-=1)};function pe(){var V=Q();V&&Sr(J).forEach(function(B){B.refresh()})}function Be(V){var B=new _e;G.vaoCount+=1;function Ae(fe){var K;if(Array.isArray(fe))K=fe,B.elements&&B.ownsElements&&B.elements.destroy(),B.elements=null,B.ownsElements=!1,B.offset=0,B.count=0,B.instances=-1,B.primitive=4;else{if(c(typeof fe=="object","invalid arguments for create vao"),c("attributes"in fe,"must specify attributes for vao"),fe.elements){var ce=fe.elements;B.ownsElements?typeof ce=="function"&&ce._reglType==="elements"?(B.elements.destroy(),B.ownsElements=!1):(B.elements(ce),B.ownsElements=!1):I.getElements(fe.elements)?(B.elements=fe.elements,B.ownsElements=!1):(B.elements=I.create(fe.elements),B.ownsElements=!0)}else B.elements=null,B.ownsElements=!1;K=fe.attributes,B.offset=0,B.count=-1,B.instances=-1,B.primitive=4,B.elements&&(B.count=B.elements._elements.vertCount,B.primitive=B.elements._elements.primType),"offset"in fe&&(B.offset=fe.offset|0),"count"in fe&&(B.count=fe.count|0),"instances"in fe&&(B.instances=fe.instances|0),"primitive"in fe&&(c(fe.primitive in xn,"bad primitive type: "+fe.primitive),B.primitive=xn[fe.primitive]),c.optional(()=>{for(var Dt=Object.keys(fe),Gt=0;Gt<Dt.length;++Gt)c(Vl.indexOf(Dt[Gt])>=0,'invalid option for vao: "'+Dt[Gt]+'" valid options are '+Vl)}),c(Array.isArray(K),"attributes must be an array")}c(K.length<X,"too many attributes"),c(K.length>0,"must specify at least one attribute");var he={},Ke=B.attributes;Ke.length=K.length;for(var ze=0;ze<K.length;++ze){var me=K[ze],ge=Ke[ze]=new mo,Ve=me.data||me;if(Array.isArray(Ve)||r(Ve)||kr(Ve)){var Ye;B.buffers[ze]&&(Ye=B.buffers[ze],r(Ve)&&Ye._buffer.byteLength>=Ve.byteLength?Ye.subdata(Ve):(Ye.destroy(),B.buffers[ze]=null)),B.buffers[ze]||(Ye=B.buffers[ze]=$.create(me,$l,!1,!0)),ge.buffer=$.getBuffer(Ye),ge.size=ge.buffer.dimension|0,ge.normalized=!1,ge.type=ge.buffer.dtype,ge.offset=0,ge.stride=0,ge.divisor=0,ge.state=1,he[ze]=1}else $.getBuffer(me)?(ge.buffer=$.getBuffer(me),ge.size=ge.buffer.dimension|0,ge.normalized=!1,ge.type=ge.buffer.dtype,ge.offset=0,ge.stride=0,ge.divisor=0,ge.state=1):$.getBuffer(me.buffer)?(ge.buffer=$.getBuffer(me.buffer),ge.size=(+me.size||ge.buffer.dimension)|0,ge.normalized=!!me.normalized||!1,"type"in me?(c.parameter(me.type,Un,"invalid buffer type"),ge.type=Un[me.type]):ge.type=ge.buffer.dtype,ge.offset=(me.offset||0)|0,ge.stride=(me.stride||0)|0,ge.divisor=(me.divisor||0)|0,ge.state=1,c(ge.size>=1&&ge.size<=4,"size must be between 1 and 4"),c(ge.offset>=0,"invalid offset"),c(ge.stride>=0&&ge.stride<=255,"stride must be between 0 and 255"),c(ge.divisor>=0,"divisor must be positive"),c(!ge.divisor||!!d.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in me?(c(ze>0,"first attribute must not be a constant"),ge.x=+me.x||0,ge.y=+me.y||0,ge.z=+me.z||0,ge.w=+me.w||0,ge.state=2):c(!1,"invalid attribute spec for location "+ze)}for(var it=0;it<B.buffers.length;++it)!he[it]&&B.buffers[it]&&(B.buffers[it].destroy(),B.buffers[it]=null);return B.refresh(),Ae}return Ae.destroy=function(){for(var fe=0;fe<B.buffers.length;++fe)B.buffers[fe]&&B.buffers[fe].destroy();B.buffers.length=0,B.ownsElements&&(B.elements.destroy(),B.elements=null,B.ownsElements=!1),B.destroy()},Ae._vao=B,Ae._reglType="vao",Ae(V)}return oe}var jl=35632,dm=35633,hm=35718,pm=35721;function mm(s,d,_,G){var $={},I={};function k(C,N,q,ye){this.name=C,this.id=N,this.location=q,this.info=ye}function X(C,N){for(var q=0;q<C.length;++q)if(C[q].id===N.id){C[q].location=N.location;return}C.push(N)}function W(C,N,q){var ye=C===jl?$:I,z=ye[N];if(!z){var _e=d.str(N);z=s.createShader(C),s.shaderSource(z,_e),s.compileShader(z),c.shaderError(s,z,_e,C,q),ye[N]=z}return z}var Z={},ee=[],J=0;function oe(C,N){this.id=J++,this.fragId=C,this.vertId=N,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,G.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Y(C,N,q){var ye,z,_e=W(jl,C.fragId),pe=W(dm,C.vertId),Be=C.program=s.createProgram();if(s.attachShader(Be,_e),s.attachShader(Be,pe),q)for(ye=0;ye<q.length;++ye){var V=q[ye];s.bindAttribLocation(Be,V[0],V[1])}s.linkProgram(Be),c.linkError(s,Be,d.str(C.fragId),d.str(C.vertId),N);var B=s.getProgramParameter(Be,hm);G.profile&&(C.stats.uniformsCount=B);var Ae=C.uniforms;for(ye=0;ye<B;++ye)if(z=s.getActiveUniform(Be,ye),z)if(z.size>1)for(var fe=0;fe<z.size;++fe){var K=z.name.replace("[0]","["+fe+"]");X(Ae,new k(K,d.id(K),s.getUniformLocation(Be,K),z))}else X(Ae,new k(z.name,d.id(z.name),s.getUniformLocation(Be,z.name),z));var ce=s.getProgramParameter(Be,pm);G.profile&&(C.stats.attributesCount=ce);var he=C.attributes;for(ye=0;ye<ce;++ye)z=s.getActiveAttrib(Be,ye),z&&X(he,new k(z.name,d.id(z.name),s.getAttribLocation(Be,z.name),z))}G.profile&&(_.getMaxUniformsCount=function(){var C=0;return ee.forEach(function(N){N.stats.uniformsCount>C&&(C=N.stats.uniformsCount)}),C},_.getMaxAttributesCount=function(){var C=0;return ee.forEach(function(N){N.stats.attributesCount>C&&(C=N.stats.attributesCount)}),C});function Q(){$={},I={};for(var C=0;C<ee.length;++C)Y(ee[C],null,ee[C].attributes.map(function(N){return[N.location,N.name]}))}return{clear:function(){var C=s.deleteShader.bind(s);Sr($).forEach(C),$={},Sr(I).forEach(C),I={},ee.forEach(function(N){s.deleteProgram(N.program)}),ee.length=0,Z={},_.shaderCount=0},program:function(C,N,q,ye){c.command(C>=0,"missing vertex shader",q),c.command(N>=0,"missing fragment shader",q);var z=Z[N];z||(z=Z[N]={});var _e=z[C];if(_e&&(_e.refCount++,!ye))return _e;var pe=new oe(N,C);return _.shaderCount++,Y(pe,q,ye),_e||(z[C]=pe),ee.push(pe),n(pe,{destroy:function(){if(pe.refCount--,pe.refCount<=0){s.deleteProgram(pe.program);var Be=ee.indexOf(pe);ee.splice(Be,1),_.shaderCount--}z[pe.vertId].refCount<=0&&(s.deleteShader(I[pe.vertId]),delete I[pe.vertId],delete Z[pe.fragId][pe.vertId]),Object.keys(Z[pe.fragId]).length||(s.deleteShader($[pe.fragId]),delete $[pe.fragId],delete Z[pe.fragId])}})},restore:Q,shader:W,frag:-1,vert:-1}}var vm=6408,Hi=5121,_m=3333,Ha=5126;function gm(s,d,_,G,$,I,k){function X(ee){var J;d.next===null?(c($.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),J=Hi):(c(d.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),J=d.next.colorAttachments[0].texture._texture.type,c.optional(function(){I.oes_texture_float?(c(J===Hi||J===Ha,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),J===Ha&&c(k.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):c(J===Hi,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var oe=0,Y=0,Q=G.framebufferWidth,C=G.framebufferHeight,N=null;r(ee)?N=ee:ee&&(c.type(ee,"object","invalid arguments to regl.read()"),oe=ee.x|0,Y=ee.y|0,c(oe>=0&&oe<G.framebufferWidth,"invalid x offset for regl.read"),c(Y>=0&&Y<G.framebufferHeight,"invalid y offset for regl.read"),Q=(ee.width||G.framebufferWidth-oe)|0,C=(ee.height||G.framebufferHeight-Y)|0,N=ee.data||null),N&&(J===Hi?c(N instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):J===Ha&&c(N instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),c(Q>0&&Q+oe<=G.framebufferWidth,"invalid width for read pixels"),c(C>0&&C+Y<=G.framebufferHeight,"invalid height for read pixels"),_();var q=Q*C*4;return N||(J===Hi?N=new Uint8Array(q):J===Ha&&(N=N||new Float32Array(q))),c.isTypedArray(N,"data buffer for regl.read() must be a typedarray"),c(N.byteLength>=q,"data buffer for regl.read() too small"),s.pixelStorei(_m,4),s.readPixels(oe,Y,Q,C,vm,J,N),N}function W(ee){var J;return d.setFBO({framebuffer:ee.framebuffer},function(){J=X(ee)}),J}function Z(ee){return!ee||!("framebuffer"in ee)?X(ee):W(ee)}return Z}function _i(s){return Array.prototype.slice.call(s)}function gi(s){return _i(s).join("")}function ym(){var s=0,d=[],_=[];function G(J){for(var oe=0;oe<_.length;++oe)if(_[oe]===J)return d[oe];var Y="g"+s++;return d.push(Y),_.push(J),Y}function $(){var J=[];function oe(){J.push.apply(J,_i(arguments))}var Y=[];function Q(){var C="v"+s++;return Y.push(C),arguments.length>0&&(J.push(C,"="),J.push.apply(J,_i(arguments)),J.push(";")),C}return n(oe,{def:Q,toString:function(){return gi([Y.length>0?"var "+Y.join(",")+";":"",gi(J)])}})}function I(){var J=$(),oe=$(),Y=J.toString,Q=oe.toString;function C(N,q){oe(N,q,"=",J.def(N,q),";")}return n(function(){J.apply(J,_i(arguments))},{def:J.def,entry:J,exit:oe,save:C,set:function(N,q,ye){C(N,q),J(N,q,"=",ye,";")},toString:function(){return Y()+Q()}})}function k(){var J=gi(arguments),oe=I(),Y=I(),Q=oe.toString,C=Y.toString;return n(oe,{then:function(){return oe.apply(oe,_i(arguments)),this},else:function(){return Y.apply(Y,_i(arguments)),this},toString:function(){var N=C();return N&&(N="else{"+N+"}"),gi(["if(",J,"){",Q(),"}",N])}})}var X=$(),W={};function Z(J,oe){var Y=[];function Q(){var z="a"+Y.length;return Y.push(z),z}oe=oe||0;for(var C=0;C<oe;++C)Q();var N=I(),q=N.toString,ye=W[J]=n(N,{arg:Q,toString:function(){return gi(["function(",Y.join(),"){",q(),"}"])}});return ye}function ee(){var J=['"use strict";',X,"return {"];Object.keys(W).forEach(function(Q){J.push('"',Q,'":',W[Q].toString(),",")}),J.push("}");var oe=gi(J).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Y=Function.apply(null,d.concat(oe));return Y.apply(null,_)}return{global:X,link:G,block:$,proc:Z,scope:I,cond:k,compile:ee}}var yi="xyzw".split(""),Hl=5121,bi=1,vo=2,_o=0,go=1,yo=2,bo=3,za=4,zl=5,Wl=6,Xl="dither",Yl="blend.enable",Kl="blend.color",xo="blend.equation",Eo="blend.func",ql="depth.enable",Ql="depth.func",Zl="depth.range",Jl="depth.mask",To="colorMask",ec="cull.enable",tc="cull.face",Ao="frontFace",wo="lineWidth",rc="polygonOffset.enable",So="polygonOffset.offset",nc="sample.alpha",ic="sample.enable",Co="sample.coverage",ac="stencil.enable",sc="stencil.mask",Lo="stencil.func",Ro="stencil.opFront",zi="stencil.opBack",oc="scissor.enable",Wa="scissor.box",on="viewport",Wi="profile",zn="framebuffer",Xi="vert",Yi="frag",Wn="elements",Xn="primitive",Yn="count",Xa="offset",Ya="instances",Ki="vao",Oo="Width",Fo="Height",xi=zn+Oo,Ei=zn+Fo,bm=on+Oo,xm=on+Fo,fc="drawingBuffer",lc=fc+Oo,cc=fc+Fo,Em=[Eo,xo,Lo,Ro,zi,Co,on,Wa,So],Ti=34962,Po=34963,Tm=35632,Am=35633,uc=3553,wm=34067,Sm=2884,Cm=3042,Lm=3024,Rm=2960,Om=2929,Fm=3089,Pm=32823,Dm=32926,Im=32928,Do=5126,Ka=35664,qa=35665,Qa=35666,Io=5124,Za=35667,Ja=35668,es=35669,Go=35670,ts=35671,rs=35672,ns=35673,qi=35674,Qi=35675,Zi=35676,Ji=35678,ea=35680,Mo=4,ta=1028,Kn=1029,dc=2304,No=2305,Gm=32775,Mm=32776,Nm=519,Tn=7680,hc=0,pc=1,mc=32774,km=513,vc=36160,Bm=36064,Wr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},_c=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ai={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},An={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},gc={frag:Tm,vert:Am},ko={cw:dc,ccw:No};function is(s){return Array.isArray(s)||r(s)||kr(s)}function yc(s){return s.sort(function(d,_){return d===on?-1:_===on?1:d<_?-1:1})}function Kt(s,d,_,G){this.thisDep=s,this.contextDep=d,this.propDep=_,this.append=G}function wn(s){return s&&!(s.thisDep||s.contextDep||s.propDep)}function Ut(s){return new Kt(!1,!1,!1,s)}function yr(s,d){var _=s.type;if(_===_o){var G=s.data.length;return new Kt(!0,G>=1,G>=2,d)}else if(_===za){var $=s.data;return new Kt($.thisDep,$.contextDep,$.propDep,d)}else{if(_===zl)return new Kt(!1,!1,!1,d);if(_===Wl){for(var I=!1,k=!1,X=!1,W=0;W<s.data.length;++W){var Z=s.data[W];if(Z.type===go)X=!0;else if(Z.type===yo)k=!0;else if(Z.type===bo)I=!0;else if(Z.type===_o){I=!0;var ee=Z.data;ee>=1&&(k=!0),ee>=2&&(X=!0)}else Z.type===za&&(I=I||Z.data.thisDep,k=k||Z.data.contextDep,X=X||Z.data.propDep)}return new Kt(I,k,X,d)}else return new Kt(_===bo,_===yo,_===go,d)}}var bc=new Kt(!1,!1,!1,function(){});function Um(s,d,_,G,$,I,k,X,W,Z,ee,J,oe,Y,Q){var C=Z.Record,N={add:32774,subtract:32778,"reverse subtract":32779};_.ext_blend_minmax&&(N.min=Gm,N.max=Mm);var q=_.angle_instanced_arrays,ye=_.webgl_draw_buffers,z=_.oes_vertex_array_object,_e={dirty:!0,profile:Q.profile},pe={},Be=[],V={},B={};function Ae(p){return p.replace(".","_")}function fe(p,u,x){var S=Ae(p);Be.push(p),pe[S]=_e[S]=!!x,V[S]=u}function K(p,u,x){var S=Ae(p);Be.push(p),Array.isArray(x)?(_e[S]=x.slice(),pe[S]=x.slice()):_e[S]=pe[S]=x,B[S]=u}fe(Xl,Lm),fe(Yl,Cm),K(Kl,"blendColor",[0,0,0,0]),K(xo,"blendEquationSeparate",[mc,mc]),K(Eo,"blendFuncSeparate",[pc,hc,pc,hc]),fe(ql,Om,!0),K(Ql,"depthFunc",km),K(Zl,"depthRange",[0,1]),K(Jl,"depthMask",!0),K(To,To,[!0,!0,!0,!0]),fe(ec,Sm),K(tc,"cullFace",Kn),K(Ao,Ao,No),K(wo,wo,1),fe(rc,Pm),K(So,"polygonOffset",[0,0]),fe(nc,Dm),fe(ic,Im),K(Co,"sampleCoverage",[1,!1]),fe(ac,Rm),K(sc,"stencilMask",-1),K(Lo,"stencilFunc",[Nm,0,-1]),K(Ro,"stencilOpSeparate",[ta,Tn,Tn,Tn]),K(zi,"stencilOpSeparate",[Kn,Tn,Tn,Tn]),fe(oc,Fm),K(Wa,"scissor",[0,0,s.drawingBufferWidth,s.drawingBufferHeight]),K(on,on,[0,0,s.drawingBufferWidth,s.drawingBufferHeight]);var ce={gl:s,context:oe,strings:d,next:pe,current:_e,draw:J,elements:I,buffer:$,shader:ee,attributes:Z.state,vao:Z,uniforms:W,framebuffer:X,extensions:_,timer:Y,isBufferArgs:is},he={primTypes:xn,compareFuncs:Ai,blendFuncs:Wr,blendEquations:N,stencilOps:An,glTypes:Un,orientationType:ko};c.optional(function(){ce.isArrayLike=Mt}),ye&&(he.backBuffer=[Kn],he.drawBuffer=wr(G.maxDrawbuffers,function(p){return p===0?[0]:wr(p,function(u){return Bm+u})}));var Ke=0;function ze(){var p=ym(),u=p.link,x=p.global;p.id=Ke++,p.batchId="0";var S=u(ce),O=p.shared={props:"a0"};Object.keys(ce).forEach(function(b){O[b]=x.def(S,".",b)}),c.optional(function(){p.CHECK=u(c),p.commandStr=c.guessCommand(),p.command=u(p.commandStr),p.assert=function(b,m,L){b("if(!(",m,"))",this.CHECK,".commandRaise(",u(L),",",this.command,");")},he.invalidBlendCombinations=_c});var T=p.next={},E=p.current={};Object.keys(B).forEach(function(b){Array.isArray(_e[b])&&(T[b]=x.def(O.next,".",b),E[b]=x.def(O.current,".",b))});var w=p.constants={};Object.keys(he).forEach(function(b){w[b]=x.def(JSON.stringify(he[b]))}),p.invoke=function(b,m){switch(m.type){case _o:var L=["this",O.context,O.props,p.batchId];return b.def(u(m.data),".call(",L.slice(0,Math.max(m.data.length+1,4)),")");case go:return b.def(O.props,m.data);case yo:return b.def(O.context,m.data);case bo:return b.def("this",m.data);case za:return m.data.append(p,b),m.data.ref;case zl:return m.data.toString();case Wl:return m.data.map(function(F){return p.invoke(b,F)})}},p.attribCache={};var h={};return p.scopeAttrib=function(b){var m=d.id(b);if(m in h)return h[m];var L=Z.scope[m];L||(L=Z.scope[m]=new C);var F=h[m]=u(L);return F},p}function me(p){var u=p.static,x=p.dynamic,S;if(Wi in u){var O=!!u[Wi];S=Ut(function(E,w){return O}),S.enable=O}else if(Wi in x){var T=x[Wi];S=yr(T,function(E,w){return E.invoke(w,T)})}return S}function ge(p,u){var x=p.static,S=p.dynamic;if(zn in x){var O=x[zn];return O?(O=X.getFramebuffer(O),c.command(O,"invalid framebuffer object"),Ut(function(E,w){var h=E.link(O),b=E.shared;w.set(b.framebuffer,".next",h);var m=b.context;return w.set(m,"."+xi,h+".width"),w.set(m,"."+Ei,h+".height"),h})):Ut(function(E,w){var h=E.shared;w.set(h.framebuffer,".next","null");var b=h.context;return w.set(b,"."+xi,b+"."+lc),w.set(b,"."+Ei,b+"."+cc),"null"})}else if(zn in S){var T=S[zn];return yr(T,function(E,w){var h=E.invoke(w,T),b=E.shared,m=b.framebuffer,L=w.def(m,".getFramebuffer(",h,")");c.optional(function(){E.assert(w,"!"+h+"||"+L,"invalid framebuffer object")}),w.set(m,".next",L);var F=b.context;return w.set(F,"."+xi,L+"?"+L+".width:"+F+"."+lc),w.set(F,"."+Ei,L+"?"+L+".height:"+F+"."+cc),L})}else return null}function Ve(p,u,x){var S=p.static,O=p.dynamic;function T(h){if(h in S){var b=S[h];c.commandType(b,"object","invalid "+h,x.commandStr);var m=!0,L=b.x|0,F=b.y|0,j,ae;return"width"in b?(j=b.width|0,c.command(j>=0,"invalid "+h,x.commandStr)):m=!1,"height"in b?(ae=b.height|0,c.command(ae>=0,"invalid "+h,x.commandStr)):m=!1,new Kt(!m&&u&&u.thisDep,!m&&u&&u.contextDep,!m&&u&&u.propDep,function(ne,Le){var xe=ne.shared.context,we=j;"width"in b||(we=Le.def(xe,".",xi,"-",L));var Ce=ae;return"height"in b||(Ce=Le.def(xe,".",Ei,"-",F)),[L,F,we,Ce]})}else if(h in O){var se=O[h],ve=yr(se,function(ne,Le){var xe=ne.invoke(Le,se);c.optional(function(){ne.assert(Le,xe+"&&typeof "+xe+'==="object"',"invalid "+h)});var we=ne.shared.context,Ce=Le.def(xe,".x|0"),Re=Le.def(xe,".y|0"),je=Le.def('"width" in ',xe,"?",xe,".width|0:","(",we,".",xi,"-",Ce,")"),Tt=Le.def('"height" in ',xe,"?",xe,".height|0:","(",we,".",Ei,"-",Re,")");return c.optional(function(){ne.assert(Le,je+">=0&&"+Tt+">=0","invalid "+h)}),[Ce,Re,je,Tt]});return u&&(ve.thisDep=ve.thisDep||u.thisDep,ve.contextDep=ve.contextDep||u.contextDep,ve.propDep=ve.propDep||u.propDep),ve}else return u?new Kt(u.thisDep,u.contextDep,u.propDep,function(ne,Le){var xe=ne.shared.context;return[0,0,Le.def(xe,".",xi),Le.def(xe,".",Ei)]}):null}var E=T(on);if(E){var w=E;E=new Kt(E.thisDep,E.contextDep,E.propDep,function(h,b){var m=w.append(h,b),L=h.shared.context;return b.set(L,"."+bm,m[2]),b.set(L,"."+xm,m[3]),m})}return{viewport:E,scissor_box:T(Wa)}}function Ye(p,u){var x=p.static,S=typeof x[Yi]=="string"&&typeof x[Xi]=="string";if(S){if(Object.keys(u.dynamic).length>0)return null;var O=u.static,T=Object.keys(O);if(T.length>0&&typeof O[T[0]]=="number"){for(var E=[],w=0;w<T.length;++w)c(typeof O[T[w]]=="number","must specify all vertex attribute locations when using vaos"),E.push([O[T[w]]|0,T[w]]);return E}}return null}function it(p,u,x){var S=p.static,O=p.dynamic;function T(m){if(m in S){var L=d.id(S[m]);c.optional(function(){ee.shader(gc[m],L,c.guessCommand())});var F=Ut(function(){return L});return F.id=L,F}else if(m in O){var j=O[m];return yr(j,function(ae,se){var ve=ae.invoke(se,j),ne=se.def(ae.shared.strings,".id(",ve,")");return c.optional(function(){se(ae.shared.shader,".shader(",gc[m],",",ne,",",ae.command,");")}),ne})}return null}var E=T(Yi),w=T(Xi),h=null,b;return wn(E)&&wn(w)?(h=ee.program(w.id,E.id,null,x),b=Ut(function(m,L){return m.link(h)})):b=new Kt(E&&E.thisDep||w&&w.thisDep,E&&E.contextDep||w&&w.contextDep,E&&E.propDep||w&&w.propDep,function(m,L){var F=m.shared.shader,j;E?j=E.append(m,L):j=L.def(F,".",Yi);var ae;w?ae=w.append(m,L):ae=L.def(F,".",Xi);var se=F+".program("+ae+","+j;return c.optional(function(){se+=","+m.command}),L.def(se+")")}),{frag:E,vert:w,progVar:b,program:h}}function Dt(p,u){var x=p.static,S=p.dynamic,O={},T=!1;function E(){if(Ki in x){var Le=x[Ki];return Le!==null&&Z.getVAO(Le)===null&&(Le=Z.createVAO(Le)),T=!0,O.vao=Le,Ut(function(we){var Ce=Z.getVAO(Le);return Ce?we.link(Ce):"null"})}else if(Ki in S){T=!0;var xe=S[Ki];return yr(xe,function(we,Ce){var Re=we.invoke(Ce,xe);return Ce.def(we.shared.vao+".getVAO("+Re+")")})}return null}var w=E(),h=!1;function b(){if(Wn in x){var Le=x[Wn];if(O.elements=Le,is(Le)){var xe=O.elements=I.create(Le,!0);Le=I.getElements(xe),h=!0}else Le&&(Le=I.getElements(Le),h=!0,c.command(Le,"invalid elements",u.commandStr));var we=Ut(function(Re,je){if(Le){var Tt=Re.link(Le);return Re.ELEMENTS=Tt,Tt}return Re.ELEMENTS=null,null});return we.value=Le,we}else if(Wn in S){h=!0;var Ce=S[Wn];return yr(Ce,function(Re,je){var Tt=Re.shared,Jt=Tt.isBufferArgs,fn=Tt.elements,ln=Re.invoke(je,Ce),cn=je.def("null"),or=je.def(Jt,"(",ln,")"),Yr=Re.cond(or).then(cn,"=",fn,".createStream(",ln,");").else(cn,"=",fn,".getElements(",ln,");");return c.optional(function(){Re.assert(Yr.else,"!"+ln+"||"+cn,"invalid elements")}),je.entry(Yr),je.exit(Re.cond(or).then(fn,".destroyStream(",cn,");")),Re.ELEMENTS=cn,cn})}else if(T)return new Kt(w.thisDep,w.contextDep,w.propDep,function(Re,je){return je.def(Re.shared.vao+".currentVAO?"+Re.shared.elements+".getElements("+Re.shared.vao+".currentVAO.elements):null")});return null}var m=b();function L(){if(Xn in x){var Le=x[Xn];return O.primitive=Le,c.commandParameter(Le,xn,"invalid primitve",u.commandStr),Ut(function(we,Ce){return xn[Le]})}else if(Xn in S){var xe=S[Xn];return yr(xe,function(we,Ce){var Re=we.constants.primTypes,je=we.invoke(Ce,xe);return c.optional(function(){we.assert(Ce,je+" in "+Re,"invalid primitive, must be one of "+Object.keys(xn))}),Ce.def(Re,"[",je,"]")})}else{if(h)return wn(m)?m.value?Ut(function(we,Ce){return Ce.def(we.ELEMENTS,".primType")}):Ut(function(){return Mo}):new Kt(m.thisDep,m.contextDep,m.propDep,function(we,Ce){var Re=we.ELEMENTS;return Ce.def(Re,"?",Re,".primType:",Mo)});if(T)return new Kt(w.thisDep,w.contextDep,w.propDep,function(we,Ce){return Ce.def(we.shared.vao+".currentVAO?"+we.shared.vao+".currentVAO.primitive:"+Mo)})}return null}function F(Le,xe){if(Le in x){var we=x[Le]|0;return xe?O.offset=we:O.instances=we,c.command(!xe||we>=0,"invalid "+Le,u.commandStr),Ut(function(Re,je){return xe&&(Re.OFFSET=we),we})}else if(Le in S){var Ce=S[Le];return yr(Ce,function(Re,je){var Tt=Re.invoke(je,Ce);return xe&&(Re.OFFSET=Tt,c.optional(function(){Re.assert(je,Tt+">=0","invalid "+Le)})),Tt})}else if(xe){if(h)return Ut(function(Re,je){return Re.OFFSET=0,0});if(T)return new Kt(w.thisDep,w.contextDep,w.propDep,function(Re,je){return je.def(Re.shared.vao+".currentVAO?"+Re.shared.vao+".currentVAO.offset:0")})}else if(T)return new Kt(w.thisDep,w.contextDep,w.propDep,function(Re,je){return je.def(Re.shared.vao+".currentVAO?"+Re.shared.vao+".currentVAO.instances:-1")});return null}var j=F(Xa,!0);function ae(){if(Yn in x){var Le=x[Yn]|0;return O.count=Le,c.command(typeof Le=="number"&&Le>=0,"invalid vertex count",u.commandStr),Ut(function(){return Le})}else if(Yn in S){var xe=S[Yn];return yr(xe,function(je,Tt){var Jt=je.invoke(Tt,xe);return c.optional(function(){je.assert(Tt,"typeof "+Jt+'==="number"&&'+Jt+">=0&&"+Jt+"===("+Jt+"|0)","invalid vertex count")}),Jt})}else if(h)if(wn(m)){if(m)return j?new Kt(j.thisDep,j.contextDep,j.propDep,function(je,Tt){var Jt=Tt.def(je.ELEMENTS,".vertCount-",je.OFFSET);return c.optional(function(){je.assert(Tt,Jt+">=0","invalid vertex offset/element buffer too small")}),Jt}):Ut(function(je,Tt){return Tt.def(je.ELEMENTS,".vertCount")});var we=Ut(function(){return-1});return c.optional(function(){we.MISSING=!0}),we}else{var Ce=new Kt(m.thisDep||j.thisDep,m.contextDep||j.contextDep,m.propDep||j.propDep,function(je,Tt){var Jt=je.ELEMENTS;return je.OFFSET?Tt.def(Jt,"?",Jt,".vertCount-",je.OFFSET,":-1"):Tt.def(Jt,"?",Jt,".vertCount:-1")});return c.optional(function(){Ce.DYNAMIC=!0}),Ce}else if(T){var Re=new Kt(w.thisDep,w.contextDep,w.propDep,function(je,Tt){return Tt.def(je.shared.vao,".currentVAO?",je.shared.vao,".currentVAO.count:-1")});return Re}return null}var se=L(),ve=ae(),ne=F(Ya,!1);return{elements:m,primitive:se,count:ve,instances:ne,offset:j,vao:w,vaoActive:T,elementsActive:h,static:O}}function Gt(p,u){var x=p.static,S=p.dynamic,O={};return Be.forEach(function(T){var E=Ae(T);function w(h,b){if(T in x){var m=h(x[T]);O[E]=Ut(function(){return m})}else if(T in S){var L=S[T];O[E]=yr(L,function(F,j){return b(F,j,F.invoke(j,L))})}}switch(T){case ec:case Yl:case Xl:case ac:case ql:case oc:case rc:case nc:case ic:case Jl:return w(function(h){return c.commandType(h,"boolean",T,u.commandStr),h},function(h,b,m){return c.optional(function(){h.assert(b,"typeof "+m+'==="boolean"',"invalid flag "+T,h.commandStr)}),m});case Ql:return w(function(h){return c.commandParameter(h,Ai,"invalid "+T,u.commandStr),Ai[h]},function(h,b,m){var L=h.constants.compareFuncs;return c.optional(function(){h.assert(b,m+" in "+L,"invalid "+T+", must be one of "+Object.keys(Ai))}),b.def(L,"[",m,"]")});case Zl:return w(function(h){return c.command(Mt(h)&&h.length===2&&typeof h[0]=="number"&&typeof h[1]=="number"&&h[0]<=h[1],"depth range is 2d array",u.commandStr),h},function(h,b,m){c.optional(function(){h.assert(b,h.shared.isArrayLike+"("+m+")&&"+m+".length===2&&typeof "+m+'[0]==="number"&&typeof '+m+'[1]==="number"&&'+m+"[0]<="+m+"[1]","depth range must be a 2d array")});var L=b.def("+",m,"[0]"),F=b.def("+",m,"[1]");return[L,F]});case Eo:return w(function(h){c.commandType(h,"object","blend.func",u.commandStr);var b="srcRGB"in h?h.srcRGB:h.src,m="srcAlpha"in h?h.srcAlpha:h.src,L="dstRGB"in h?h.dstRGB:h.dst,F="dstAlpha"in h?h.dstAlpha:h.dst;return c.commandParameter(b,Wr,E+".srcRGB",u.commandStr),c.commandParameter(m,Wr,E+".srcAlpha",u.commandStr),c.commandParameter(L,Wr,E+".dstRGB",u.commandStr),c.commandParameter(F,Wr,E+".dstAlpha",u.commandStr),c.command(_c.indexOf(b+", "+L)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+b+", "+L+")",u.commandStr),[Wr[b],Wr[L],Wr[m],Wr[F]]},function(h,b,m){var L=h.constants.blendFuncs;c.optional(function(){h.assert(b,m+"&&typeof "+m+'==="object"',"invalid blend func, must be an object")});function F(xe,we){var Ce=b.def('"',xe,we,'" in ',m,"?",m,".",xe,we,":",m,".",xe);return c.optional(function(){h.assert(b,Ce+" in "+L,"invalid "+T+"."+xe+we+", must be one of "+Object.keys(Wr))}),Ce}var j=F("src","RGB"),ae=F("dst","RGB");c.optional(function(){var xe=h.constants.invalidBlendCombinations;h.assert(b,xe+".indexOf("+j+'+", "+'+ae+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var se=b.def(L,"[",j,"]"),ve=b.def(L,"[",F("src","Alpha"),"]"),ne=b.def(L,"[",ae,"]"),Le=b.def(L,"[",F("dst","Alpha"),"]");return[se,ne,ve,Le]});case xo:return w(function(h){if(typeof h=="string")return c.commandParameter(h,N,"invalid "+T,u.commandStr),[N[h],N[h]];if(typeof h=="object")return c.commandParameter(h.rgb,N,T+".rgb",u.commandStr),c.commandParameter(h.alpha,N,T+".alpha",u.commandStr),[N[h.rgb],N[h.alpha]];c.commandRaise("invalid blend.equation",u.commandStr)},function(h,b,m){var L=h.constants.blendEquations,F=b.def(),j=b.def(),ae=h.cond("typeof ",m,'==="string"');return c.optional(function(){function se(ve,ne,Le){h.assert(ve,Le+" in "+L,"invalid "+ne+", must be one of "+Object.keys(N))}se(ae.then,T,m),h.assert(ae.else,m+"&&typeof "+m+'==="object"',"invalid "+T),se(ae.else,T+".rgb",m+".rgb"),se(ae.else,T+".alpha",m+".alpha")}),ae.then(F,"=",j,"=",L,"[",m,"];"),ae.else(F,"=",L,"[",m,".rgb];",j,"=",L,"[",m,".alpha];"),b(ae),[F,j]});case Kl:return w(function(h){return c.command(Mt(h)&&h.length===4,"blend.color must be a 4d array",u.commandStr),wr(4,function(b){return+h[b]})},function(h,b,m){return c.optional(function(){h.assert(b,h.shared.isArrayLike+"("+m+")&&"+m+".length===4","blend.color must be a 4d array")}),wr(4,function(L){return b.def("+",m,"[",L,"]")})});case sc:return w(function(h){return c.commandType(h,"number",E,u.commandStr),h|0},function(h,b,m){return c.optional(function(){h.assert(b,"typeof "+m+'==="number"',"invalid stencil.mask")}),b.def(m,"|0")});case Lo:return w(function(h){c.commandType(h,"object",E,u.commandStr);var b=h.cmp||"keep",m=h.ref||0,L="mask"in h?h.mask:-1;return c.commandParameter(b,Ai,T+".cmp",u.commandStr),c.commandType(m,"number",T+".ref",u.commandStr),c.commandType(L,"number",T+".mask",u.commandStr),[Ai[b],m,L]},function(h,b,m){var L=h.constants.compareFuncs;c.optional(function(){function se(){h.assert(b,Array.prototype.join.call(arguments,""),"invalid stencil.func")}se(m+"&&typeof ",m,'==="object"'),se('!("cmp" in ',m,")||(",m,".cmp in ",L,")")});var F=b.def('"cmp" in ',m,"?",L,"[",m,".cmp]",":",Tn),j=b.def(m,".ref|0"),ae=b.def('"mask" in ',m,"?",m,".mask|0:-1");return[F,j,ae]});case Ro:case zi:return w(function(h){c.commandType(h,"object",E,u.commandStr);var b=h.fail||"keep",m=h.zfail||"keep",L=h.zpass||"keep";return c.commandParameter(b,An,T+".fail",u.commandStr),c.commandParameter(m,An,T+".zfail",u.commandStr),c.commandParameter(L,An,T+".zpass",u.commandStr),[T===zi?Kn:ta,An[b],An[m],An[L]]},function(h,b,m){var L=h.constants.stencilOps;c.optional(function(){h.assert(b,m+"&&typeof "+m+'==="object"',"invalid "+T)});function F(j){return c.optional(function(){h.assert(b,'!("'+j+'" in '+m+")||("+m+"."+j+" in "+L+")","invalid "+T+"."+j+", must be one of "+Object.keys(An))}),b.def('"',j,'" in ',m,"?",L,"[",m,".",j,"]:",Tn)}return[T===zi?Kn:ta,F("fail"),F("zfail"),F("zpass")]});case So:return w(function(h){c.commandType(h,"object",E,u.commandStr);var b=h.factor|0,m=h.units|0;return c.commandType(b,"number",E+".factor",u.commandStr),c.commandType(m,"number",E+".units",u.commandStr),[b,m]},function(h,b,m){c.optional(function(){h.assert(b,m+"&&typeof "+m+'==="object"',"invalid "+T)});var L=b.def(m,".factor|0"),F=b.def(m,".units|0");return[L,F]});case tc:return w(function(h){var b=0;return h==="front"?b=ta:h==="back"&&(b=Kn),c.command(!!b,E,u.commandStr),b},function(h,b,m){return c.optional(function(){h.assert(b,m+'==="front"||'+m+'==="back"',"invalid cull.face")}),b.def(m,'==="front"?',ta,":",Kn)});case wo:return w(function(h){return c.command(typeof h=="number"&&h>=G.lineWidthDims[0]&&h<=G.lineWidthDims[1],"invalid line width, must be a positive number between "+G.lineWidthDims[0]+" and "+G.lineWidthDims[1],u.commandStr),h},function(h,b,m){return c.optional(function(){h.assert(b,"typeof "+m+'==="number"&&'+m+">="+G.lineWidthDims[0]+"&&"+m+"<="+G.lineWidthDims[1],"invalid line width")}),m});case Ao:return w(function(h){return c.commandParameter(h,ko,E,u.commandStr),ko[h]},function(h,b,m){return c.optional(function(){h.assert(b,m+'==="cw"||'+m+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),b.def(m+'==="cw"?'+dc+":"+No)});case To:return w(function(h){return c.command(Mt(h)&&h.length===4,"color.mask must be length 4 array",u.commandStr),h.map(function(b){return!!b})},function(h,b,m){return c.optional(function(){h.assert(b,h.shared.isArrayLike+"("+m+")&&"+m+".length===4","invalid color.mask")}),wr(4,function(L){return"!!"+m+"["+L+"]"})});case Co:return w(function(h){c.command(typeof h=="object"&&h,E,u.commandStr);var b="value"in h?h.value:1,m=!!h.invert;return c.command(typeof b=="number"&&b>=0&&b<=1,"sample.coverage.value must be a number between 0 and 1",u.commandStr),[b,m]},function(h,b,m){c.optional(function(){h.assert(b,m+"&&typeof "+m+'==="object"',"invalid sample.coverage")});var L=b.def('"value" in ',m,"?+",m,".value:1"),F=b.def("!!",m,".invert");return[L,F]})}}),O}function st(p,u){var x=p.static,S=p.dynamic,O={};return Object.keys(x).forEach(function(T){var E=x[T],w;if(typeof E=="number"||typeof E=="boolean")w=Ut(function(){return E});else if(typeof E=="function"){var h=E._reglType;h==="texture2d"||h==="textureCube"?w=Ut(function(b){return b.link(E)}):h==="framebuffer"||h==="framebufferCube"?(c.command(E.color.length>0,'missing color attachment for framebuffer sent to uniform "'+T+'"',u.commandStr),w=Ut(function(b){return b.link(E.color[0])})):c.commandRaise('invalid data for uniform "'+T+'"',u.commandStr)}else Mt(E)?w=Ut(function(b){var m=b.global.def("[",wr(E.length,function(L){return c.command(typeof E[L]=="number"||typeof E[L]=="boolean","invalid uniform "+T,b.commandStr),E[L]}),"]");return m}):c.commandRaise('invalid or missing data for uniform "'+T+'"',u.commandStr);w.value=E,O[T]=w}),Object.keys(S).forEach(function(T){var E=S[T];O[T]=yr(E,function(w,h){return w.invoke(h,E)})}),O}function jt(p,u){var x=p.static,S=p.dynamic,O={};return Object.keys(x).forEach(function(T){var E=x[T],w=d.id(T),h=new C;if(is(E))h.state=bi,h.buffer=$.getBuffer($.create(E,Ti,!1,!0)),h.type=0;else{var b=$.getBuffer(E);if(b)h.state=bi,h.buffer=b,h.type=0;else if(c.command(typeof E=="object"&&E,"invalid data for attribute "+T,u.commandStr),"constant"in E){var m=E.constant;h.buffer="null",h.state=vo,typeof m=="number"?h.x=m:(c.command(Mt(m)&&m.length>0&&m.length<=4,"invalid constant for attribute "+T,u.commandStr),yi.forEach(function(ne,Le){Le<m.length&&(h[ne]=m[Le])}))}else{is(E.buffer)?b=$.getBuffer($.create(E.buffer,Ti,!1,!0)):b=$.getBuffer(E.buffer),c.command(!!b,'missing buffer for attribute "'+T+'"',u.commandStr);var L=E.offset|0;c.command(L>=0,'invalid offset for attribute "'+T+'"',u.commandStr);var F=E.stride|0;c.command(F>=0&&F<256,'invalid stride for attribute "'+T+'", must be integer betweeen [0, 255]',u.commandStr);var j=E.size|0;c.command(!("size"in E)||j>0&&j<=4,'invalid size for attribute "'+T+'", must be 1,2,3,4',u.commandStr);var ae=!!E.normalized,se=0;"type"in E&&(c.commandParameter(E.type,Un,"invalid type for attribute "+T,u.commandStr),se=Un[E.type]);var ve=E.divisor|0;c.optional(function(){"divisor"in E&&(c.command(ve===0||q,'cannot specify divisor for attribute "'+T+'", instancing not supported',u.commandStr),c.command(ve>=0,'invalid divisor for attribute "'+T+'"',u.commandStr));var ne=u.commandStr,Le=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(E).forEach(function(xe){c.command(Le.indexOf(xe)>=0,'unknown parameter "'+xe+'" for attribute pointer "'+T+'" (valid parameters are '+Le+")",ne)})}),h.buffer=b,h.state=bi,h.size=j,h.normalized=ae,h.type=se||b.dtype,h.offset=L,h.stride=F,h.divisor=ve}}O[T]=Ut(function(ne,Le){var xe=ne.attribCache;if(w in xe)return xe[w];var we={isStream:!1};return Object.keys(h).forEach(function(Ce){we[Ce]=h[Ce]}),h.buffer&&(we.buffer=ne.link(h.buffer),we.type=we.type||we.buffer+".dtype"),xe[w]=we,we})}),Object.keys(S).forEach(function(T){var E=S[T];function w(h,b){var m=h.invoke(b,E),L=h.shared,F=h.constants,j=L.isBufferArgs,ae=L.buffer;c.optional(function(){h.assert(b,m+"&&(typeof "+m+'==="object"||typeof '+m+'==="function")&&('+j+"("+m+")||"+ae+".getBuffer("+m+")||"+ae+".getBuffer("+m+".buffer)||"+j+"("+m+'.buffer)||("constant" in '+m+"&&(typeof "+m+'.constant==="number"||'+L.isArrayLike+"("+m+".constant))))",'invalid dynamic attribute "'+T+'"')});var se={isStream:b.def(!1)},ve=new C;ve.state=bi,Object.keys(ve).forEach(function(we){se[we]=b.def(""+ve[we])});var ne=se.buffer,Le=se.type;b("if(",j,"(",m,")){",se.isStream,"=true;",ne,"=",ae,".createStream(",Ti,",",m,");",Le,"=",ne,".dtype;","}else{",ne,"=",ae,".getBuffer(",m,");","if(",ne,"){",Le,"=",ne,".dtype;",'}else if("constant" in ',m,"){",se.state,"=",vo,";","if(typeof "+m+'.constant === "number"){',se[yi[0]],"=",m,".constant;",yi.slice(1).map(function(we){return se[we]}).join("="),"=0;","}else{",yi.map(function(we,Ce){return se[we]+"="+m+".constant.length>"+Ce+"?"+m+".constant["+Ce+"]:0;"}).join(""),"}}else{","if(",j,"(",m,".buffer)){",ne,"=",ae,".createStream(",Ti,",",m,".buffer);","}else{",ne,"=",ae,".getBuffer(",m,".buffer);","}",Le,'="type" in ',m,"?",F.glTypes,"[",m,".type]:",ne,".dtype;",se.normalized,"=!!",m,".normalized;");function xe(we){b(se[we],"=",m,".",we,"|0;")}return xe("size"),xe("offset"),xe("stride"),xe("divisor"),b("}}"),b.exit("if(",se.isStream,"){",ae,".destroyStream(",ne,");","}"),se}O[T]=yr(E,w)}),O}function Lt(p){var u=p.static,x=p.dynamic,S={};return Object.keys(u).forEach(function(O){var T=u[O];S[O]=Ut(function(E,w){return typeof T=="number"||typeof T=="boolean"?""+T:E.link(T)})}),Object.keys(x).forEach(function(O){var T=x[O];S[O]=yr(T,function(E,w){return E.invoke(w,T)})}),S}function $t(p,u,x,S,O){var T=p.static,E=p.dynamic;c.optional(function(){var xe=[zn,Xi,Yi,Wn,Xn,Xa,Yn,Ya,Wi,Ki].concat(Be);function we(Ce){Object.keys(Ce).forEach(function(Re){c.command(xe.indexOf(Re)>=0,'unknown parameter "'+Re+'"',O.commandStr)})}we(T),we(E)});var w=Ye(p,u),h=ge(p),b=Ve(p,h,O),m=Dt(p,O),L=Gt(p,O),F=it(p,O,w);function j(xe){var we=b[xe];we&&(L[xe]=we)}j(on),j(Ae(Wa));var ae=Object.keys(L).length>0,se={framebuffer:h,draw:m,shader:F,state:L,dirty:ae,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(se.profile=me(p),se.uniforms=st(x,O),se.drawVAO=se.scopeVAO=m.vao,!se.drawVAO&&F.program&&!w&&_.angle_instanced_arrays&&m.static.elements){var ve=!0,ne=F.program.attributes.map(function(xe){var we=u.static[xe];return ve=ve&&!!we,we});if(ve&&ne.length>0){var Le=Z.getVAO(Z.createVAO({attributes:ne,elements:m.static.elements}));se.drawVAO=new Kt(null,null,null,function(xe,we){return xe.link(Le)}),se.useVAO=!0}}return w?se.useVAO=!0:se.attributes=jt(u,O),se.context=Lt(S),se}function Ht(p,u,x){var S=p.shared,O=S.context,T=p.scope();Object.keys(x).forEach(function(E){u.save(O,"."+E);var w=x[E],h=w.append(p,u);Array.isArray(h)?T(O,".",E,"=[",h.join(),"];"):T(O,".",E,"=",h,";")}),u(T)}function zt(p,u,x,S){var O=p.shared,T=O.gl,E=O.framebuffer,w;ye&&(w=u.def(O.extensions,".webgl_draw_buffers"));var h=p.constants,b=h.drawBuffer,m=h.backBuffer,L;x?L=x.append(p,u):L=u.def(E,".next"),S||u("if(",L,"!==",E,".cur){"),u("if(",L,"){",T,".bindFramebuffer(",vc,",",L,".framebuffer);"),ye&&u(w,".drawBuffersWEBGL(",b,"[",L,".colorAttachments.length]);"),u("}else{",T,".bindFramebuffer(",vc,",null);"),ye&&u(w,".drawBuffersWEBGL(",m,");"),u("}",E,".cur=",L,";"),S||u("}")}function Zt(p,u,x){var S=p.shared,O=S.gl,T=p.current,E=p.next,w=S.current,h=S.next,b=p.cond(w,".dirty");Be.forEach(function(m){var L=Ae(m);if(!(L in x.state)){var F,j;if(L in E){F=E[L],j=T[L];var ae=wr(_e[L].length,function(ve){return b.def(F,"[",ve,"]")});b(p.cond(ae.map(function(ve,ne){return ve+"!=="+j+"["+ne+"]"}).join("||")).then(O,".",B[L],"(",ae,");",ae.map(function(ve,ne){return j+"["+ne+"]="+ve}).join(";"),";"))}else{F=b.def(h,".",L);var se=p.cond(F,"!==",w,".",L);b(se),L in V?se(p.cond(F).then(O,".enable(",V[L],");").else(O,".disable(",V[L],");"),w,".",L,"=",F,";"):se(O,".",B[L],"(",F,");",w,".",L,"=",F,";")}}}),Object.keys(x.state).length===0&&b(w,".dirty=false;"),u(b)}function rr(p,u,x,S){var O=p.shared,T=p.current,E=O.current,w=O.gl;yc(Object.keys(x)).forEach(function(h){var b=x[h];if(!(S&&!S(b))){var m=b.append(p,u);if(V[h]){var L=V[h];wn(b)?m?u(w,".enable(",L,");"):u(w,".disable(",L,");"):u(p.cond(m).then(w,".enable(",L,");").else(w,".disable(",L,");")),u(E,".",h,"=",m,";")}else if(Mt(m)){var F=T[h];u(w,".",B[h],"(",m,");",m.map(function(j,ae){return F+"["+ae+"]="+j}).join(";"),";")}else u(w,".",B[h],"(",m,");",E,".",h,"=",m,";")}})}function Nt(p,u){q&&(p.instancing=u.def(p.shared.extensions,".angle_instanced_arrays"))}function Je(p,u,x,S,O){var T=p.shared,E=p.stats,w=T.current,h=T.timer,b=x.profile;function m(){return typeof performance>"u"?"Date.now()":"performance.now()"}var L,F;function j(xe){L=u.def(),xe(L,"=",m(),";"),typeof O=="string"?xe(E,".count+=",O,";"):xe(E,".count++;"),Y&&(S?(F=u.def(),xe(F,"=",h,".getNumPendingQueries();")):xe(h,".beginQuery(",E,");"))}function ae(xe){xe(E,".cpuTime+=",m(),"-",L,";"),Y&&(S?xe(h,".pushScopeStats(",F,",",h,".getNumPendingQueries(),",E,");"):xe(h,".endQuery();"))}function se(xe){var we=u.def(w,".profile");u(w,".profile=",xe,";"),u.exit(w,".profile=",we,";")}var ve;if(b){if(wn(b)){b.enable?(j(u),ae(u.exit),se("true")):se("false");return}ve=b.append(p,u),se(ve)}else ve=u.def(w,".profile");var ne=p.block();j(ne),u("if(",ve,"){",ne,"}");var Le=p.block();ae(Le),u.exit("if(",ve,"){",Le,"}")}function nr(p,u,x,S,O){var T=p.shared;function E(h){switch(h){case Ka:case Za:case ts:return 2;case qa:case Ja:case rs:return 3;case Qa:case es:case ns:return 4;default:return 1}}function w(h,b,m){var L=T.gl,F=u.def(h,".location"),j=u.def(T.attributes,"[",F,"]"),ae=m.state,se=m.buffer,ve=[m.x,m.y,m.z,m.w],ne=["buffer","normalized","offset","stride"];function Le(){u("if(!",j,".buffer){",L,".enableVertexAttribArray(",F,");}");var we=m.type,Ce;if(m.size?Ce=u.def(m.size,"||",b):Ce=b,u("if(",j,".type!==",we,"||",j,".size!==",Ce,"||",ne.map(function(je){return j+"."+je+"!=="+m[je]}).join("||"),"){",L,".bindBuffer(",Ti,",",se,".buffer);",L,".vertexAttribPointer(",[F,Ce,we,m.normalized,m.stride,m.offset],");",j,".type=",we,";",j,".size=",Ce,";",ne.map(function(je){return j+"."+je+"="+m[je]+";"}).join(""),"}"),q){var Re=m.divisor;u("if(",j,".divisor!==",Re,"){",p.instancing,".vertexAttribDivisorANGLE(",[F,Re],");",j,".divisor=",Re,";}")}}function xe(){u("if(",j,".buffer){",L,".disableVertexAttribArray(",F,");",j,".buffer=null;","}if(",yi.map(function(we,Ce){return j+"."+we+"!=="+ve[Ce]}).join("||"),"){",L,".vertexAttrib4f(",F,",",ve,");",yi.map(function(we,Ce){return j+"."+we+"="+ve[Ce]+";"}).join(""),"}")}ae===bi?Le():ae===vo?xe():(u("if(",ae,"===",bi,"){"),Le(),u("}else{"),xe(),u("}"))}S.forEach(function(h){var b=h.name,m=x.attributes[b],L;if(m){if(!O(m))return;L=m.append(p,u)}else{if(!O(bc))return;var F=p.scopeAttrib(b);c.optional(function(){p.assert(u,F+".state","missing attribute "+b)}),L={},Object.keys(new C).forEach(function(j){L[j]=u.def(F,".",j)})}w(p.link(h),E(h.info.type),L)})}function pt(p,u,x,S,O,T){for(var E=p.shared,w=E.gl,h,b=0;b<S.length;++b){var m=S[b],L=m.name,F=m.info.type,j=x.uniforms[L],ae=p.link(m),se=ae+".location",ve;if(j){if(!O(j))continue;if(wn(j)){var ne=j.value;if(c.command(ne!==null&&typeof ne<"u",'missing uniform "'+L+'"',p.commandStr),F===Ji||F===ea){c.command(typeof ne=="function"&&(F===Ji&&(ne._reglType==="texture2d"||ne._reglType==="framebuffer")||F===ea&&(ne._reglType==="textureCube"||ne._reglType==="framebufferCube")),"invalid texture for uniform "+L,p.commandStr);var Le=p.link(ne._texture||ne.color[0]._texture);u(w,".uniform1i(",se,",",Le+".bind());"),u.exit(Le,".unbind();")}else if(F===qi||F===Qi||F===Zi){c.optional(function(){c.command(Mt(ne),"invalid matrix for uniform "+L,p.commandStr),c.command(F===qi&&ne.length===4||F===Qi&&ne.length===9||F===Zi&&ne.length===16,"invalid length for matrix uniform "+L,p.commandStr)});var xe=p.global.def("new Float32Array(["+Array.prototype.slice.call(ne)+"])"),we=2;F===Qi?we=3:F===Zi&&(we=4),u(w,".uniformMatrix",we,"fv(",se,",false,",xe,");")}else{switch(F){case Do:c.commandType(ne,"number","uniform "+L,p.commandStr),h="1f";break;case Ka:c.command(Mt(ne)&&ne.length===2,"uniform "+L,p.commandStr),h="2f";break;case qa:c.command(Mt(ne)&&ne.length===3,"uniform "+L,p.commandStr),h="3f";break;case Qa:c.command(Mt(ne)&&ne.length===4,"uniform "+L,p.commandStr),h="4f";break;case Go:c.commandType(ne,"boolean","uniform "+L,p.commandStr),h="1i";break;case Io:c.commandType(ne,"number","uniform "+L,p.commandStr),h="1i";break;case ts:c.command(Mt(ne)&&ne.length===2,"uniform "+L,p.commandStr),h="2i";break;case Za:c.command(Mt(ne)&&ne.length===2,"uniform "+L,p.commandStr),h="2i";break;case rs:c.command(Mt(ne)&&ne.length===3,"uniform "+L,p.commandStr),h="3i";break;case Ja:c.command(Mt(ne)&&ne.length===3,"uniform "+L,p.commandStr),h="3i";break;case ns:c.command(Mt(ne)&&ne.length===4,"uniform "+L,p.commandStr),h="4i";break;case es:c.command(Mt(ne)&&ne.length===4,"uniform "+L,p.commandStr),h="4i";break}u(w,".uniform",h,"(",se,",",Mt(ne)?Array.prototype.slice.call(ne):ne,");")}continue}else ve=j.append(p,u)}else{if(!O(bc))continue;ve=u.def(E.uniforms,"[",d.id(L),"]")}F===Ji?(c(!Array.isArray(ve),"must specify a scalar prop for textures"),u("if(",ve,"&&",ve,'._reglType==="framebuffer"){',ve,"=",ve,".color[0];","}")):F===ea&&(c(!Array.isArray(ve),"must specify a scalar prop for cube maps"),u("if(",ve,"&&",ve,'._reglType==="framebufferCube"){',ve,"=",ve,".color[0];","}")),c.optional(function(){function or(Ur,Cc){p.assert(u,Ur,'bad data or missing for uniform "'+L+'".  '+Cc)}function Yr(Ur){c(!Array.isArray(ve),"must not specify an array type for uniform"),or("typeof "+ve+'==="'+Ur+'"',"invalid type, expected "+Ur)}function Ir(Ur,Cc){Array.isArray(ve)?c(ve.length===Ur,"must have length "+Ur):or(E.isArrayLike+"("+ve+")&&"+ve+".length==="+Ur,"invalid vector, should have length "+Ur,p.commandStr)}function Sc(Ur){c(!Array.isArray(ve),"must not specify a value type"),or("typeof "+ve+'==="function"&&'+ve+'._reglType==="texture'+(Ur===uc?"2d":"Cube")+'"',"invalid texture type",p.commandStr)}switch(F){case Io:Yr("number");break;case Za:Ir(2);break;case Ja:Ir(3);break;case es:Ir(4);break;case Do:Yr("number");break;case Ka:Ir(2);break;case qa:Ir(3);break;case Qa:Ir(4);break;case Go:Yr("boolean");break;case ts:Ir(2);break;case rs:Ir(3);break;case ns:Ir(4);break;case qi:Ir(4);break;case Qi:Ir(9);break;case Zi:Ir(16);break;case Ji:Sc(uc);break;case ea:Sc(wm);break}});var Ce=1;switch(F){case Ji:case ea:var Re=u.def(ve,"._texture");u(w,".uniform1i(",se,",",Re,".bind());"),u.exit(Re,".unbind();");continue;case Io:case Go:h="1i";break;case Za:case ts:h="2i",Ce=2;break;case Ja:case rs:h="3i",Ce=3;break;case es:case ns:h="4i",Ce=4;break;case Do:h="1f";break;case Ka:h="2f",Ce=2;break;case qa:h="3f",Ce=3;break;case Qa:h="4f",Ce=4;break;case qi:h="Matrix2fv";break;case Qi:h="Matrix3fv";break;case Zi:h="Matrix4fv";break}if(h.charAt(0)==="M"){u(w,".uniform",h,"(",se,",");var je=Math.pow(F-qi+2,2),Tt=p.global.def("new Float32Array(",je,")");Array.isArray(ve)?u("false,(",wr(je,function(or){return Tt+"["+or+"]="+ve[or]}),",",Tt,")"):u("false,(Array.isArray(",ve,")||",ve," instanceof Float32Array)?",ve,":(",wr(je,function(or){return Tt+"["+or+"]="+ve+"["+or+"]"}),",",Tt,")"),u(");")}else if(Ce>1){for(var Jt=[],fn=[],ln=0;ln<Ce;++ln)Array.isArray(ve)?fn.push(ve[ln]):fn.push(u.def(ve+"["+ln+"]")),T&&Jt.push(u.def());T&&u("if(!",p.batchId,"||",Jt.map(function(or,Yr){return or+"!=="+fn[Yr]}).join("||"),"){",Jt.map(function(or,Yr){return or+"="+fn[Yr]+";"}).join("")),u(w,".uniform",h,"(",se,",",fn.join(","),");"),T&&u("}")}else{if(c(!Array.isArray(ve),"uniform value must not be an array"),T){var cn=u.def();u("if(!",p.batchId,"||",cn,"!==",ve,"){",cn,"=",ve,";")}u(w,".uniform",h,"(",se,",",ve,");"),T&&u("}")}}}function Ue(p,u,x,S){var O=p.shared,T=O.gl,E=O.draw,w=S.draw;function h(){var Ce=w.elements,Re,je=u;return Ce?((Ce.contextDep&&S.contextDynamic||Ce.propDep)&&(je=x),Re=Ce.append(p,je),w.elementsActive&&je("if("+Re+")"+T+".bindBuffer("+Po+","+Re+".buffer.buffer);")):(Re=je.def(),je(Re,"=",E,".",Wn,";","if(",Re,"){",T,".bindBuffer(",Po,",",Re,".buffer.buffer);}","else if(",O.vao,".currentVAO){",Re,"=",p.shared.elements+".getElements("+O.vao,".currentVAO.elements);",z?"":"if("+Re+")"+T+".bindBuffer("+Po+","+Re+".buffer.buffer);","}")),Re}function b(){var Ce=w.count,Re,je=u;return Ce?((Ce.contextDep&&S.contextDynamic||Ce.propDep)&&(je=x),Re=Ce.append(p,je),c.optional(function(){Ce.MISSING&&p.assert(u,"false","missing vertex count"),Ce.DYNAMIC&&p.assert(je,Re+">=0","missing vertex count")})):(Re=je.def(E,".",Yn),c.optional(function(){p.assert(je,Re+">=0","missing vertex count")})),Re}var m=h();function L(Ce){var Re=w[Ce];return Re?Re.contextDep&&S.contextDynamic||Re.propDep?Re.append(p,x):Re.append(p,u):u.def(E,".",Ce)}var F=L(Xn),j=L(Xa),ae=b();if(typeof ae=="number"){if(ae===0)return}else x("if(",ae,"){"),x.exit("}");var se,ve;q&&(se=L(Ya),ve=p.instancing);var ne=m+".type",Le=w.elements&&wn(w.elements)&&!w.vaoActive;function xe(){function Ce(){x(ve,".drawElementsInstancedANGLE(",[F,ae,ne,j+"<<(("+ne+"-"+Hl+")>>1)",se],");")}function Re(){x(ve,".drawArraysInstancedANGLE(",[F,j,ae,se],");")}m&&m!=="null"?Le?Ce():(x("if(",m,"){"),Ce(),x("}else{"),Re(),x("}")):Re()}function we(){function Ce(){x(T+".drawElements("+[F,ae,ne,j+"<<(("+ne+"-"+Hl+")>>1)"]+");")}function Re(){x(T+".drawArrays("+[F,j,ae]+");")}m&&m!=="null"?Le?Ce():(x("if(",m,"){"),Ce(),x("}else{"),Re(),x("}")):Re()}q&&(typeof se!="number"||se>=0)?typeof se=="string"?(x("if(",se,">0){"),xe(),x("}else if(",se,"<0){"),we(),x("}")):xe():we()}function at(p,u,x,S,O){var T=ze(),E=T.proc("body",O);return c.optional(function(){T.commandStr=u.commandStr,T.command=T.link(u.commandStr)}),q&&(T.instancing=E.def(T.shared.extensions,".angle_instanced_arrays")),p(T,E,x,S),T.compile().body}function ct(p,u,x,S){Nt(p,u),x.useVAO?x.drawVAO?u(p.shared.vao,".setVAO(",x.drawVAO.append(p,u),");"):u(p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"):(u(p.shared.vao,".setVAO(null);"),nr(p,u,x,S.attributes,function(){return!0})),pt(p,u,x,S.uniforms,function(){return!0},!1),Ue(p,u,u,x)}function kt(p,u){var x=p.proc("draw",1);Nt(p,x),Ht(p,x,u.context),zt(p,x,u.framebuffer),Zt(p,x,u),rr(p,x,u.state),Je(p,x,u,!1,!0);var S=u.shader.progVar.append(p,x);if(x(p.shared.gl,".useProgram(",S,".program);"),u.shader.program)ct(p,x,u,u.shader.program);else{x(p.shared.vao,".setVAO(null);");var O=p.global.def("{}"),T=x.def(S,".id"),E=x.def(O,"[",T,"]");x(p.cond(E).then(E,".call(this,a0);").else(E,"=",O,"[",T,"]=",p.link(function(w){return at(ct,p,u,w,1)}),"(",S,");",E,".call(this,a0);"))}Object.keys(u.state).length>0&&x(p.shared.current,".dirty=true;"),p.shared.vao&&x(p.shared.vao,".setVAO(null);")}function Xr(p,u,x,S){p.batchId="a1",Nt(p,u);function O(){return!0}nr(p,u,x,S.attributes,O),pt(p,u,x,S.uniforms,O,!1),Ue(p,u,u,x)}function qn(p,u,x,S){Nt(p,u);var O=x.contextDep,T=u.def(),E="a0",w="a1",h=u.def();p.shared.props=h,p.batchId=T;var b=p.scope(),m=p.scope();u(b.entry,"for(",T,"=0;",T,"<",w,";++",T,"){",h,"=",E,"[",T,"];",m,"}",b.exit);function L(ne){return ne.contextDep&&O||ne.propDep}function F(ne){return!L(ne)}if(x.needsContext&&Ht(p,m,x.context),x.needsFramebuffer&&zt(p,m,x.framebuffer),rr(p,m,x.state,L),x.profile&&L(x.profile)&&Je(p,m,x,!1,!0),S)x.useVAO?x.drawVAO?L(x.drawVAO)?m(p.shared.vao,".setVAO(",x.drawVAO.append(p,m),");"):b(p.shared.vao,".setVAO(",x.drawVAO.append(p,b),");"):b(p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"):(b(p.shared.vao,".setVAO(null);"),nr(p,b,x,S.attributes,F),nr(p,m,x,S.attributes,L)),pt(p,b,x,S.uniforms,F,!1),pt(p,m,x,S.uniforms,L,!0),Ue(p,b,m,x);else{var j=p.global.def("{}"),ae=x.shader.progVar.append(p,m),se=m.def(ae,".id"),ve=m.def(j,"[",se,"]");m(p.shared.gl,".useProgram(",ae,".program);","if(!",ve,"){",ve,"=",j,"[",se,"]=",p.link(function(ne){return at(Xr,p,x,ne,2)}),"(",ae,");}",ve,".call(this,a0[",T,"],",T,");")}}function v(p,u){var x=p.proc("batch",2);p.batchId="0",Nt(p,x);var S=!1,O=!0;Object.keys(u.context).forEach(function(j){S=S||u.context[j].propDep}),S||(Ht(p,x,u.context),O=!1);var T=u.framebuffer,E=!1;T?(T.propDep?S=E=!0:T.contextDep&&S&&(E=!0),E||zt(p,x,T)):zt(p,x,null),u.state.viewport&&u.state.viewport.propDep&&(S=!0);function w(j){return j.contextDep&&S||j.propDep}Zt(p,x,u),rr(p,x,u.state,function(j){return!w(j)}),(!u.profile||!w(u.profile))&&Je(p,x,u,!1,"a1"),u.contextDep=S,u.needsContext=O,u.needsFramebuffer=E;var h=u.shader.progVar;if(h.contextDep&&S||h.propDep)qn(p,x,u,null);else{var b=h.append(p,x);if(x(p.shared.gl,".useProgram(",b,".program);"),u.shader.program)qn(p,x,u,u.shader.program);else{x(p.shared.vao,".setVAO(null);");var m=p.global.def("{}"),L=x.def(b,".id"),F=x.def(m,"[",L,"]");x(p.cond(F).then(F,".call(this,a0,a1);").else(F,"=",m,"[",L,"]=",p.link(function(j){return at(qn,p,u,j,2)}),"(",b,");",F,".call(this,a0,a1);"))}}Object.keys(u.state).length>0&&x(p.shared.current,".dirty=true;"),p.shared.vao&&x(p.shared.vao,".setVAO(null);")}function M(p,u){var x=p.proc("scope",3);p.batchId="a2";var S=p.shared,O=S.current;Ht(p,x,u.context),u.framebuffer&&u.framebuffer.append(p,x),yc(Object.keys(u.state)).forEach(function(E){var w=u.state[E],h=w.append(p,x);Mt(h)?h.forEach(function(b,m){x.set(p.next[E],"["+m+"]",b)}):x.set(S.next,"."+E,h)}),Je(p,x,u,!0,!0),[Wn,Xa,Yn,Ya,Xn].forEach(function(E){var w=u.draw[E];w&&x.set(S.draw,"."+E,""+w.append(p,x))}),Object.keys(u.uniforms).forEach(function(E){var w=u.uniforms[E].append(p,x);Array.isArray(w)&&(w="["+w.join()+"]"),x.set(S.uniforms,"["+d.id(E)+"]",w)}),Object.keys(u.attributes).forEach(function(E){var w=u.attributes[E].append(p,x),h=p.scopeAttrib(E);Object.keys(new C).forEach(function(b){x.set(h,"."+b,w[b])})}),u.scopeVAO&&x.set(S.vao,".targetVAO",u.scopeVAO.append(p,x));function T(E){var w=u.shader[E];w&&x.set(S.shader,"."+E,w.append(p,x))}T(Xi),T(Yi),Object.keys(u.state).length>0&&(x(O,".dirty=true;"),x.exit(O,".dirty=true;")),x("a1(",p.shared.context,",a0,",p.batchId,");")}function D(p){if(!(typeof p!="object"||Mt(p))){for(var u=Object.keys(p),x=0;x<u.length;++x)if(sr.isDynamic(p[u[x]]))return!0;return!1}}function Ee(p,u,x){var S=u.static[x];if(!S||!D(S))return;var O=p.global,T=Object.keys(S),E=!1,w=!1,h=!1,b=p.global.def("{}");T.forEach(function(L){var F=S[L];if(sr.isDynamic(F)){typeof F=="function"&&(F=S[L]=sr.unbox(F));var j=yr(F,null);E=E||j.thisDep,h=h||j.propDep,w=w||j.contextDep}else{switch(O(b,".",L,"="),typeof F){case"number":O(F);break;case"string":O('"',F,'"');break;case"object":Array.isArray(F)&&O("[",F.join(),"]");break;default:O(p.link(F));break}O(";")}});function m(L,F){T.forEach(function(j){var ae=S[j];if(sr.isDynamic(ae)){var se=L.invoke(F,ae);F(b,".",j,"=",se,";")}})}u.dynamic[x]=new sr.DynamicVariable(za,{thisDep:E,contextDep:w,propDep:h,ref:b,append:m}),delete u.static[x]}function nt(p,u,x,S,O){var T=ze();T.stats=T.link(O),Object.keys(u.static).forEach(function(w){Ee(T,u,w)}),Em.forEach(function(w){Ee(T,p,w)});var E=$t(p,u,x,S,T);return kt(T,E),M(T,E),v(T,E),n(T.compile(),{destroy:function(){E.shader.program.destroy()}})}return{next:pe,current:_e,procs:function(){var p=ze(),u=p.proc("poll"),x=p.proc("refresh"),S=p.block();u(S),x(S);var O=p.shared,T=O.gl,E=O.next,w=O.current;S(w,".dirty=false;"),zt(p,u),zt(p,x,null,!0);var h;q&&(h=p.link(q)),_.oes_vertex_array_object&&x(p.link(_.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var b=0;b<G.maxAttributes;++b){var m=x.def(O.attributes,"[",b,"]"),L=p.cond(m,".buffer");L.then(T,".enableVertexAttribArray(",b,");",T,".bindBuffer(",Ti,",",m,".buffer.buffer);",T,".vertexAttribPointer(",b,",",m,".size,",m,".type,",m,".normalized,",m,".stride,",m,".offset);").else(T,".disableVertexAttribArray(",b,");",T,".vertexAttrib4f(",b,",",m,".x,",m,".y,",m,".z,",m,".w);",m,".buffer=null;"),x(L),q&&x(h,".vertexAttribDivisorANGLE(",b,",",m,".divisor);")}return x(p.shared.vao,".currentVAO=null;",p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"),Object.keys(V).forEach(function(F){var j=V[F],ae=S.def(E,".",F),se=p.block();se("if(",ae,"){",T,".enable(",j,")}else{",T,".disable(",j,")}",w,".",F,"=",ae,";"),x(se),u("if(",ae,"!==",w,".",F,"){",se,"}")}),Object.keys(B).forEach(function(F){var j=B[F],ae=_e[F],se,ve,ne=p.block();if(ne(T,".",j,"("),Mt(ae)){var Le=ae.length;se=p.global.def(E,".",F),ve=p.global.def(w,".",F),ne(wr(Le,function(xe){return se+"["+xe+"]"}),");",wr(Le,function(xe){return ve+"["+xe+"]="+se+"["+xe+"];"}).join("")),u("if(",wr(Le,function(xe){return se+"["+xe+"]!=="+ve+"["+xe+"]"}).join("||"),"){",ne,"}")}else se=S.def(E,".",F),ve=S.def(w,".",F),ne(se,");",w,".",F,"=",se,";"),u("if(",se,"!==",ve,"){",ne,"}");x(ne)}),p.compile()}(),compile:nt}}function $m(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Vm=34918,jm=34919,xc=35007,Hm=function(s,d){if(!d.ext_disjoint_timer_query)return null;var _=[];function G(){return _.pop()||d.ext_disjoint_timer_query.createQueryEXT()}function $(q){_.push(q)}var I=[];function k(q){var ye=G();d.ext_disjoint_timer_query.beginQueryEXT(xc,ye),I.push(ye),Y(I.length-1,I.length,q)}function X(){d.ext_disjoint_timer_query.endQueryEXT(xc)}function W(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Z=[];function ee(){return Z.pop()||new W}function J(q){Z.push(q)}var oe=[];function Y(q,ye,z){var _e=ee();_e.startQueryIndex=q,_e.endQueryIndex=ye,_e.sum=0,_e.stats=z,oe.push(_e)}var Q=[],C=[];function N(){var q,ye,z=I.length;if(z!==0){C.length=Math.max(C.length,z+1),Q.length=Math.max(Q.length,z+1),Q[0]=0,C[0]=0;var _e=0;for(q=0,ye=0;ye<I.length;++ye){var pe=I[ye];d.ext_disjoint_timer_query.getQueryObjectEXT(pe,jm)?(_e+=d.ext_disjoint_timer_query.getQueryObjectEXT(pe,Vm),$(pe)):I[q++]=pe,Q[ye+1]=_e,C[ye+1]=q}for(I.length=q,q=0,ye=0;ye<oe.length;++ye){var Be=oe[ye],V=Be.startQueryIndex,B=Be.endQueryIndex;Be.sum+=Q[B]-Q[V];var Ae=C[V],fe=C[B];fe===Ae?(Be.stats.gpuTime+=Be.sum/1e6,J(Be)):(Be.startQueryIndex=Ae,Be.endQueryIndex=fe,oe[q++]=Be)}oe.length=q}}return{beginQuery:k,endQuery:X,pushScopeStats:Y,update:N,getNumPendingQueries:function(){return I.length},clear:function(){_.push.apply(_,I);for(var q=0;q<_.length;q++)d.ext_disjoint_timer_query.deleteQueryEXT(_[q]);I.length=0,_.length=0},restore:function(){I.length=0,_.length=0}}},zm=16384,Wm=256,Xm=1024,Ym=34962,Ec="webglcontextlost",Tc="webglcontextrestored",Ac=1,Km=2,qm=3;function wc(s,d){for(var _=0;_<s.length;++_)if(s[_]===d)return _;return-1}function Qm(s){var d=Kd(s);if(!d)return null;var _=d.gl,G=_.getContextAttributes(),$=_.isContextLost(),I=qd(_,d);if(!I)return null;var k=La(),X=$m(),W=I.extensions,Z=Hm(_,W),ee=Ar(),J=_.drawingBufferWidth,oe=_.drawingBufferHeight,Y={tick:0,time:0,viewportWidth:J,viewportHeight:oe,framebufferWidth:J,framebufferHeight:oe,drawingBufferWidth:J,drawingBufferHeight:oe,pixelRatio:d.pixelRatio},Q={},C={elements:null,primitive:4,count:-1,offset:0,instances:-1},N=Nh(_,W),q=Jh(_,X,d,_e),ye=up(_,W,q,X),z=um(_,W,N,X,q,ye,C);function _e(Ue){return z.destroyBuffer(Ue)}var pe=mm(_,k,X,d),Be=Vp(_,W,N,function(){Ae.procs.poll()},Y,X,d),V=jp(_,W,N,X,d),B=lm(_,W,N,Be,V,X),Ae=Um(_,k,W,N,q,ye,Be,B,Q,z,pe,C,Y,Z,d),fe=gm(_,B,Ae.procs.poll,Y,G,W,N),K=Ae.next,ce=_.canvas,he=[],Ke=[],ze=[],me=[d.onDestroy],ge=null;function Ve(){if(he.length===0){Z&&Z.update(),ge=null;return}ge=ir.next(Ve),rr();for(var Ue=he.length-1;Ue>=0;--Ue){var at=he[Ue];at&&at(Y,null,0)}_.flush(),Z&&Z.update()}function Ye(){!ge&&he.length>0&&(ge=ir.next(Ve))}function it(){ge&&(ir.cancel(Ve),ge=null)}function Dt(Ue){Ue.preventDefault(),$=!0,it(),Ke.forEach(function(at){at()})}function Gt(Ue){_.getError(),$=!1,I.restore(),pe.restore(),q.restore(),Be.restore(),V.restore(),B.restore(),z.restore(),Z&&Z.restore(),Ae.procs.refresh(),Ye(),ze.forEach(function(at){at()})}ce&&(ce.addEventListener(Ec,Dt,!1),ce.addEventListener(Tc,Gt,!1));function st(){he.length=0,it(),ce&&(ce.removeEventListener(Ec,Dt),ce.removeEventListener(Tc,Gt)),pe.clear(),B.clear(),V.clear(),z.clear(),Be.clear(),ye.clear(),q.clear(),Z&&Z.clear(),me.forEach(function(Ue){Ue()})}function jt(Ue){c(!!Ue,"invalid args to regl({...})"),c.type(Ue,"object","invalid args to regl({...})");function at(O){var T=n({},O);delete T.uniforms,delete T.attributes,delete T.context,delete T.vao,"stencil"in T&&T.stencil.op&&(T.stencil.opBack=T.stencil.opFront=T.stencil.op,delete T.stencil.op);function E(w){if(w in T){var h=T[w];delete T[w],Object.keys(h).forEach(function(b){T[w+"."+b]=h[b]})}}return E("blend"),E("depth"),E("cull"),E("stencil"),E("polygonOffset"),E("scissor"),E("sample"),"vao"in O&&(T.vao=O.vao),T}function ct(O,T){var E={},w={};return Object.keys(O).forEach(function(h){var b=O[h];if(sr.isDynamic(b)){w[h]=sr.unbox(b,h);return}else if(T&&Array.isArray(b)){for(var m=0;m<b.length;++m)if(sr.isDynamic(b[m])){w[h]=sr.unbox(b,h);return}}E[h]=b}),{dynamic:w,static:E}}var kt=ct(Ue.context||{},!0),Xr=ct(Ue.uniforms||{},!0),qn=ct(Ue.attributes||{},!1),v=ct(at(Ue),!1),M={gpuTime:0,cpuTime:0,count:0},D=Ae.compile(v,qn,Xr,kt,M),Ee=D.draw,nt=D.batch,p=D.scope,u=[];function x(O){for(;u.length<O;)u.push(null);return u}function S(O,T){var E;if($&&c.raise("context lost"),typeof O=="function")return p.call(this,null,O,0);if(typeof T=="function")if(typeof O=="number")for(E=0;E<O;++E)p.call(this,null,T,E);else if(Array.isArray(O))for(E=0;E<O.length;++E)p.call(this,O[E],T,E);else return p.call(this,O,T,0);else if(typeof O=="number"){if(O>0)return nt.call(this,x(O|0),O|0)}else if(Array.isArray(O)){if(O.length)return nt.call(this,O,O.length)}else return Ee.call(this,O)}return n(S,{stats:M,destroy:function(){D.destroy()}})}var Lt=B.setFBO=jt({framebuffer:sr.define.call(null,Ac,"framebuffer")});function $t(Ue,at){var ct=0;Ae.procs.poll();var kt=at.color;kt&&(_.clearColor(+kt[0]||0,+kt[1]||0,+kt[2]||0,+kt[3]||0),ct|=zm),"depth"in at&&(_.clearDepth(+at.depth),ct|=Wm),"stencil"in at&&(_.clearStencil(at.stencil|0),ct|=Xm),c(!!ct,"called regl.clear with no buffer specified"),_.clear(ct)}function Ht(Ue){if(c(typeof Ue=="object"&&Ue,"regl.clear() takes an object as input"),"framebuffer"in Ue)if(Ue.framebuffer&&Ue.framebuffer_reglType==="framebufferCube")for(var at=0;at<6;++at)Lt(n({framebuffer:Ue.framebuffer.faces[at]},Ue),$t);else Lt(Ue,$t);else $t(null,Ue)}function zt(Ue){c.type(Ue,"function","regl.frame() callback must be a function"),he.push(Ue);function at(){var ct=wc(he,Ue);c(ct>=0,"cannot cancel a frame twice");function kt(){var Xr=wc(he,kt);he[Xr]=he[he.length-1],he.length-=1,he.length<=0&&it()}he[ct]=kt}return Ye(),{cancel:at}}function Zt(){var Ue=K.viewport,at=K.scissor_box;Ue[0]=Ue[1]=at[0]=at[1]=0,Y.viewportWidth=Y.framebufferWidth=Y.drawingBufferWidth=Ue[2]=at[2]=_.drawingBufferWidth,Y.viewportHeight=Y.framebufferHeight=Y.drawingBufferHeight=Ue[3]=at[3]=_.drawingBufferHeight}function rr(){Y.tick+=1,Y.time=Je(),Zt(),Ae.procs.poll()}function Nt(){Be.refresh(),Zt(),Ae.procs.refresh(),Z&&Z.update()}function Je(){return(Ar()-ee)/1e3}Nt();function nr(Ue,at){c.type(at,"function","listener callback must be a function");var ct;switch(Ue){case"frame":return zt(at);case"lost":ct=Ke;break;case"restore":ct=ze;break;case"destroy":ct=me;break;default:c.raise("invalid event, must be one of frame,lost,restore,destroy")}return ct.push(at),{cancel:function(){for(var kt=0;kt<ct.length;++kt)if(ct[kt]===at){ct[kt]=ct[ct.length-1],ct.pop();return}}}}var pt=n(jt,{clear:Ht,prop:sr.define.bind(null,Ac),context:sr.define.bind(null,Km),this:sr.define.bind(null,qm),draw:jt({}),buffer:function(Ue){return q.create(Ue,Ym,!1,!1)},elements:function(Ue){return ye.create(Ue,!1)},texture:Be.create2D,cube:Be.createCube,renderbuffer:V.create,framebuffer:B.create,framebufferCube:B.createCube,vao:z.createVAO,attributes:G,frame:zt,on:nr,limits:N,hasExtension:function(Ue){return N.extensions.indexOf(Ue.toLowerCase())>=0},read:fe,destroy:st,_gl:_,_refresh:Nt,poll:function(){rr(),Z&&Z.update()},now:Je,stats:X});return d.onDone(null,pt),pt}return Qm})})(Nd);var K_=Nd.exports;const q_=Y_(K_);class Bs{constructor(t,r){Oe(this,"x");Oe(this,"y");Oe(this,"current",[0,0]);Oe(this,"transition");this.x=t,this.y=r,this.current=[t,r]}set(t,r,n=0){const i=this.x,a=this.y;this.x=t,this.y=r,n===0||!bt.transition?(this.current=[t,r],this.transition=void 0):(this.current=[i,a],this.transition={from:[i,a],target:[t,r],duration:[0,n]})}move(t,r,n=0){this.set(this.x+t,this.y+r,n)}tick(t){if(!this.transition)return;const r=this.transition;if(r.duration[0]+=t,r.duration[0]>=r.duration[1])this.current=r.target,this.transition=void 0;else{const n=r.duration[0]/r.duration[1],i=-(Math.cos(Math.PI*n)-1)/2,a=r.from[0]+(r.target[0]-r.from[0])*i,f=r.from[1]+(r.target[1]-r.from[1])*i;this.current=[a,f]}}distance(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}equals(t){return this.x===t.x&&this.y===t.y}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}static from(t){return new Bs(t[0],t[1])}}var Gi=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function mn(){var e=new Gi(16);return Gi!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ia(e){var t=new Gi(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Q_(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],f=t[4],o=t[5],l=t[6],y=t[7],g=t[8],P=t[9],U=t[10],re=t[11],ue=t[12],Ie=t[13],Qe=t[14],Ge=t[15],Ze=r*o-n*f,$e=r*l-i*f,be=r*y-a*f,ke=n*l-i*o,We=n*y-a*o,St=i*y-a*l,Ft=g*Ie-P*ue,He=g*Qe-U*ue,et=g*Ge-re*ue,mt=P*Qe-U*Ie,Fe=P*Ge-re*Ie,_t=U*Ge-re*Qe,ft=Ze*_t-$e*Fe+be*mt+ke*et-We*He+St*Ft;return ft?(ft=1/ft,e[0]=(o*_t-l*Fe+y*mt)*ft,e[1]=(i*Fe-n*_t-a*mt)*ft,e[2]=(Ie*St-Qe*We+Ge*ke)*ft,e[3]=(U*We-P*St-re*ke)*ft,e[4]=(l*et-f*_t-y*He)*ft,e[5]=(r*_t-i*et+a*He)*ft,e[6]=(Qe*be-ue*St-Ge*$e)*ft,e[7]=(g*St-U*be+re*$e)*ft,e[8]=(f*Fe-o*et+y*Ft)*ft,e[9]=(n*et-r*Fe-a*Ft)*ft,e[10]=(ue*We-Ie*be+Ge*Ze)*ft,e[11]=(P*be-g*We-re*Ze)*ft,e[12]=(o*He-f*mt-l*Ft)*ft,e[13]=(r*mt-n*He+i*Ft)*ft,e[14]=(Ie*$e-ue*ke-Qe*Ze)*ft,e[15]=(g*ke-P*$e+U*Ze)*ft,e):null}function Z_(e,t,r){var n=t[0],i=t[1],a=t[2],f=t[3],o=t[4],l=t[5],y=t[6],g=t[7],P=t[8],U=t[9],re=t[10],ue=t[11],Ie=t[12],Qe=t[13],Ge=t[14],Ze=t[15],$e=r[0],be=r[1],ke=r[2],We=r[3];return e[0]=$e*n+be*o+ke*P+We*Ie,e[1]=$e*i+be*l+ke*U+We*Qe,e[2]=$e*a+be*y+ke*re+We*Ge,e[3]=$e*f+be*g+ke*ue+We*Ze,$e=r[4],be=r[5],ke=r[6],We=r[7],e[4]=$e*n+be*o+ke*P+We*Ie,e[5]=$e*i+be*l+ke*U+We*Qe,e[6]=$e*a+be*y+ke*re+We*Ge,e[7]=$e*f+be*g+ke*ue+We*Ze,$e=r[8],be=r[9],ke=r[10],We=r[11],e[8]=$e*n+be*o+ke*P+We*Ie,e[9]=$e*i+be*l+ke*U+We*Qe,e[10]=$e*a+be*y+ke*re+We*Ge,e[11]=$e*f+be*g+ke*ue+We*Ze,$e=r[12],be=r[13],ke=r[14],We=r[15],e[12]=$e*n+be*o+ke*P+We*Ie,e[13]=$e*i+be*l+ke*U+We*Qe,e[14]=$e*a+be*y+ke*re+We*Ge,e[15]=$e*f+be*g+ke*ue+We*Ze,e}function br(e,t,r){var n=r[0],i=r[1],a=r[2],f,o,l,y,g,P,U,re,ue,Ie,Qe,Ge;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(f=t[0],o=t[1],l=t[2],y=t[3],g=t[4],P=t[5],U=t[6],re=t[7],ue=t[8],Ie=t[9],Qe=t[10],Ge=t[11],e[0]=f,e[1]=o,e[2]=l,e[3]=y,e[4]=g,e[5]=P,e[6]=U,e[7]=re,e[8]=ue,e[9]=Ie,e[10]=Qe,e[11]=Ge,e[12]=f*n+g*i+ue*a+t[12],e[13]=o*n+P*i+Ie*a+t[13],e[14]=l*n+U*i+Qe*a+t[14],e[15]=y*n+re*i+Ge*a+t[15]),e}function vn(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ws(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],f=t[5],o=t[6],l=t[7],y=t[8],g=t[9],P=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+y*n,e[5]=f*i+g*n,e[6]=o*i+P*n,e[7]=l*i+U*n,e[8]=y*i-a*n,e[9]=g*i-f*n,e[10]=P*i-o*n,e[11]=U*i-l*n,e}function J_(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],f=t[1],o=t[2],l=t[3],y=t[8],g=t[9],P=t[10],U=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-y*n,e[1]=f*i-g*n,e[2]=o*i-P*n,e[3]=l*i-U*n,e[8]=a*n+y*i,e[9]=f*n+g*i,e[10]=o*n+P*i,e[11]=l*n+U*i,e}function kd(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],f=t[1],o=t[2],l=t[3],y=t[4],g=t[5],P=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+y*n,e[1]=f*i+g*n,e[2]=o*i+P*n,e[3]=l*i+U*n,e[4]=y*i-a*n,e[5]=g*i-f*n,e[6]=P*i-o*n,e[7]=U*i-l*n,e}function eg(e,t,r,n,i){var a=1/Math.tan(t/2),f;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(f=1/(n-i),e[10]=(i+n)*f,e[14]=2*i*n*f):(e[10]=-1,e[14]=-2*n),e}var tg=eg;function Bd(){var e=new Gi(4);return Gi!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function pf(e,t,r,n){var i=new Gi(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function rg(e,t,r){var n=t[0],i=t[1],a=t[2],f=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*f,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*f,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*f,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*f,e}(function(){var e=Bd();return function(t,r,n,i,a,f){var o,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,o=n;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],a(e,e,f),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}})();class ng{constructor(t){Oe(this,"drawPlayerCommand");Oe(this,"drawPlayerShadowCommand");Oe(this,"playerTextures",new Map);Oe(this,"textures",new Map);const r=t.ctx,n=a=>r.prop(a);this.drawPlayerCommand=r({vert:du,frag:ig,uniforms:{u_projection:n("u_projection"),u_texture:n("u_texture")},attributes:{a_position:r.buffer([[-1,-1],[1,-1],[1,1],[-1,1]]),a_uv:r.buffer([[0,0],[1,0],[1,1],[0,1]])},elements:r.elements([[2,1,0],[0,3,2]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"}}});const i=a=>r.prop(a);this.drawPlayerShadowCommand=r({vert:du,frag:ag,uniforms:{u_projection:i("u_projection")},attributes:{a_position:r.buffer([[-1,-1],[1,-1],[1,1],[-1,1]]),a_uv:r.buffer([[0,0],[1,0],[1,1],[0,1]])},elements:r.elements([[2,1,0],[0,3,2]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"}}})}draw(t,r,n){const i=Er(),a=Et(),f=ue=>[[0,0,0],[.2,0,-.2],[-.2,0,.2],[.2,0,.2],[-.2,0,-.2]][ue]??[0,0,0],o=[],l=[],y=[],g=[],P=this.getTexture("dizziness"),U=this.getTexture("arrow"),re=new Map;for(const ue of a.players.values()){ue.position.tick(n);const[Ie,Qe]=ue.position.current,Ge=ia(r);if(!ue.position.transition){const He=i.indexFromPosition([ue.position.x,ue.position.y]),et=re.get(He)??0;re.set(He,et+1),br(Ge,Ge,f(et))}const Ze=this.getPlayerTexture(ue.id);if(!Ze)continue;const $e=Ze.height/Ze.width;br(Ge,Ge,[Ie,0,Qe]);const be=ia(Ge),ke=.4*$e;if(br(be,be,[0,ke,0]),vn(be,be,[.4,-ke,1]),o.push({u_projection:be,u_texture:Ze}),P&&ue.dizziness){const He=ia(Ge);br(He,He,[0,2*ke,.1]),vn(He,He,[.25,-.25,1]),l.push({u_projection:He,u_texture:P})}if(U){let He=[ue.direction];if(ue.active){const et=dr().move.accept;et.length&&(He=et)}for(const et of He){const mt={[dt.UP]:0,[dt.RIGHT]:1,[dt.DOWN]:2,[dt.LEFT]:3}[et],Fe=ia(Ge),_t=Math.sin(mt*Math.PI/2)*.5,ft=-Math.cos(mt*Math.PI/2)*.5;br(Fe,Fe,[_t,.1,ft]),vn(Fe,Fe,[.25,1,.25]),ws(Fe,Fe,Math.PI/2),kd(Fe,Fe,mt*Math.PI/2),l.push({u_projection:Fe,u_texture:U})}}const We=ia(Ge);br(We,We,[0,.01,0]),ws(We,We,Math.PI/2),vn(We,We,[.4,.2,1]),y.push({u_projection:We});const St=t.projectPoint([Ie,2*ke,Qe],r),Ft=`${ue.id}`;g.push([Ft,St])}this.drawPlayerCommand(o),this.drawPlayerShadowCommand(y),this.drawPlayerCommand(l),a.playersLabel=g}getTexture(t){let r=this.textures.get(t);if(r===void 0){const n=Gn().getTexture(t);if(r=en().ctx.texture(n),!r)return;this.textures.set(t,r)}return r}getPlayerTexture(t){let r=this.playerTextures.get(t);if(r===void 0){const n=`player-${t}`,i=Gn().getTexture(n);if(r=en().ctx.texture(i),!r)return;this.playerTextures.set(t,r)}return r}}const du=`
precision mediump float;
attribute vec2 a_position;
attribute vec2 a_uv;

uniform mat4 u_projection;

varying vec2 uv;

void main() {
  uv = a_uv;
  gl_Position = u_projection * vec4(a_position, 0, 1);
}
`,ig=`
precision mediump float;
uniform sampler2D u_texture;

varying vec2 uv;

void main() {
  vec4 color = texture2D(u_texture, uv);
  if (color.a < 0.1) discard;
  gl_FragColor = color;
}
`,ag=`
precision mediump float;

varying vec2 uv;

void main() {
  float distance_to_center = distance(uv, vec2(0.5));
  if (distance_to_center > 0.5) discard;
  gl_FragColor = vec4(0.1, 0.1, 0.1, 0.8);
}
`;class sg{constructor(t){Oe(this,"fbo");Oe(this,"width");Oe(this,"height");Oe(this,"changed",!0);Oe(this,"updateMapCommand");Oe(this,"mapCommand");Oe(this,"undergroundCommand");Oe(this,"skyCommand");Oe(this,"textures",new Map);const r=t.ctx,n=Er(),i=(this.width=n.width)*Pn.TILE_SIZE,a=(this.height=n.height)*Pn.TILE_SIZE;this.fbo=r.framebuffer({width:i,height:a});const f=y=>r.prop(y);this.updateMapCommand=r({vert:hu,frag:pu,framebuffer:this.fbo,uniforms:{u_projection:f("u_projection"),u_texture:f("u_texture")},attributes:{a_position:r.buffer([[-1,-1],[1,-1],[1,1],[-1,1]]),a_uv:r.buffer([[0,0],[1,0],[1,1],[0,1]])},elements:r.elements([[2,1,0],[0,3,2]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}});const o=y=>r.prop(y);this.mapCommand=r({vert:hu,frag:pu,uniforms:{u_projection:o("u_projection"),u_texture:o("u_texture")},attributes:{a_position:r.buffer([[-1,1],[1,1],[1,-1],[-1,-1]]),a_uv:r.buffer([[0,0],[1,0],[1,1],[0,1]])},elements:r.elements([[2,1,0],[0,3,2]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}});const l=y=>r.prop(y);this.undergroundCommand=r({vert:og,frag:fg,uniforms:{u_projection:l("u_projection"),u_color:pf(.4609375,.640625,.2890625,1)},attributes:{a_position:r.buffer([[-1,1,-1],[1,1,-1],[1,1,1],[-1,1,1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1],[-1,-1,-1],[-1,1,-1],[-1,1,1],[-1,-1,1],[1,-1,-1],[1,-1,1],[1,1,1],[1,1,-1]])},elements:r.elements([[2,1,0],[0,3,2],[6,5,4],[4,7,6],[10,9,8],[8,11,10],[14,13,12],[12,15,14]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}}),this.skyCommand=r({vert:lg,frag:cg,uniforms:{u_projection:l("u_projection"),u_color:pf(.4921875,.8359375,.8515625,1)},attributes:{a_position:r.buffer([[-1,-1],[1,-1],[1,1],[-1,1]])},elements:r.elements([[2,1,0],[0,3,2]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}}})}draw(t,r){const n=Er();if(this.changed){t.ctx.clear({depth:1,color:[0,0,0,0],framebuffer:this.fbo});const g=[];for(const P in n.flatTiles){const U=n.flatTiles[P],re=this.getTexture(U);if(!re)continue;const ue=mn(),[Ie,Qe]=n.indexFromFlat(parseInt(P));br(ue,ue,[-1,1,0]),vn(ue,ue,[1/n.width,-1/n.height,0]),br(ue,ue,[Ie*2+1,Qe*2+1,0]),g.push({u_projection:ue,u_texture:re})}this.updateMapCommand(g),this.changed=!1}const i=Math.floor(n.width/2),a=Math.floor(n.height/2),f=mn();br(f,r,[i,-.01,a]),vn(f,f,[n.width/2+.5,5,n.height/2+.5]),br(f,f,[0,-1,0]),this.undergroundCommand({u_projection:f});const o=mn();br(o,r,[i,25,a-10]),vn(o,o,[100,100,1]),this.skyCommand({u_projection:o});const l=mn();br(l,r,[i,0,a]),ws(l,l,Math.PI/2),vn(l,l,[this.width/2,this.height/2,1]),this.mapCommand({u_projection:l,u_texture:this.fbo})}getTexture(t){let r=this.textures.get(t);if(r===void 0){const n=Pn.tileImage(t);if(!n||(r=en().ctx.texture(n),!r))return;this.textures.set(t,r)}return r}}const hu=`
precision mediump float;
attribute vec2 a_position;
attribute vec2 a_uv;

uniform mat4 u_projection;

varying vec2 uv;

void main() {
  uv = a_uv;
  gl_Position = u_projection * vec4(a_position, 0, 1);
}
`,pu=`
precision mediump float;
uniform sampler2D u_texture;

varying vec2 uv;

void main() {
  gl_FragColor = texture2D(u_texture, uv);
}
`,og=`
precision mediump float;
attribute vec3 a_position;

uniform mat4 u_projection;

varying float height;
void main() {
  height = a_position.y;
  gl_Position = u_projection * vec4(a_position, 1);
}
`,fg=`
precision mediump float;
uniform vec4 u_color;

varying float height;
void main() {
  gl_FragColor = u_color * height;
  if (height < 0.995) {
    gl_FragColor -= vec4(0.1, 0.1, 0.1, 0);
  }
}
`,lg=`
precision mediump float;
attribute vec2 a_position;

uniform mat4 u_projection;

void main() {
  gl_Position = u_projection * vec4(a_position, 0, 1);
}
`,cg=`
precision mediump float;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
}
`;class ug{constructor(t){Oe(this,"damagedCommand");Oe(this,"textures",new Map);const r=t.ctx,n=i=>r.prop(i);this.damagedCommand=r({vert:dg,frag:hg,uniforms:{u_projection:n("u_projection"),u_direction:n("u_direction"),u_texture:n("u_texture"),u_time:n("u_time")},attributes:{a_position:r.buffer([[-1,-1],[1,-1],[1,1],[-1,1]]),a_uv:r.buffer([[0,0],[1,0],[1,1],[0,1]])},elements:r.elements([[2,1,0],[0,3,2]]),blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"}}})}draw(t,r,n){const i=Md(),a=[];for(const f of i.inner.values())if(i.check("damaged",f)){f.time+=n;const o=this.getTexture("fx-damaged");if(!o)continue;const[l,y]=f.position,g=mn();br(g,r,[l,.5,y+.1]),vn(g,g,[.2,-.2,1]),a.push({u_time:f.time,u_direction:f.direction,u_projection:g,u_texture:o})}this.damagedCommand(a)}getTexture(t){let r=this.textures.get(t);if(r===void 0){const n=Gn().getTexture(t);if(r=en().ctx.texture(n),!r)return;this.textures.set(t,r)}return r}}const dg=`
precision mediump float;
attribute vec2 a_position;
attribute vec2 a_uv;

uniform mat4 u_projection;
uniform vec2 u_direction;
uniform float u_time;

varying vec2 uv;

void main() {
  uv = a_uv;
  vec2 move = u_direction * u_time / 800.0 * 2.0;
  gl_Position = u_projection * vec4(a_position - move, 0, 1);
}
`,hg=`
precision mediump float;
uniform sampler2D u_texture;
uniform float u_time;

varying vec2 uv;

void main() {
  float t = u_time / 800.0;
  vec4 color = texture2D(u_texture, uv);
  gl_FragColor = vec4(color.rgb, color.a * (1.0 - t));
}
`,en=()=>Ud,pg=e=>Ud=new mg(e);let Ud;class mg{constructor(t){Oe(this,"canvas");Oe(this,"ctx");Oe(this,"viewport",600);Oe(this,"paused",!0);Oe(this,"position",new Bs(0,0));Oe(this,"aspect",NaN);Oe(this,"width",NaN);Oe(this,"height",NaN);Oe(this,"backgroundRender");Oe(this,"playersRender");Oe(this,"fxRender");this.canvas=t,this.ctx=q_({pixelRatio:1,canvas:t}),this.backgroundRender=new sg(this),this.playersRender=new ng(this),this.fxRender=new ug(this),this.resize(),window.addEventListener("resize",this.resize.bind(this))}start(){const t=this.paused;this.paused=!1,t&&this.draw()}stop(){this.paused=!0}draw(t=Date.now()){if(this.paused)return;const r=Date.now(),n=r-t;this.position.tick(n);const i=n<=1e3/60;if(requestAnimationFrame(()=>this.draw(i?t:r)),i)return;this.ctx.poll(),this.clear();const o=tg(mn(),Math.PI/3,this.aspect,1,1e4),l=mn(),y=5,g=30*Math.PI/180,P=y*Math.sin(g),U=y*Math.cos(g),re=.8,[ue,Ie]=this.position.current;br(l,l,[bt.x+ue,bt.y+re+P,bt.z+Ie+U]),ws(l,l,bt.angleX*Math.PI/180-g),J_(l,l,bt.angleY*Math.PI/180),kd(l,l,bt.angleZ*Math.PI/180);const Qe=Q_(mn(),l),Ge=Z_(mn(),o,Qe);this.backgroundRender.draw(this,Ge),this.playersRender.draw(this,Ge,n),this.fxRender.draw(this,Ge,n)}clear(){this.ctx.clear({color:[0,0,0,1],depth:1})}resize(){let{width:t,height:r}=this.canvas.getBoundingClientRect();const n=window.devicePixelRatio;this.canvas.height=r*n,this.canvas.width=t*n,this.aspect=t/r,this.height=r,this.width=t}projectPoint(t,r){const n=pf(t[0],t[1],t[2],1),i=rg(Bd(),n,r);return[(i[0]/i[3]+1)*.5*this.width,(1-i[1]/i[3])*.5*this.height]}}const ii=6,vg=.6;class _g{constructor(t,r,n,i,a){Oe(this,"active",!1);Oe(this,"health",ii);Oe(this,"dizziness",0);Oe(this,"fixedDirection",!0);Oe(this,"doubleDice",0);Oe(this,"fixedDices",[]);Oe(this,"immune",0);Oe(this,"doubleTaskScore",0);Oe(this,"doubleDamage",0);this.id=t,this.score=r,this.color=n,this.position=i,this.direction=a}async walk(){const r=Er().nextPosition([this.position.x,this.position.y],this.direction);if(r.size===0)throw new Error("No moves available");const n=dr();this.fixedDirection?this.fixedDirection=!1:this.direction=r.size===1?r.keys().next().value:await n.move.input("選擇方向",Array.from(r.keys()));const i=r.get(this.direction);this.position.set(this.position.x+i[0],this.position.y+i[1],200);const a=en();a.position=this.position.clone(),await n.wait(200)}async trigger(t){const r=Er(),n=Et();t??(t=r.getTile(this.position.x,this.position.y)),console.group(`玩家 ${this.id} 抵達 ${Pn.tileText(t)}`);const i={[lr.Spawner]:async()=>{console.log("獲得 100 分"),n.messages.push(`玩家 ${this.id} 獲得 100 分`),this.score+=100,n.victoryScore<=this.score&&(console.log("獲勝"),n.messages.push(`玩家 ${this.id} 獲勝`),n.winner=this,Df().running=!1)},[lr.Task]:async()=>{const a=M_();console.log(`獲得任務 ${a[0]}`),n.messages.push(`玩家 ${this.id} 獲得任務 ${a[0]}`),await n.setEvent(this,"任務",a,!0)},[lr.Opportunity]:async()=>{const a=j_();console.log(`獲得機會 ${a[0]}`),n.messages.push(`玩家 ${this.id} 獲得機會 ${a[0]}`),await n.setEvent(this,"機會",a)},[lr.Destiny]:async()=>{const a=$_();console.log(`獲得命運 ${a[0]}`),n.messages.push(`玩家 ${this.id} 獲得命運 ${a[0]}`),await n.setEvent(this,"命運",a)},[lr.Punishment]:async()=>{const a=z_();console.log(`獲得懲罰 ${a[0]}`),n.messages.push(`玩家 ${this.id} 獲得懲罰 ${a[0]}`),await n.setEvent(this,"懲罰",a)},[lr.Teleport]:async()=>{const a=dr();if(!await a.confirm.input("是否傳送"))return;const f=r.teleports.filter(l=>l[0]!==this.position.x&&l[1]!==this.position.y);As(f);const o=f.pop();console.log(`傳送至 ${o}`),n.messages.push(`玩家 ${this.id} 傳送至 ${o}`),await this.teleport(o),await a.wait(500)},[lr.Prison]:async()=>{console.log("被關 1 回合"),n.messages.push(`玩家 ${this.id} 被關 1 回合`),this.dizziness++},[lr.Hospital]:async()=>{console.log("被治療 1 回合"),n.messages.push(`玩家 ${this.id} 被治療 1 回合`),this.health=ii,this.dizziness++},[lr.Empty](){throw new Error("Unreachable")}}[t];await i(),console.groupEnd()}async attack(t,r=!1){const n=Er(),i=Et();if(n.getTile(this.position.x,this.position.y)===lr.Hospital){console.log(`玩家 ${t.id} 在醫院，無法攻擊`),i.messages.push(`玩家 ${t.id} 在醫院，無法攻擊`);return}if(t.immune){console.log(`玩家 ${t.id} 處於無敵狀態`),i.messages.push(`玩家 ${t.id} 處於無敵狀態`);return}const a=dr();if(!r&&!await a.confirm.input(`是否攻擊玩家 ${t.id}`)){console.log(`玩家 ${this.id} 放棄攻擊`),i.messages.push(`玩家 ${this.id} 放棄攻擊`);return}console.group(`玩家 ${this.id} 與玩家 ${t.id} 對戰`);let f=await this.throwDice(`對 第${t.id}組 進行掠奪`);this.doubleDamage&&(this.doubleDamage--,f*=2),await t.damage(f,this),console.groupEnd()}async damage(t,r){console.log(`玩家 ${this.id} 受到 ${t} 點傷害`);const n=Et();n.messages.push(`玩家 ${this.id} 受到 ${t} 點傷害`),this.health-=t;const i=Md();let[a,f]=this.position.current;for(let o=0;o<t;o++){const l=Math.random()*Math.PI*2;i.effect({name:"damaged",position:[a,f],direction:[Math.sin(l),Math.cos(l)],time:0},800)}if(this.health>0){await dr().wait(1e3);return}if(console.log(`玩家 ${this.id} 被擊倒`),n.messages.push(`玩家 ${this.id} 被擊倒`),this.health=ii,this.dizziness=1,r){const o=Math.floor(this.score*vg);console.log(`玩家 ${r.id} 獲得 ${o} 分`),n.messages.push(`玩家 ${r.id} 掠奪了 ${o} 分`),this.score-=o,r.score+=o}else{const o=Math.floor(this.score*.2);console.log(`玩家 ${this.id} 掉落 ${o} 分`),n.messages.push(`玩家 ${this.id} 掉落了 ${o} 分`),this.score-=o}await dr().wait(1e3)}async teleport(t){const r=Er(),n=this.active;this.position.set(t[0],t[1],200),n&&(en().position=this.position.clone());const i=Array.from(r.nextPosition([t[0],t[1]]).keys());As(i),this.direction=i.pop(),this.fixedDirection=!0,n&&await dr().wait(200)}async throwDice(t){const n=await Et().throwDice(t,!!this.doubleDice,this.fixedDices);return this.doubleDice=Math.max(0,this.doubleDice-1),n}reverseDirection(){this.direction={[dt.UP]:dt.DOWN,[dt.RIGHT]:dt.LEFT,[dt.DOWN]:dt.UP,[dt.LEFT]:dt.RIGHT}[this.direction]}teleportPosition(t){return this.teleport([t.x,t.y])}status(){return this.dizziness?"dizziness":"normal"}}const Df=()=>gg,gg=Af(new class{constructor(){Oe(this,"ready",!1);Oe(this,"running",!1)}async setup(){console.info("初始化遊戲");const t=Et(),r=Er();console.info("初始化玩家");const n=r.spawnPoints(),i=["#8650a6","#56ae6c","#b84c7d","#ac9c3d","#6881d8","#ba543d"];if(n.length<t.quantity)throw new Error("Not enough spawners");As(n);let a;for(let o=0;o<t.quantity;o++){const l=n.pop();o===0&&(a=l[0]);const y=Bs.from(l[0]),g=l[1],P=new _g(o+1,100,i[o],y,g);t.players.set(o,P)}console.info("初始化渲染器");const f=en();f.start(),f.position.set(a[0],a[1])}async run(){const t=Et(),r=en(),n=dr();console.group(`第 ${++t.inning} 回合`);const i=t.players;for(const a of i.values()){a.active=!0;const f=a.position.x,o=a.position.y;if(r.position.set(f,o,a.position.distance(r.position)*50),a.immune&&a.immune--,a.dizziness){console.info(`玩家 ${a.id} 眩暈中`),t.messages.push(`玩家 ${a.id} 眩暈中`),await n.wait(1e3),a.active=!1,a.dizziness--;continue}for(t.steps=await a.throwDice("開始回合");t.steps>0;){await a.walk(),t.steps--;const l=t.traps;for(const y of l){const g=a.position,P=y[0]===g.x,U=y[1]===g.y;!P||!U||await y[2](a)}for(const y of i.values())a!==y&&a.position.equals(y.position)&&await a.attack(y);t.steps===0&&await a.trigger()}t.steps=void 0,await n.wait(500),a.active=!1}console.groupEnd(),this.running&&sf(()=>this.run())}async init(t){console.info("初始化狀態"),this.ready=!0,this.running=!0;const r=Et();r.quantity=t,sf(async()=>{await this.setup(),await this.run()})}async stop(){this.running=!1,this.ready=!1,en().stop()}}),yg={class:"loader"},bg={class:"progress"},xg=["max","value"],Eg={key:0},Tg={key:1,class:"log"},Ag=rn({__name:"Loader",setup(e){const t=Gn(),r=af(()=>t.textures.size+t.sounds.size+t.loadings),n=af(()=>r.value-t.loadings);return(i,a)=>(tt(),ot("div",yg,[Ne("span",bg,[vt(ut(De(n))+" / "+ut(De(r))+" ",1),Ne("progress",{max:De(r),value:De(n)},null,8,xg)]),De(t).isFinished()?(tt(),ot("p",Eg,"Loading Completed")):(tt(),ot("div",Tg,[(tt(!0),ot(wt,null,$r(De(t).logs.toReversed(),(f,o)=>(tt(),ot("span",{key:o},ut(f),1))),128))]))]))}}),wg=gn(Ag,[["__scopeId","data-v-d03c34ba"]]),Sg={key:0,class:"error"},Cg=rn({__name:"Start",setup(e){const t=Pc(4),r=Df(),n=Gn(),i=()=>{if(t.value<2||t.value>8){a.value="The quantity must be between 2 and 8";return}if(!n.isFinished()){a.value="The game is not ready yet";return}r.init(t.value)},a=Pc("");return(f,o)=>(tt(),ot(wt,null,[Ne("form",{onSubmit:Gd(i,["prevent"])},[o[2]||(o[2]=Ne("h1",null,"Monopoly",-1)),Ne("label",null,[o[1]||(o[1]=Ne("span",null,"Quantity: ",-1)),fr(Ne("input",{type:"number",min:"2",max:"8","onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l)},null,512),[[_r,t.value]])]),o[3]||(o[3]=Ne("button",{class:"confirm"},"Start",-1)),a.value?(tt(),ot("span",Sg,"Warring: "+ut(a.value),1)):Rr("",!0)],32),Vt(wg)],64))}}),Lg=gn(Cg,[["__scopeId","data-v-29ff0ff7"]]),Rg=rn({__name:"Canvas",setup(e){const t=Ju("canvas");return Pi(t,r=>{const n=en();n&&n.stop(),r&&pg(r)}),(r,n)=>(tt(),ot("canvas",{class:"canvas",ref_key:"canvas",ref:t},null,512))}}),Og=gn(Rg,[["__scopeId","data-v-368ef003"]]),Fg={class:"popup"},Pg={class:"input"},Dg=["disabled","onClick"],Ig=["onClick"],Gg=["onClick"],Mg=rn({__name:"Input",setup(e){const t=dr(),r=t.next,n=t.move,i=t.confirm,a=t.players;function f(g,P){return g.length===0?!0:g.includes(P)}const o=[[dt.UP,"⇑"],[dt.DOWN,"⇓"],[dt.LEFT,"⇐"],[dt.RIGHT,"⇒"]],l=[[!0,"接受"],[!1,"拒絕"]],y=Mi(()=>Array.from(a.accept).map(g=>[g,`第${g.id}組`]));return(g,P)=>(tt(),ot(wt,null,[Ne("div",Fg,ut(De(r).text)+" "+ut(De(n).text)+" "+ut(De(i).text),1),Ne("div",Pg,[De(r).receive?(tt(),ot("button",{key:0,onClick:P[0]||(P[0]=U=>De(r).resolve())},"下一步")):Rr("",!0),De(n).receive?(tt(),ot(wt,{key:1},$r(o,([U,re])=>Ne("button",{disabled:!f(De(n).accept,U),onClick:ue=>De(n).resolve(U)},ut(re),9,Dg)),64)):Rr("",!0),De(i).receive?(tt(),ot(wt,{key:2},$r(l,([U,re])=>(tt(),ot(wt,null,[f(De(i).accept,U)?(tt(),ot("button",{key:0,onClick:ue=>De(i).resolve(U)},ut(re),9,Ig)):Rr("",!0)],64))),64)):Rr("",!0),De(a).receive?(tt(!0),ot(wt,{key:3},$r(y.value,([U,re])=>(tt(),ot(wt,null,[f(De(a).accept,U)?(tt(),ot("button",{key:0,onClick:ue=>De(a).resolve(U)},ut(re),9,Gg)):Rr("",!0)],64))),256)):Rr("",!0)])],64))}}),Ng=gn(Mg,[["__scopeId","data-v-fb6100b8"]]),kg={key:0},Bg={key:1},Ug={class:"info"},$g=rn({__name:"Ranking",setup(e){const t=Et(),r=Mi(()=>Array.from(t.players.values()));return(n,i)=>(tt(),da(Dd,{name:"list",tag:"div",class:"list"},{default:_s(()=>[(tt(!0),ot(wt,null,$r(r.value.toSorted((a,f)=>f.score-a.score),(a,f)=>(tt(),ot("div",{class:xa(["player",{active:a.active}]),key:a.id},[Ne("h3",null,[vt("第 "+ut(a.id)+" 組 ",1),f===0?(tt(),ot("i",kg,"👑")):Rr("",!0),a.dizziness?(tt(),ot("i",Bg,"💫")):Rr("",!0)]),Ne("div",Ug,[Ne("span",null,"分數: "+ut(a.score),1)]),Ne("span",null,[(tt(!0),ot(wt,null,$r(De(ii),o=>(tt(),ot(wt,null,[vt(ut(o<=a.health?"❤️":"🤍"),1)],64))),256))])],2))),128))]),_:1}))}}),Vg=gn($g,[["__scopeId","data-v-63b475c4"]]),jg=rn({__name:"Minimap",setup(e){const t=Er();let r=null,n=null;const i=Ju("canvas");Pi(i,y=>{if(n=null,!y)return;n=y.getContext("2d"),g(y,n),window.addEventListener("resize",g.bind(null,y,n));function g(P,U){let{width:re,height:ue}=P.getBoundingClientRect();const Ie=window.devicePixelRatio||1,Qe=P.width=re*Ie,Ge=P.height=ue*Ie,Ze=Qe/t.width,$e=Ge/t.height;U.setTransform(Ze,0,0,$e,0,0);const be=new OffscreenCanvas(Qe,Ge),ke=be.getContext("2d");ke.setTransform(Ze,0,0,$e,0,0);for(const[We,St]of t.flatTiles.entries()){const[Ft,He]=t.indexFromFlat(We),et=Pn.tileImage(St);et&&ke.drawImage(et,0,0,et.width,et.height,Ft,He,1,1)}r=be.transferToImageBitmap(),l()}});const a=Et();Pi(a,()=>requestAnimationFrame(l));const f=Mi(()=>t.width/t.height);let o=NaN;function l(y=0){if(!n||y===o)return;o=y;const g=t.width,P=t.height;n.clearRect(0,0,g,P),n.drawImage(r,0,0,g,P),n.font="0.8px sans-serif",n.textAlign="center",n.textBaseline="hanging";for(const U of a.players.values()){const re=U.position,ue=re.current[0]+.1,Ie=re.current[1]+.1,Qe=U.color;n.fillStyle=Qe,n.beginPath(),n.roundRect(ue,Ie,.8,.8,.1),n.fill(),n.fillStyle="#fff",n.fillText(U.id.toString(),ue+.4,Ie+.1)}}return(y,g)=>(tt(),ot("canvas",{class:"minimap",ref_key:"canvas",ref:i,style:ba({aspectRatio:f.value}),onContextmenu:g[0]||(g[0]=Gd(P=>De(bt).enabled=!De(bt).enabled,["right","prevent"]))},null,36))}}),Hg=gn(jg,[["__scopeId","data-v-bd28f956"]]),$d=""+new URL("../tiles/task.png",import.meta.url).href,Vd=""+new URL("../tiles/opportunity.png",import.meta.url).href,jd=""+new URL("../tiles/destiny.png",import.meta.url).href,Hd=""+new URL("../tiles/punishment.png",import.meta.url).href,zg=""+new URL("../others/dice1.png",import.meta.url).href,Wg=""+new URL("../others/dice2.png",import.meta.url).href,Xg=""+new URL("../others/dice3.png",import.meta.url).href,Yg=""+new URL("../others/dice4.png",import.meta.url).href,Kg=""+new URL("../others/dice5.png",import.meta.url).href,qg=""+new URL("../others/dice6.png",import.meta.url).href,Qg={class:"popup-group"},Zg={class:"popup-group"},Jg={key:0,class:"popup center dices"},ey=["src"],ty={key:1,class:"popup center"},ry={key:0,class:"popup debug"},ny={open:""},iy={open:""},ay=["onUpdate:modelValue","max"],sy=["onUpdate:modelValue"],oy=["onUpdate:modelValue"],fy=["onUpdate:modelValue"],ly=["onUpdate:modelValue"],cy=["onUpdate:modelValue"],uy=["onUpdate:modelValue"],dy={open:""},hy={class:"face back"},py=["src"],my={class:"face front"},vy=["innerHTML"],_y={class:"btns"},gy=rn({__name:"Popup",setup(e){const t=Et();function r(f){const[o,l]=f;return{left:`${o}px`,top:`${l}px`}}function n(f){return f.toFixed(2)}const i=Mi(()=>t.event?{任務:$d,機會:Vd,命運:jd,懲罰:Hd}[t.event.type]:"");function a(f){return[zg,Wg,Xg,Yg,Kg,qg][f-1]}return(f,o)=>(tt(),ot(wt,null,[Ne("div",Qg,[(tt(!0),ot(wt,null,$r(De(t).playersLabel,([l,y])=>(tt(),ot("div",{style:ba(r(y)),class:"popup label"}," 第 "+ut(l)+" 組 ",5))),256))]),Ne("div",Zg,[De(t).dices!==void 0?(tt(),ot("div",Jg,[(tt(!0),ot(wt,null,$r(De(t).dices,l=>(tt(),ot("img",{src:a(l)},null,8,ey))),256))])):De(t).steps!==void 0?(tt(),ot("div",ty,ut(De(t).steps)+" 步 ",1)):Rr("",!0),Vt(Dd,{tag:"div",name:"list",class:"popup messages"},{default:_s(()=>[(tt(!0),ot(wt,null,$r(De(t).messages.toArray(),l=>(tt(),ot("div",{key:l,class:"message"},ut(l),1))),128))]),_:1})]),De(bt).enabled?(tt(),ot("div",ry,[Ne("details",ny,[o[13]||(o[13]=Ne("summary",null,"Current",-1)),Ne("span",null,[o[11]||(o[11]=vt("Step: ")),De(t).steps!==void 0?fr((tt(),ot("input",{key:0,type:"range","onUpdate:modelValue":o[0]||(o[0]=l=>De(t).steps=l),max:32,min:0},null,512)),[[_r,De(t).steps,void 0,{number:!0}]]):Rr("",!0),vt(ut(De(t).steps??"Undefined"),1)]),Ne("span",null,[o[12]||(o[12]=vt("Transition: ")),fr(Ne("input",{type:"checkbox","onUpdate:modelValue":o[1]||(o[1]=l=>De(bt).transition=l)},null,512),[[b_,De(bt).transition]])])]),(tt(!0),ot(wt,null,$r(De(t).players.values(),l=>(tt(),ot("details",iy,[Ne("summary",null,"Player "+ut(l.id),1),Ne("span",null,[o[14]||(o[14]=vt("Health: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":y=>l.health=y,max:De(ii),min:"0"},null,8,ay),[[_r,l.health,void 0,{number:!0}]]),vt(" "+ut(l.health),1)]),Ne("span",null,[o[15]||(o[15]=vt("Dizziness: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":y=>l.dizziness=y,max:"5",min:"0"},null,8,sy),[[_r,l.dizziness,void 0,{number:!0}]]),vt(" "+ut(l.dizziness),1)]),Ne("span",null,[o[16]||(o[16]=vt("Immune: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":y=>l.immune=y,max:"5",min:"0"},null,8,oy),[[_r,l.immune,void 0,{number:!0}]]),vt(" "+ut(l.immune),1)]),Ne("span",null,[o[17]||(o[17]=vt("DoubleDice: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":y=>l.doubleDice=y,max:"5",min:"0"},null,8,fy),[[_r,l.doubleDice,void 0,{number:!0}]]),vt(" "+ut(l.doubleDice),1)]),Ne("span",null,[o[18]||(o[18]=vt("DoubleTaskScore: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":y=>l.doubleTaskScore=y,max:"5",min:"0"},null,8,ly),[[_r,l.doubleTaskScore,void 0,{number:!0}]]),vt(" "+ut(l.doubleTaskScore),1)]),Ne("span",null,[o[19]||(o[19]=vt("DoubleDamage: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":y=>l.doubleDamage=y,max:"5",min:"0"},null,8,cy),[[_r,l.doubleDamage,void 0,{number:!0}]]),vt(" "+ut(l.doubleDamage),1)]),Ne("span",null,[o[20]||(o[20]=vt("Score: ")),fr(Ne("input",{type:"number","onUpdate:modelValue":y=>l.score=y,max:"2000",min:"0"},null,8,uy),[[_r,l.score,void 0,{number:!0}]])])]))),256)),Ne("details",dy,[o[27]||(o[27]=Ne("summary",null,"View",-1)),Ne("span",null,[o[21]||(o[21]=vt("X:")),fr(Ne("input",{type:"range","onUpdate:modelValue":o[2]||(o[2]=l=>De(bt).x=l),max:10,min:-10,step:"0.5"},null,512),[[_r,De(bt).x,void 0,{number:!0}]]),vt(ut(n(De(bt).x)),1)]),Ne("span",null,[o[22]||(o[22]=vt("Y:")),fr(Ne("input",{type:"range","onUpdate:modelValue":o[3]||(o[3]=l=>De(bt).y=l),max:10,min:-10,step:"0.5"},null,512),[[_r,De(bt).y,void 0,{number:!0}]]),vt(ut(n(De(bt).y)),1)]),Ne("span",null,[o[23]||(o[23]=vt("Z:")),fr(Ne("input",{type:"range","onUpdate:modelValue":o[4]||(o[4]=l=>De(bt).z=l),max:10,min:-10,step:"0.5"},null,512),[[_r,De(bt).z,void 0,{number:!0}]]),vt(ut(n(De(bt).z)),1)]),Ne("span",null,[o[24]||(o[24]=vt("AngleX: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":o[5]||(o[5]=l=>De(bt).angleX=l),max:180,min:-180},null,512),[[_r,De(bt).angleX,void 0,{number:!0}]]),vt(ut(n(De(bt).angleX)),1)]),Ne("span",null,[o[25]||(o[25]=vt("AngleY: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":o[6]||(o[6]=l=>De(bt).angleY=l),max:180,min:-180},null,512),[[_r,De(bt).angleY,void 0,{number:!0}]]),vt(ut(n(De(bt).angleY)),1)]),Ne("span",null,[o[26]||(o[26]=vt("AngleZ: ")),fr(Ne("input",{type:"range","onUpdate:modelValue":o[7]||(o[7]=l=>De(bt).angleZ=l),max:180,min:-180},null,512),[[_r,De(bt).angleZ,void 0,{number:!0}]]),vt(ut(n(De(bt).angleZ)),1)])])])):Rr("",!0),Vt(K0,{name:"event"},{default:_s(()=>[De(t).event?(tt(),ot("div",{key:0,class:xa(["popup","event",{transition:De(bt).transition}])},[Ne("div",hy,[Ne("img",{src:i.value},null,8,py),Ne("span",null,ut(De(t).event.type),1)]),Ne("div",my,[Ne("h1",null,ut(De(t).event.type),1),Ne("h2",null,ut(De(t).event.title),1),Ne("p",{innerHTML:De(t).event.description},null,8,vy),Ne("div",_y,[De(t).event.hasFail?(tt(),ot(wt,{key:0},[Ne("button",{onClick:o[8]||(o[8]=l=>De(t).event.callback(!0))},"成功"),Ne("button",{onClick:o[9]||(o[9]=l=>De(t).event.callback(!1))},"失敗")],64)):(tt(),ot("button",{key:1,onClick:o[10]||(o[10]=l=>De(t).event.callback(!0))},"完成"))])])],2)):Rr("",!0)]),_:1})],64))}}),yy=gn(gy,[["__scopeId","data-v-0c260b28"]]),by={class:"container"},xy=rn({__name:"Game",setup(e){return(t,r)=>(tt(),ot("div",by,[Ne("main",null,[Vt(Og),Vt(Ng),Vt(yy)]),Ne("aside",null,[Vt(Vg),Vt(Hg)])]))}}),Ey=gn(xy,[["__scopeId","data-v-56987a3e"]]),Ty=rn({__name:"App",setup(e){const t=Df();return(r,n)=>De(t).ready?De(t).running?(tt(),da(Ey,{key:1})):(tt(),da(I_,{key:2})):(tt(),da(Lg,{key:0}))}}),Ay=""+new URL("../tiles/spawner.webp",import.meta.url).href,wy=""+new URL("../tiles/teleport.png",import.meta.url).href,Sy=""+new URL("../tiles/prison.png",import.meta.url).href,Cy=""+new URL("../tiles/hospital.png",import.meta.url).href,Aa=""+new URL("../players/player.1.png",import.meta.url).href,Ly=""+new URL("../players/player.2.png",import.meta.url).href,Ry=""+new URL("../fx/damaged.png",import.meta.url).href,Oy=""+new URL("../others/arrow.png",import.meta.url).href,Fy=""+new URL("../others/dizziness.png",import.meta.url).href;S_(Ty).mount("#app");const ar=Gn();ar.loadTexture("tile-spawner",Ay);ar.loadTexture("tile-task",$d);ar.loadTexture("tile-opportunity",Vd);ar.loadTexture("tile-destiny",jd);ar.loadTexture("tile-punishment",Hd);ar.loadTexture("tile-teleport",wy);ar.loadTexture("tile-prison",Sy);ar.loadTexture("tile-hospital",Cy);ar.loadTexture("player-1",Aa);ar.loadTexture("player-2",Ly);ar.loadTexture("player-3",Aa);ar.loadTexture("player-4",Aa);ar.loadTexture("player-5",Aa);ar.loadTexture("player-6",Aa);ar.loadTexture("fx-damaged",Ry);ar.loadTexture("arrow",Oy);ar.loadTexture("dizziness",Fy);
